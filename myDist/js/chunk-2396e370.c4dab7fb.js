(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2396e370"],{"202f":function(t,e,a){"use strict";var n=a("6e42");a.n(n).a},2227:function(t,e,a){"use strict";var n=a("d319");a.n(n).a},"4d47":function(t,e,a){"use strict";var n=a("6385");a.n(n).a},6385:function(t,e,a){},"6e42":function(t,e,a){},d319:function(t,e,a){},ef42:function(t,e,a){"use strict";a.r(e);var n=(a("7db0"),a("c740"),a("a434"),a("96cf"),a("1da1")),i=a("5530"),s=a("2f62"),r=a("ad32"),o=a("2adb"),l={props:{visible:{type:Boolean,default:!1},EditData:{type:Object,default:null}},components:{CommonDialogComp:r.a,NewAreaTreeSpreadComp:o.a},computed:Object(i.a)({},Object(s.c)("common",["allAreaTreeList"]),{},Object(s.e)("common",["areaList"])),data:function(){return{title:"新建模板",ruleForm:{ID:"",Name:"",Range:{IsIncludeIncreased:!1,List:[]}}}},methods:{onSubmit:function(){if(this.formDataChecker()){var t=this.ruleForm,e=t.ID,a=t.Name,n=t.Range,i=n.IsIncludeIncreased,s=n.List;if(0===s.length&&!i)return void this.messageBox.failSingleError("保存失败","没有选中区域");var r={ID:e,Name:a,AreaList:s,IsIncludeIncreasedArea:i};this.$emit("submit",r)}},onCancle:function(){this.$emit("update:visible",!1)},onOpen:function(){this.$nextTick(this.initEditData)},onClosed:function(){},initEditData:function(){this.title=this.EditData?"编辑模板":"新建模板";var t=this.EditData?this.EditData.ID:"",e=this.EditData?this.EditData.Name:"",a=!!this.EditData&&this.EditData.IsIncludeIncreasedArea,n=this.EditData?this.EditData.AreaList:[];this.ruleForm.ID=t,this.ruleForm.Name=e,this.ruleForm.Range.IsIncludeIncreased=a,this.ruleForm.Range.List=n},formDataChecker:function(){return this.ruleForm.Name?!(0===!this.ruleForm.Range.List.length&&!this.ruleForm.Range.IsIncludeIncreased&&(this.messageBox.failSingleError("保存失败","请选择适用区域"),1)):(this.messageBox.failSingleError("保存失败","请输入模板名称"),!1)}}},c=(a("2227"),a("2877")),u=Object(c.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CommonDialogComp",{staticClass:"mp-erp-comps-price-module-area-template-save-dialog-comp-wrap",attrs:{width:"800px",top:"8vh",title:t.title,visible:t.visible},on:{"update:visible":function(e){t.visible=e},submit:t.onSubmit,cancle:t.onCancle,open:t.onOpen,closed:t.onClosed}},[a("div",{staticClass:"header"},[a("span",{staticClass:"label"},[t._v("模板名称：")]),a("el-input",{attrs:{size:"small",maxlength:"10","show-word-limit":""},model:{value:t.ruleForm.Name,callback:function(e){t.$set(t.ruleForm,"Name","string"==typeof e?e.trim():e)},expression:"ruleForm.Name"}})],1),a("div",{staticClass:"content"},[a("p",{staticClass:"mp-common-title-wrap"},[t._v("适用区域")]),a("NewAreaTreeSpreadComp",{attrs:{list:t.allAreaTreeList},model:{value:t.ruleForm.Range,callback:function(e){t.$set(t.ruleForm,"Range",e)},expression:"ruleForm.Range"}})],1),a("div",{staticClass:"footer"},[a("p",{staticClass:"tips-box is-pink"},[a("i",{staticClass:"el-icon-warning"}),t._v("注：新加区域指后续如果有新增加的区域是否自动适用。选中则自动适用，不选中则不会自动适用。")])])])}),[],!1,null,null,null).exports,m=a("bc5c"),p=a("c31e"),d=(a("99af"),a("a15b"),a("d81d"),a("b0c0"),a("53ca")),f={props:{list:{}},computed:{showContent:function(){return"string"==typeof this.list?this.list:this.list.map((function(t){return"string"==typeof t?t:"object"===Object(d.a)(t)?t.list&&t.list.length>0?"".concat(t.name,"：").concat(t.list.join("；")):"".concat(t.name,"：不包含已有区域"):""})).join("、")},tooltipList:function(){return"string"==typeof this.list?[this.list]:this.list}}},h=(a("4d47"),Object(c.a)(f,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tooltip",{attrs:{effect:"light","popper-class":"common-property-condition-text-tips-box",placement:"bottom-start","visible-arrow":!1}},[a("div",{attrs:{slot:"content"},slot:"content"},t._l(t.tooltipList,(function(e,n){return a("div",{key:n},["string"==typeof e?a("p",[t._v(t._s(e))]):a("div",[a("p",[t._v(t._s(e.name)+"：")]),t._l(e.list,(function(e,n){return a("p",{key:n,staticClass:"mp-tree-table-tooltip-item"},[t._v(t._s(e)+"；")])})),0===e.list.length?a("p",{staticClass:"mp-tree-table-tooltip-item"},[t._v("不包含全部已有区域")]):t._e()],2)])})),0),a("div",{staticStyle:{"text-overflow":"ellipsis",overflow:"hidden"}},[t._v(" 适用区域"),t.showContent?[t._v("：")]:t._e(),t._v(t._s(t.showContent)+" ")],2)])}),[],!1,null,null,null)).exports,v={name:"AreaTemplate",components:{AreaTempSaveDialog:u,CtrlMenus:m.a,TableItemShowComp:h},data:function(){return{curEditData:null,visible:!1,dataList:[],loading:!0,allDataLoading:!0}},computed:Object(i.a)({},Object(s.c)("common",["allAreaTreeList"])),methods:{setAreaTemplateHandler:function(t){this.curEditData=t?JSON.parse(JSON.stringify(t)):null,this.visible=!0},onGobackClick:function(){this.$goback()},handleSubmit:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function a(){var n,s,r,o,l;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=t.Name,s=t.ID,!e.dataList.find((function(t){return t.Name===n&&t.ID!==s}))){a.next=5;break}return e.messageBox.failSingleError("保存失败","已存在相同的模板名称"),a.abrupt("return");case 5:return a.next=7,e.api.getApplyRangeTemplateSave(t).catch((function(){}));case 7:(r=a.sent)&&1e3===r.data.Status&&(o=t.ID?"编辑成功":"添加成功",l=function(){if(t.ID){var a=e.dataList.findIndex((function(e){return e.ID===t.ID}));a>-1&&e.dataList.splice(a,1,t)}else e.dataList.unshift(Object(i.a)({},t,{ID:r.data.Data}));e.visible=!1,e.curEditData=null,e.$store.commit("priceManage/setApplyRangeTemplateList",[[],!1])},e.messageBox.successSingle(o,l,l));case 9:case"end":return a.stop()}}),a)})))()},getDataList:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.getApplyRangeTemplateList().catch((function(){}));case 2:a=e.sent,t.loading=!1,a&&1e3===a.data.Status&&(t.dataList=a.data.Data);case 5:case"end":return e.stop()}}),e)})))()},onRemoveClick:function(t,e){var a=this;this.messageBox.warnCancelBox("确定删除该条范围模板吗","模板名称：[ ".concat(t.Name," ]"),(function(){a.getApplyRangeTemplateRemove(t,e)}))},getApplyRangeTemplateRemove:function(t,e){var a=this,i=t.ID;return Object(n.a)(regeneratorRuntime.mark((function t(){var n,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.api.getApplyRangeTemplateRemove(i).catch((function(){}));case 2:(n=t.sent)&&1e3===n.data.Status&&(s=function(){a.dataList.splice(e,1)},a.messageBox.successSingle("删除成功",s,s));case 4:case"end":return t.stop()}}),t)})))()},getAreaContent:function(t){var e={List:t.AreaList,IsIncludeIncreased:t.IsIncludeIncreasedArea};return Object(p.e)(e,this.allAreaTreeList)}},mounted:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.getDataList(),e.next=3,t.$store.dispatch("common/getAreaList");case 3:t.allDataLoading=!1;case 4:case"end":return e.stop()}}),e)})))()}},g=(a("202f"),Object(c.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"mp-price-manage-page-area-template-page-wrap"},[n("header",[t._m(0),n("div",[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.setAreaTemplateHandler(null)}}},[t._v("新建模板")])],1)]),n("main",{staticClass:"mp-scroll-wrap"},[n("AreaTempSaveDialog",{attrs:{visible:t.visible,EditData:t.curEditData},on:{"update:visible":function(e){t.visible=e},submit:t.handleSubmit}}),t.allDataLoading?t._e():n("ul",[t._l(t.dataList,(function(e,a){return n("li",{key:e.ID},[n("div",{staticClass:"content"},[t._v(t._s(e.Name))]),n("div",{staticClass:"area"},[n("TableItemShowComp",{attrs:{list:t.getAreaContent(e)}})],1),n("CtrlMenus",{on:{edit:function(a){return t.setAreaTemplateHandler(e)},remove:function(n){return t.onRemoveClick(e,a)}}})],1)})),t.loading||0!==t.dataList.length?t._e():n("li",{staticClass:"empty-box"},[n("img",{attrs:{src:a("5731"),alt:""}}),n("p",[t._v("暂无数据")])])],2)],1),n("footer",[n("el-button",{staticClass:"goback",on:{click:t.onGobackClick}},[n("i",{staticClass:"el-icon-d-arrow-left"}),t._v(" 返回")])],1)])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"mp-common-title-wrap is-black"},[a("span",[t._v("设置适用范围模板")])])}],!1,null,null,null));e.default=g.exports}}]);