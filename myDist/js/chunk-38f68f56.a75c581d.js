(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-38f68f56"],{"327e":function(e,t,r){"use strict";var i=r("903f");r.n(i).a},"75d5":function(e,t,r){},"903f":function(e,t,r){},d76a:function(e,t,r){"use strict";r.r(t);var i=(r("99af"),r("4de4"),r("7db0"),r("caad"),r("2532"),r("96cf"),r("1da1")),a=r("5530"),n={props:{filterWords:{}},data:function(){return{keyWord:""}},methods:{onClick:function(){this.$emit("onFactoryAddClick")},onFilterClick:function(e){e&&"clear"===e?this.$emit("onFilterClick",""):this.$emit("onFilterClick",this.keyWord)}},watch:{filterWords:{handler:function(e){e!==this.keyWord&&(this.keyWord=e)},immediate:!0}}},o=r("2877"),l=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("header",[r("el-button",{staticClass:"blue-full-color-btn-styles is-blue-button",attrs:{type:"primary"},on:{click:e.onClick}},[e._v("添加生产工厂")]),r("div",{staticClass:"input-box"},[r("el-input",{attrs:{placeholder:"请输入搜索关键字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onFilterClick(t)}},model:{value:e.keyWord,callback:function(t){e.keyWord="string"==typeof t?t.trim():t},expression:"keyWord"}}),r("el-button",{attrs:{type:"primary"},on:{click:e.onFilterClick}},[e._v("筛选")]),r("span",{staticClass:"blue-span",on:{click:function(t){return e.onFilterClick("clear")}}},[e._v("清除筛选项")])],1)],1)}),[],!1,null,null,null).exports,s=r("2af0"),c={props:{dataList:{default:function(){return[]},type:Array},filterWords:{},getAddName:{type:Function,default:function(){}}},mixins:[s.a],data:function(){return{search:""}},methods:{setHeight:function(){var e=this.getHeight("",105);this.h=e},onEditClick:function(e){this.$emit("handleAddressItemEdit",e)},onRemoveClick:function(e){this.$emit("handleAddressItemRemove",e)}}},u=(r("327e"),Object(o.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-table",{staticClass:"mp-erp-factory-manage-page-table-comp-wrap",staticStyle:{width:"100%"},attrs:{"max-height":e.h,height:e.h,data:e.dataList,stripe:"",border:"",fit:""}},[r("el-table-column",{attrs:{prop:"FactoryName",label:"工厂名称","min-width":"160"}}),r("el-table-column",{attrs:{prop:"Address",label:"工厂地址","min-width":"360"},scopedSlots:e._u([{key:"default",fn:function(t){return r("span",{staticClass:"is-gray"},[e._v(e._s(e.getAddName(t.row)))])}}])}),r("el-table-column",{attrs:{prop:"LinkMan",label:"联系人","min-width":"130"}}),r("el-table-column",{attrs:{prop:"Mobile",label:"联系电话","min-width":"130"}}),r("el-table-column",{attrs:{label:"操作",width:"320"},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticClass:"menu-list"},[r("span",{on:{click:function(r){return e.onEditClick(t.row)}}},[r("i"),e._v("编辑")]),r("span",{on:{click:function(r){return e.onRemoveClick(t.row)}}},[r("i"),e._v("删除")])])}}])}),r("div",{attrs:{slot:"empty"},slot:"empty"},[e.filterWords?r("span",[e._v("当前关键字为："+e._s(e.filterWords)+"， 筛选出条目为0， 请尝试更换搜索关键字")]):r("span",[e._v("暂无数据")])])],1)}),[],!1,null,null,null)).exports,d=(r("4160"),r("d81d"),r("b64b"),r("159b"),r("ad32")),m=r("c209"),f={props:{visible:{type:Boolean,default:!1},areaList:{type:Array,default:function(){return[]}},itemData:{type:Object,default:null}},components:{CommonDialogComp:d.a,TwoLevelSelectComp:m.a},computed:{locationIDs:{get:function(){return{level1Val:this.ruleForm.ProvinceID,level2Val:this.ruleForm.CityID}},set:function(e){var t=e.level1Val,r=e.level2Val;this.ruleForm.ProvinceID=t,this.ruleForm.CityID=r}},level1Options:function(){return this.areaList&&0!==this.areaList.length?this.areaList.map((function(e){return{Name:e.Name,ID:e.ID}})):[]},level2Options:function(){var e=this;if(!this.areaList||0===this.areaList.length||!this.ruleForm.ProvinceID)return[];var t=this.areaList.find((function(t){return t.ID===e.ruleForm.ProvinceID}));return t?t.children.map((function(e){return{Name:e.Name,ID:e.ID}})):[]},title:function(){return this.ruleForm.FactoryID?"编辑生产工厂":"添加生产工厂"}},data:function(){return{ruleForm:{FactoryName:"",ProvinceID:"",CityID:"",Address:"",LinkMan:"",Mobile:"",FactoryID:0},rules:{FactoryName:[{required:!0,message:"请输入工厂名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],CityID:[{required:!0,message:"请选择工厂地址",trigger:"change"}],Address:[{required:!0,message:"请输入详细地址",trigger:"blur"},{min:1,max:60,message:"长度在 1 到 60 个字符",trigger:"blur"}],LinkMan:[{required:!0,message:"请输入联系人",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],Mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式不正确",trigger:"blur"}]}}},methods:{onDialogSubmit:function(){var e=this;this.$refs.ruleForm.validate((function(t){t&&e.$emit("submit",e.ruleForm)}))},onDialogCancle:function(){this.$emit("update:visible",!1)},initEditData:function(){var e=this;this.itemData?Object.keys(this.ruleForm).forEach((function(t){(e.itemData[t]||0===e.itemData[t])&&(e.ruleForm[t]=e.itemData[t])})):(Object.keys(this.ruleForm).forEach((function(t){e.ruleForm[t]=""})),this.ruleForm.FactoryID=0,this.level1Options.length>0&&(this.ruleForm.ProvinceID=this.level1Options[0].ID),this.level2Options.length>0&&(this.ruleForm.CityID=this.level2Options[0].ID))},onOpen:function(){this.$nextTick(this.initEditData)},onClosed:function(){this.$refs.ruleForm.resetFields()}}},p=Object(o.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("CommonDialogComp",{attrs:{width:"700px",title:e.title,visible:e.visible},on:{"update:visible":function(t){e.visible=t},submit:e.onDialogSubmit,cancle:e.onDialogCancle,open:e.onOpen,closed:e.onClosed}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"工厂名称",prop:"FactoryName"}},[r("el-input",{attrs:{placeholder:"请输入工厂名称",maxlength:"20","show-word-limit":""},model:{value:e.ruleForm.FactoryName,callback:function(t){e.$set(e.ruleForm,"FactoryName",t)},expression:"ruleForm.FactoryName"}})],1),r("el-form-item",{attrs:{label:"工厂地址",prop:"CityID"}},[r("TwoLevelSelectComp",{attrs:{level1Options:e.level1Options,level2Options:e.level2Options},model:{value:e.locationIDs,callback:function(t){e.locationIDs=t},expression:"locationIDs"}})],1),r("el-form-item",{attrs:{label:"详细地址",prop:"Address"}},[r("el-input",{attrs:{placeholder:"请输入详细地址",maxlength:"60","show-word-limit":""},model:{value:e.ruleForm.Address,callback:function(t){e.$set(e.ruleForm,"Address",t)},expression:"ruleForm.Address"}})],1),r("el-form-item",{attrs:{label:"联系人",prop:"LinkMan"}},[r("el-input",{attrs:{placeholder:"请输入联系人",maxlength:"10","show-word-limit":""},model:{value:e.ruleForm.LinkMan,callback:function(t){e.$set(e.ruleForm,"LinkMan","string"==typeof t?t.trim():t)},expression:"ruleForm.LinkMan"}})],1),r("el-form-item",{attrs:{label:"联系电话",prop:"Mobile"}},[r("el-input",{attrs:{placeholder:"请输入联系电话",maxlength:"11","show-word-limit":""},model:{value:e.ruleForm.Mobile,callback:function(t){e.$set(e.ruleForm,"Mobile","string"==typeof t?t.trim():t)},expression:"ruleForm.Mobile"}})],1)],1)],1)}),[],!1,null,null,null).exports,h=r("daf5"),b=r("2f62"),g={name:"FactoryManagePage",mixins:[Object(h.a)(".mp-erp-factory-manage-page-wrap .el-table__body-wrapper")],components:{FactoryManageHeader:l,FactoryManageTable:u,FactoryManageDialog:p},computed:Object(a.a)({},Object(b.e)("common",["factoryList"]),{},Object(b.c)("common",["allAdAreaTreeList"]),{filterDataList:function(){var e=this;return this.filterWords?this.factoryList.filter((function(t){return t.FactoryName.includes(e.filterWords)||t.Address.includes(e.filterWords)||t.LinkMan.includes(e.filterWords)||t.Mobile.includes(e.filterWords)})):this.factoryList}}),data:function(){return{dialogVisible:!1,curItemData:null,filterWords:""}},methods:{onFactoryAddClick:function(){this.curItemData=null,this.dialogVisible=!0},onFilterClick:function(e){this.filterWords=e},getItemAddressName:function(e){if(!e||!this.allAdAreaTreeList||0===this.allAdAreaTreeList.length)return"";var t=this.allAdAreaTreeList.find((function(t){return t.ID===e.ProvinceID}));if(t){var r=t.children.find((function(t){return t.ID===e.CityID}));return r?"".concat(t.Name).concat(r.Name).concat(e.Address):"".concat(t.Name).concat(e.Address)}return"".concat(e.Address)},handleAddressItemEdit:function(e){this.curItemData=e,this.dialogVisible=!0},onSubmit:function(e){var t=this;return Object(i.a)(regeneratorRuntime.mark((function r(){var i,a,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:return i=0===e.FactoryID?"添加":"编辑",r.next=5,t.$store.dispatch("common/getFactorySave",e);case 5:(a=r.sent)&&(n=function(){t.dialogVisible=!1,t.$store.commit("common/setFactoryChange",{type:0===e.FactoryID?"add":"edit",data:a})},t.messageBox.successSingle("".concat(i,"成功!"),n,n));case 7:case"end":return r.stop()}}),r)})))()},handleAddressItemRemove:function(e){var t=this;this.messageBox.warnCancelBox("确定删除该工厂吗 ?","工厂名称：[ ".concat(e.FactoryName," ]"),(function(){t.$store.dispatch("common/getFactoryRemove",e)}))}},mounted:function(){this.$store.dispatch("common/getFactoryList"),this.$store.dispatch("common/fetchAdAreaList")}},v=(r("ff0f"),Object(o.a)(g,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"mp-erp-factory-manage-page-wrap"},[r("FactoryManageHeader",{attrs:{filterWords:e.filterWords},on:{onFactoryAddClick:e.onFactoryAddClick,onFilterClick:e.onFilterClick}}),r("main",[r("FactoryManageTable",{attrs:{dataList:e.filterDataList,filterWords:e.filterWords,getAddName:e.getItemAddressName},on:{handleAddressItemEdit:e.handleAddressItemEdit,handleAddressItemRemove:e.handleAddressItemRemove}}),r("FactoryManageDialog",{attrs:{visible:e.dialogVisible,areaList:e.allAdAreaTreeList,itemData:e.curItemData},on:{"update:visible":function(t){e.dialogVisible=t},submit:e.onSubmit}})],1),r("footer",[r("span",[e._v("共检索出 "),r("i",[e._v(e._s(e.factoryList.length))]),e._v(" 条数据")]),r("span",{directives:[{name:"show",rawName:"v-show",value:e.filterWords,expression:"filterWords"}],staticStyle:{"margin-left":"5px"}},[e._v("，筛选出 "),r("i",[e._v(e._s(e.filterDataList.length))]),e._v(" 条")])])],1)}),[],!1,null,null,null));t.default=v.exports},ff0f:function(e,t,r){"use strict";var i=r("75d5");r.n(i).a}}]);