(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-f1e91bda"],{"819d":function(t,e,a){},be73:function(t,e,a){"use strict";a.r(e);var r=(a("b0c0"),a("ac1f"),a("5319"),a("96cf"),a("1da1")),i=a("5530"),o=a("2f62"),s=a("9477"),c=a("7961"),n={name:"ResultFormulaSetupPage",components:{ContionCommonComp:s.a,FormulaPanelComp:c.a},data:function(){return{PriceID:"",PriceName:"",ProductID:"",ProductName:"",isQuotationPage:!1,isAllCostPage:!1,CraftPriceID:""}},computed:Object(i.a)({},Object(o.e)("priceManage",["curCraftPriceItemData","curPriceItem","curPriceTableItemData","curPriceTableResultFormulaData","PriceItemPropertyList"]),{Condition4getFormulaProperty:function(){var t;return this.isAllCostPage?{ProductID:this.ProductID,PriceID:this.PriceID,UseModule:7}:{ProductID:this.ProductID,PriceID:this.PriceID,TableID:(null===(t=this.curPriceTableItemData)||void 0===t?void 0:t.ID)||"",UseModule:5}}}),methods:{getInitDataFromRoutePath:function(){var t=this.$route.params.isQuotation,e=this.$route.params.isAllCost;if(t||this.curPriceItem&&this.curCraftPriceItemData&&this.curCraftPriceItemData.Craft||this.curSolutionItem||t){var a=this.curPriceItem,r=a.ID,i=a.Name;this.PriceID=r,this.PriceName=i,this.ProductID=this.$route.params.id,this.ProductName=this.$route.params.name,t&&(this.isQuotationPage=t),e&&(this.isAllCostPage=e),!t&&this.curCraftPriceItemData&&this.curCraftPriceItemData.Craft&&(this.CraftPriceID=this.curCraftPriceItemData.Craft.CraftPriceID||"")}else this.onGoBackClick()},onGoBackClick:function(){if(this.isAllCostPage)this.$router.replace({name:"CraftTotalPriceSetPage",params:{name:this.$route.params.name,id:this.$route.params.id}});else{var t=this.$route.params,e=this.isQuotationPage?"QuotationPriceTableItemSet":"CraftPriceTableItemSet";this.$router.replace({name:e,params:t})}},onSubmitClick:function(){var t=this.$refs.oLeftComp.getConditonResult();if(t){var e=this.$refs.oRightFormulaPanel.getFormulaData();if(e){var a=t.Constraint,r=t.Priority,o=t.ID,s=e.Content,c=e.PropertyList,n=e.Remark,u=Object(i.a)({ID:o,Constraint:a,Priority:r,Content:s,PropertyList:c,Remark:n},this.Condition4getFormulaProperty,{CraftPriceID:this.CraftPriceID});this.submitSave(u)}}},submitSave:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function a(){var r,i,o,s;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.api.getFormulaSave(t).catch((function(){}));case 2:(r=a.sent)&&200===r.status&&1e3===r.data.Status&&(i=!!t.ID,o=i?"编辑成功":"添加成功",s=function(){e.$store.commit("priceManage/setResultFormulaItemChange",[t,r.data.Data,e.isAllCostPage]),e.onGoBackClick()},e.messageBox.successSingle(o,s,s));case 4:case"end":return a.stop()}}),a)})))()}},created:function(){this.getInitDataFromRoutePath()}},u=(a("c916"),a("2877")),m=Object(u.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"mp-erp-price-module-price-table-result-formula-setup-page-wrap"},[a("header",[a("h2",[t._v(t._s(t.$route.params.name))]),a("span",[t._v("价格名称："+t._s(t.curPriceItem?t.curPriceItem.Name:""))]),!t.isQuotationPage&&t.curCraftPriceItemData?a("span",[t._v("设置工艺："+t._s(t.curCraftPriceItemData.Craft.Name))]):t._e(),t.isAllCostPage?a("span",[t._v("总费用")]):t._e()]),a("main",[a("ContionCommonComp",{ref:"oLeftComp",attrs:{ComparePropertyList:t.PriceItemPropertyList,PropertyList:t.PriceItemPropertyList,leftWidth:"45%",curEditData:t.curPriceTableResultFormulaData,rightTitle:"使用此公式"}},[a("FormulaPanelComp",{ref:"oRightFormulaPanel",staticClass:"mp-erp-product-module-formula-set-page-wrap",attrs:{hiddenHeader:"",isSingle:"",NowEditFormulaData:t.curPriceTableResultFormulaData||{},Condition4getProperty:t.Condition4getFormulaProperty}})],1)],1),a("footer",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmitClick}},[t._v("保存")]),a("el-button",{staticClass:"go-back",on:{click:t.onGoBackClick}},[t._v("返回")])],1)])}),[],!1,null,null,null);e.default=m.exports},c916:function(t,e,a){"use strict";var r=a("819d");a.n(r).a}}]);