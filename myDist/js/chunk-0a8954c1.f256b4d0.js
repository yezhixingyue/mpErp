(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0a8954c1"],{"228d":function(t,e,n){},"652c":function(t,e,n){"use strict";var o=n("228d");n.n(o).a},"65e6":function(t,e,n){"use strict";n.r(e);var o=(n("4de4"),n("7db0"),n("c740"),n("fb6a"),n("a434"),n("b0c0"),n("96cf"),n("1da1")),i=n("5530"),r=n("2f62"),a=n("ad32"),u={props:{visible:{type:Boolean,default:!1},saveData:{type:Object,default:null}},components:{CommonDialogComp:a.a},computed:{},data:function(){return{title:"添加方案",ruleForm:{ID:"",Name:"",Type:"",ProductID:""}}},methods:{onSubmit:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.ruleForm.validate().catch((function(){}));case 2:e.sent&&t.$emit("submit",t.ruleForm);case 4:case"end":return e.stop()}}),e)})))()},onCancle:function(){this.$emit("update:visible",!1)},onOpen:function(){this.$nextTick(this.initEditData)},onClosed:function(){this.$refs.ruleForm.resetFields()},initEditData:function(){this.title=this.saveData.ID?"编辑方案":"添加方案",this.ruleForm=Object(i.a)({},this.saveData)}}},s=(n("652c"),n("2877")),l={components:{SolutionSaveDialog:Object(s.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("CommonDialogComp",{staticClass:"mp-erp-comps-price-module-price-item-save-dialog-comp-wrap",attrs:{width:"700px",top:"15vh",title:t.title,visible:t.visible},on:{"update:visible":function(e){t.visible=e},submit:t.onSubmit,cancle:t.onCancle,open:t.onOpen,closed:t.onClosed}},[n("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"label-width":"100px","hide-required-asterisk":""}},[n("el-form-item",{attrs:{label:"方案名称：",prop:"Name",rules:[{required:!0,message:"方案名称不能为空"}]}},[n("el-input",{attrs:{"show-word-limit":"",maxlength:"8",size:"small"},model:{value:t.ruleForm.Name,callback:function(e){t.$set(t.ruleForm,"Name","string"==typeof e?e.trim():e)},expression:"ruleForm.Name"}})],1)],1)],1)}),[],!1,null,null,null).exports,CommonInteractionTable:n("7046").a},computed:Object(i.a)({},Object(r.e)("priceManage",["MakeupControlTypeList"]),{curTypeSolutionList:function(){var t=this;return!this.solutionList||!this.curControlType&&0!==this.curControlType||0===this.solutionList.length?[]:this.solutionList.filter((function(e){return e.Type===t.curControlType}))},curSolutionItem:function(){var t=this;return this.curSolutionID?this.solutionList.find((function(e){return e.ID===t.curSolutionID})):null}}),data:function(){return{curControlType:0,curSolutionID:"",solutionSaveVisible:!1,solutionSaveData:null,solutionList:[],isSolutionListLoading:!0}},methods:{onSolutionSaveClick:function(t){var e=t?this.solutionList.find((function(e){return e.ID===t})):null,n={ID:e?e.ID:"",Name:e?e.Name:"",Type:this.curControlType,ProductID:this.$route.params.id};this.solutionSaveData=n,this.solutionSaveVisible=!0},onSolutionSaveSubmit:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o,r,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o=e.solutionList.find((function(e){return e.Name===t.Name})))){n.next=4;break}return o.ID===t.ID?e.messageBox.failSingleError("保存失败","方案名称未发生更改"):e.messageBox.failSingleError("保存失败","存在相同的方案名称"),n.abrupt("return");case 4:return n.next=6,e.api.getMakeupSolutionSave(t).catch((function(){}));case 6:(r=n.sent)&&1e3===r.data.Status&&(a=function(){if(t.ID){var n=e.solutionList.find((function(e){return e.ID===t.ID}));n&&(n.Name=t.Name)}else e.solutionList.push(Object(i.a)({},t,{ID:r.data.Data})),1===e.curTypeSolutionList.length&&(e.curSolutionID=r.data.Data);e.solutionSaveVisible=!1},e.messageBox.successSingle("保存成功",a,a));case 8:case"end":return n.stop()}}),n)})))()},getMakeupSolutionList:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.getMakeupSolutionList(t.$route.params.id).catch((function(){}));case 2:n=e.sent,t.isSolutionListLoading=!1,n&&1e3===n.data.Status&&(t.solutionList=n.data.Data,t.solutionList.length>0&&(t.curSolutionID=t.solutionList[0].ID));case 5:case"end":return e.stop()}}),e)})))()},onRemoveClick:function(){var t=this;this.messageBox.warnCancelBox("确定要删除当前方案吗","方案名称：[ ".concat(this.curSolutionItem?this.curSolutionItem.Name:"未知方案名称"," ]"),(function(){t.getMakeupSolutionRemove()}))},getMakeupSolutionRemove:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.getMakeupSolutionRemove(t.curSolutionID).catch((function(){}));case 2:(n=e.sent)&&1e3===n.data.Status&&(o=function(){var e=t.solutionList.findIndex((function(e){return e.ID===t.curSolutionID}));if(e>-1){t.solutionList.splice(e,1);var n=t.solutionList.slice(e).find((function(e){return e.Type===t.curControlType}));if(n)t.curSolutionID=n.ID;else{var o=t.solutionList.slice(0,e).reverse().find((function(e){return e.Type===t.curControlType}));t.curSolutionID=o?o.ID:""}}},t.messageBox.successSingle("删除成功",o,o));case 4:case"end":return e.stop()}}),e)})))()},getTypeLength:function(t){return this.solutionList.filter((function(e){return e.Type===t})).length},onTableItemRemove:function(t){},onSetupPageJump:function(t,e,n){var o={ProductID:this.$route.params.id,PartID:e||"null",ProductName:this.$route.params.name,PartName:n||"null",SolutionName:this.curSolutionItem.Name,setType:t};this.$router.push({name:"MakeupCtrlConditionSet",params:o})}},watch:{curControlType:function(){this.curTypeSolutionList.length>0?this.curSolutionID=this.curTypeSolutionList[0].ID:this.curSolutionID=""}},mounted:function(){this.getMakeupSolutionList()}},c=(n("dbb6"),Object(s.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"mp-erp-price-manage-makeup-ctrl-page-wrap"},[n("header",[n("p",[t._v("当前产品："+t._s(t.$route.params.name))]),n("el-radio-group",{attrs:{size:"small"},model:{value:t.curControlType,callback:function(e){t.curControlType=e},expression:"curControlType"}},t._l(t.MakeupControlTypeList,(function(e){return n("el-radio-button",{key:e.ID,attrs:{label:e.ID}},[t._v(" "+t._s(e.Name)+"（"+t._s(t.getTypeLength(e.ID))+"） ")])})),1),n("div",{staticClass:"crtl"},[t.isSolutionListLoading?n("span",{staticClass:"is-font-size-12 is-gray"},[t._v(" 方案加载中...")]):n("el-scrollbar",{attrs:{"wrap-class":"scrollbar-wrapper"}},[n("el-radio-group",{attrs:{size:"small"},model:{value:t.curSolutionID,callback:function(e){t.curSolutionID=e},expression:"curSolutionID"}},t._l(t.curTypeSolutionList,(function(e){return n("el-radio-button",{key:e.ID,attrs:{label:e.ID}},[t._v(t._s(e.Name))])})),1)],1),t.isSolutionListLoading||0!==t.curTypeSolutionList.length?t._e():n("span",{staticClass:"is-font-size-12 is-gray"},[t._v("该分类尚无方案，请添加")]),n("span",{staticClass:"blue-span",on:{click:function(e){return t.onSolutionSaveClick(null)}}},[t._v("+添加方案")]),t.curSolutionID?n("div",{staticClass:"menus"},[n("span",{staticClass:"blue-span",on:{click:function(e){return t.onSolutionSaveClick(t.curSolutionID)}}},[t._v("编辑当前方案名称")]),n("span",{staticClass:"red-span",on:{click:t.onRemoveClick}},[t._v("删除当前方案")])]):t._e()],1)],1),n("main",[n("SolutionSaveDialog",{attrs:{visible:t.solutionSaveVisible,saveData:t.solutionSaveData},on:{"update:visible":function(e){t.solutionSaveVisible=e},submit:t.onSolutionSaveSubmit}}),n("CommonInteractionTable",{attrs:{type:""+t.curControlType,titleObj:{title:"产品尺寸数量",btnText:"+ 添加拼版尺寸数量设置"},dataList:[],PropertyList:[]},on:{remove:t.onTableItemRemove,setup:function(e){return t.onSetupPageJump(e,"","")}}})],1)])}),[],!1,null,null,null));e.default=c.exports},c589:function(t,e,n){},dbb6:function(t,e,n){"use strict";var o=n("c589");n.n(o).a}}]);