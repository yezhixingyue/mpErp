(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-9c8985c0"],{1563:function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return u})),i.d(e,"c",(function(){return p})),i("7db0"),i("4160"),i("caad"),i("d81d"),i("d3b7"),i("25f0"),i("2532"),i("159b");var n=i("5530"),a=i("d4ec"),l=i("bee2"),o=i("ade3"),s=i("247a"),r=[{Name:"Numberic",ID:1,label:"数字值"},{Name:"Option",ID:2,label:"选择项"},{Name:"Switch",ID:3,label:"开关"}],u=[{Name:"单选按钮",ID:0},{Name:"下拉框",ID:1}],c=function(t,e){var i=t;i[e].DefineList.length>0&&(i[e].DefineList.includes("staff")&&(i[e].Allow=!0),i[e].DefineList.includes("customer")&&(i[e].AllowCustomer=!0)),delete i[e].DefineList},p=function(){function t(e,i){if(Object(a.a)(this,t),Object(o.a)(this,"ID",""),Object(o.a)(this,"Name",""),Object(o.a)(this,"IsNameHidden",!1),Object(o.a)(this,"PositionID",""),Object(o.a)(this,"Type","Numberic"),Object(o.a)(this,"HiddenToCustomer",!1),Object(o.a)(this,"DefaultValue",""),Object(o.a)(this,"NumbericAttribute",{AllowDecimal:!1,InputContent:"",CheckedValue:"",Unit:"",IsRequired:!1,IsWidthAdaption:!0,DisplayWidth:"",DefineList:[],SectionList:[]}),Object(o.a)(this,"OptionAttribute",{OptionList:[],defaultSingleOption:"",IsWidthAdaption:!0,DisplayWidth:"",DefineList:[],CustomizeValue:"",ChooseType:"single",IsRequired:!1,SelectMode:0,UseTimes:{MinValue:"",MaxValue:""}}),Object(o.a)(this,"SwitchAttribute",{Words:"",OpenValue:"",CloseValue:"",DefaultOpen:!1}),i&&(this.PositionID=i),e&&"[object Object]"===Object.prototype.toString.call(e)){var l=JSON.parse(JSON.stringify(e)),u=l.Name,c=l.Type,p=l.DefaultValue,h=l.HiddenToCustomer,b=l.ID,d=l.IsNameHidden,m=l.NumbericAttribute,f=l.OptionAttribute,v=l.SwitchAttribute,g=l.PositionID;if(u&&(this.Name=u),c||0===c){var S=function(t,e){var i=t.find((function(t){return t.ID===e}));return i?i.Name:""}(r,c);S&&(this.Type=S)}if((p||0===p)&&(this.DefaultValue="".concat(p)),h&&(this.HiddenToCustomer=h),b&&(this.ID=b),d&&(this.IsNameHidden=d),g&&!i&&(this.PositionID=g),1===c&&m){var w=m.Allow,C=m.AllowCustomer,D=m.AllowDecimal,y=m.CheckedValue,x=m.DisplayWidth,L=m.InputContent,O=m.IsRequired,k=m.IsWidthAdaption,A=m.Unit,I=m.SectionList;D&&(this.NumbericAttribute.AllowDecimal=D),L&&(this.NumbericAttribute.InputContent=L),(y||0===y)&&(this.NumbericAttribute.CheckedValue="".concat(y)),x&&(this.NumbericAttribute.DisplayWidth=x),O&&(this.NumbericAttribute.IsRequired=O),k||(this.NumbericAttribute.IsWidthAdaption=k),A&&(this.NumbericAttribute.Unit=A),w&&(this.NumbericAttribute.DefineList=["staff"]),w&&C&&(this.NumbericAttribute.DefineList=["staff","customer"]),I&&I.length>0&&(this.NumbericAttribute.SectionList=I.map((function(t){return Object(n.a)({},t,{key:Object(s.g)(8),Increment:t.Increment?"".concat(t.Increment):"",MinValue:"".concat(t.MinValue),MaxValue:"".concat(t.MaxValue)})})))}if(2===c&&f){var T=f.Allow,_=f.AllowCustomer,N=f.CustomizeValue,E=f.DisplayWidth,$=f.IsRadio,U=f.IsRequired,j=f.IsWidthAdaption,M=f.SelectMode,V=f.UseTimes,R=f.OptionList;if(T&&(this.OptionAttribute.DefineList=["staff"]),T&&_&&(this.OptionAttribute.DefineList=["staff","customer"]),(N||0===N)&&(this.OptionAttribute.CustomizeValue="".concat(N)),E&&(this.OptionAttribute.DisplayWidth=E),$||(this.OptionAttribute.ChooseType="multiple"),U&&(this.OptionAttribute.IsRequired=U),j||(this.OptionAttribute.IsWidthAdaption=j),(M||0===M)&&(this.OptionAttribute.SelectMode=M),R&&R.length>0&&(this.OptionAttribute.OptionList=R.map((function(t){return Object(n.a)({},t,{key:Object(s.g)(8),Value:"".concat(t.Value)})})),$)){var B=this.OptionAttribute.OptionList.find((function(t){return t.IsChecked}));B&&(this.OptionAttribute.defaultSingleOption=B.key)}V&&f.UseTimes.MaxValue&&(this.OptionAttribute.UseTimes.MinValue=V.MinValue,this.OptionAttribute.UseTimes.MaxValue=V.MaxValue)}if(3===c&&v){var H=v.OpenValue,F=v.CloseValue,W=v.DefaultOpen,z=v.Words;z&&(this.SwitchAttribute.Words=z),W&&(this.SwitchAttribute.DefaultOpen=W),(H||0===H)&&(this.SwitchAttribute.OpenValue="".concat(H)),(F||0===F)&&(this.SwitchAttribute.CloseValue="".concat(F))}}}return Object(l.a)(t,null,[{key:"formatSubmitData",value:function(t){if(!t)return null;var e=JSON.parse(JSON.stringify(t)),i=function(t,e){var i=t.find((function(t){return t.Name===e}));return i?i.ID:""}(r,e.Type);if(e.DefaultValue=+e.DefaultValue,i.toString())switch(e.Type=i,e.Type){case 1:c(e,"NumbericAttribute"),delete e.OptionAttribute,delete e.SwitchAttribute;break;case 2:c(e,"OptionAttribute"),function(t){var e=t;if("single"===e.OptionAttribute.ChooseType){if(e.OptionAttribute.IsRadio=!0,e.OptionAttribute.OptionList.forEach((function(t){t.IsChecked=!1})),e.OptionAttribute.defaultSingleOption){var i=e.OptionAttribute.OptionList.find((function(t){return t.key===e.OptionAttribute.defaultSingleOption}));i&&(i.IsChecked=!0)}delete e.OptionAttribute.UseTimes}else"multiple"===e.OptionAttribute.ChooseType&&(e.OptionAttribute.IsRadio=!1,delete e.OptionAttribute.SelectMode,delete e.OptionAttribute.IsRequired);delete e.OptionAttribute.ChooseType,delete e.OptionAttribute.defaultSingleOption}(e),delete e.NumbericAttribute,delete e.SwitchAttribute;break;case 3:delete e.OptionAttribute,delete e.NumbericAttribute}return e}}]),t}()},"1dc0":function(t,e,i){"use strict";var n=i("babe");i.n(n).a},"240c":function(t,e,i){"use strict";i.r(e);var n=(i("99af"),i("96cf"),i("1da1")),a=i("5530"),l={props:{visible:{type:Boolean,default:!1}},data:function(){return{explain1:{value1:0,options1:[{label:"铜版纸白色",value:0},{label:"铜版纸黑色",value:1},{label:"双胶纸白色",value:2},{label:"双胶纸黑色",value:3}],value2:0,options2:[{label:"157克",value:0},{label:"200克",value:1}]},explain2:{value1:0,options1:[{label:"铜版纸",value:0},{label:"双胶纸",value:1}],value2:0,options2:[{label:"157克",value:0},{label:"200克",value:1}],value3:0,options3:[{label:"白色",value:0},{label:"黑色",value:1}]},explain3:{value1:0,options1:[{label:"铜版纸白色157克",value:0},{label:"铜版纸黑色157克",value:1},{label:"双胶纸白色157克",value:2},{label:"双胶纸白色157克",value:3},{label:"铜版纸白色200克",value:4},{label:"铜版纸黑色200克",value:5},{label:"双胶纸白色200克",value:6},{label:"双胶纸白色200克",value:7}]}}},methods:{handleClose:function(){this.$emit("update:visible",!1)}}},o=(i("a085"),i("2877")),s=Object(o.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-drawer",{staticClass:"mp-erp-material-type-page-explain-drawer-comp-wrap",attrs:{visible:t.visible,"show-close":!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.visible=e}}},[i("span",{staticClass:"explain-title",attrs:{slot:"title"},on:{click:t.handleClose},slot:"title"},[i("i",{staticClass:"el-icon-arrow-right"}),t._v(" 说明")]),i("div",{staticClass:"text-box"},[i("p",{staticClass:"title"},[t._v("元素组合显示： ")]),i("p",[t._v("根据物料元素组合显示相应联动下拉框，具体看示例：")]),i("ul",[i("li",[i("span",[t._v("假如：我们设置类型“纸张”有三个元素：")]),i("span",{staticClass:"is-pink"},[t._v("“种类”、“克重”、“颜色”")]),i("span",[t._v("：")])]),i("li",[i("span",[t._v("种类：铜版纸、双胶纸；")])]),i("li",[i("span",[t._v("克重：80克、157克、200克；")])]),i("li",[i("span",[t._v("颜色：白色、黑色")])])]),i("p",{},[t._v("根据以上值我们生成 12 种物料，都应用到某一产品中，这时根据不同设置显示不同的联动下拉框，如下：")])]),i("div",{staticClass:"explain-box"},[i("div",[i("span",[t._v("界面展现")]),i("span",[t._v("相应设置")])]),i("ul",[i("li",[i("div",{staticClass:"left"},[i("el-select",{attrs:{size:"mini"},model:{value:t.explain1.value1,callback:function(e){t.$set(t.explain1,"value1",e)},expression:"explain1.value1"}},t._l(t.explain1.options1,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),i("el-select",{attrs:{size:"mini"},model:{value:t.explain1.value2,callback:function(e){t.$set(t.explain1,"value2",e)},expression:"explain1.value2"}},t._l(t.explain1.options2,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),i("div",{staticClass:"right"},[i("span",[t._v("种类+颜色")]),i("i",[t._v("|")]),i("span",[t._v("克重")])])]),i("li",[i("div",{staticClass:"left"},[i("el-select",{attrs:{size:"mini"},model:{value:t.explain2.value1,callback:function(e){t.$set(t.explain2,"value1",e)},expression:"explain2.value1"}},t._l(t.explain2.options1,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),i("el-select",{attrs:{size:"mini"},model:{value:t.explain2.value2,callback:function(e){t.$set(t.explain2,"value2",e)},expression:"explain2.value2"}},t._l(t.explain2.options2,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),i("el-select",{attrs:{size:"mini"},model:{value:t.explain2.value3,callback:function(e){t.$set(t.explain2,"value3",e)},expression:"explain2.value3"}},t._l(t.explain2.options3,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),i("div",{staticClass:"right"},[i("span",[t._v("种类")]),i("i",[t._v("|")]),i("span",[t._v("克重")]),i("i",[t._v("|")]),i("span",[t._v("颜色")])])]),i("li",[i("div",{staticClass:"left"},[i("el-select",{attrs:{size:"mini"},model:{value:t.explain3.value1,callback:function(e){t.$set(t.explain3,"value1",e)},expression:"explain3.value1"}},t._l(t.explain3.options1,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),i("div",{staticClass:"right"},[i("span",[t._v("种类+克重+颜色")])])])])])])}),[],!1,null,null,null).exports,r=i("ad32"),u={props:{visible:{type:Boolean,default:!1},curData:{type:Object,default:null}},components:{CommonDialogComp:r.a},data:function(){return{title:"添加物料类型",ruleForm:null,rules:{Name:[{required:!0,message:"请输入物料类型名称",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}]}}},methods:{onSubmit:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.ruleForm.validate().catch((function(){}));case 2:e.sent&&t.$emit("submit",t.ruleForm);case 4:case"end":return e.stop()}}),e)})))()},onCancle:function(){this.$emit("update:visible",!1)},onOpen:function(){this.$nextTick(this.initEditData)},onClosed:function(){this.ruleForm=null},initEditData:function(){this.title=this.curData?"编辑物料类型":"添加物料类型",this.ruleForm={Name:"",ID:"",ElementList:[],UnionShowList:[]},this.curData&&(this.ruleForm=Object(a.a)({},this.curData))}}},c=(i("3582"),Object(o.a)(u,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("CommonDialogComp",{staticClass:"mp-erp-comps-material-type-save-dialog-comp-wrap",attrs:{width:"700px",top:"18vh",title:t.title,visible:t.visible},on:{"update:visible":function(e){t.visible=e},submit:t.onSubmit,cancle:t.onCancle,open:t.onOpen,closed:t.onClosed}},[t.ruleForm?i("el-form",{ref:"ruleForm",staticClass:"file-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"168px",size:"small"}},[i("el-form-item",{key:"FileName",attrs:{label:"名称：",prop:"Name"}},[i("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入物料类型名称",maxlength:"10","show-word-limit":""},model:{value:t.ruleForm.Name,callback:function(e){t.$set(t.ruleForm,"Name","string"==typeof e?e.trim():e)},expression:"ruleForm.Name"}})],1)],1):t._e()],1)}),[],!1,null,null,null)).exports,p=(i("4de4"),i("7db0"),i("a15b"),i("d81d"),i("2af0")),h=i("2387"),b={props:{dataList:{default:function(){return[]},type:Array},loading:{type:Boolean,default:!1}},components:{TipsSpanButton:h.a},computed:{localTableData:function(){var t=this;return this.dataList&&Array.isArray(this.dataList)&&0!==this.dataList.length?this.dataList.map((function(e){return Object(a.a)({},e,{Elements:e.ElementList.map((function(t){return t.Name})).join("、"),UnionShowText:t.getUnionShowText(e)})})):[]}},mixins:[p.a],methods:{setHeight:function(){var t=this.getHeight(".mp-erp-material-type-page-wrap > header",53);this.h=t},onEditClick:function(t){this.$emit("edit",t)},onRemoveClick:function(t){this.$emit("remove",t)},onElementSetClick:function(t){this.$emit("setElement",t)},onUnionShowSetClick:function(t){this.$emit("setUnionShow",t)},onFormulaSetClick:function(t){this.$emit("setFormula",t)},getUnionShowText:function(t){var e=t.UnionShowList,i=t.ElementList;return e.map((function(t){return t.map((function(t){var e=i.find((function(e){return e.ID===t}));return e?e.Name:""})).filter((function(t){return t})).join("+")})).join(" | ")}}},d=(i("4402"),Object(o.a)(b,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-table",{key:"mp-erp-material-type-page-material-size-table-comp-wrap",staticClass:"mp-erp-material-type-page-material-size-table-comp-wrap",staticStyle:{width:"100%"},attrs:{"max-height":t.h,height:t.h,stripe:"",border:"",data:t.localTableData,fit:""}},[i("el-table-column",{attrs:{prop:"Name",label:"名称",width:"260"}}),i("el-table-column",{attrs:{prop:"Elements",label:"元素","min-width":"240","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"UnionShowText",label:"组合显示","min-width":"240","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{label:"操作","min-width":"520","class-name":"menu-column"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{staticClass:"menu-list"},[i("TipsSpanButton",{attrs:{text:"设置元素"},nativeOn:{click:function(i){return t.onElementSetClick(e.row)}}}),i("TipsSpanButton",{attrs:{text:"元素组合显示"},nativeOn:{click:function(i){return t.onUnionShowSetClick(e.row)}}}),i("TipsSpanButton",{attrs:{text:"物料公式"},nativeOn:{click:function(i){return t.onFormulaSetClick(e.row)}}}),i("span",{staticClass:"icon-span",on:{click:function(i){return t.onEditClick(e.row)}}},[i("i"),t._v("编辑")]),i("span",{staticClass:"icon-span",on:{click:function(i){return t.onRemoveClick(e.row)}}},[i("i"),t._v("删除")])],1)}}])}),i("div",{attrs:{slot:"empty"},slot:"empty"},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}]},[t._v("暂无数据")])])],1)}),[],!1,null,null,null)).exports,m=(i("4160"),i("a434"),i("159b"),i("3835")),f=i("2909"),v=i("b76a"),g=i.n(v),S=i("1563"),w={components:{CommonDialogComp:r.a,draggable:g.a},props:{visible:{type:Boolean,default:!1},curData:{type:Object,default:null}},data:function(){return{checkList:[],ErrMsg:"",UnionShowList:[],dragOptions:{animation:180,ghostClass:"ghost",tag:"ul"}}},computed:{UnionShowIDs:function(){var t=[];return this.UnionShowList&&this.UnionShowList.length>0&&this.UnionShowList.forEach((function(e){t.push.apply(t,Object(f.a)(e))})),t}},methods:{onSubmit:function(){this.$emit("submit",this.UnionShowList)},onCancle:function(){this.$emit("update:visible",!1)},onClosed:function(){this.UnionShowList=[],this.ErrMsg=""},getCheckLabel:function(t){var e=t.Name,i=t.Type,n="",a=S.b.find((function(t){return t.ID===i}));return a&&(n="（".concat(a.label,"）")),"".concat(e).concat(n)},getItemText:function(t){var e=this;return t&&0!==t.length?t.map((function(t){var i=e.curData.ElementList.find((function(e){return e.ID===t}));return i?i.Name:""})).filter((function(t){return t})).join(" + "):""},onUnionClick:function(){0===this.checkList.length?this.ErrMsg="请先选择元素":(this.ErrMsg="",this.UnionShowList.push(this.checkList),this.checkList=[])},onItemRemove:function(t){this.UnionShowList.splice(t,1)},onMove:function(t,e){var i=this.UnionShowList.splice(e,1),n=Object(m.a)(i,1)[0],a="up"===t?e-1:e+1;this.UnionShowList.splice(a,0,n)},onOpen:function(){this.UnionShowList=JSON.parse(JSON.stringify(this.curData.UnionShowList))}}},C=(i("4d2b"),Object(o.a)(w,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("CommonDialogComp",{staticClass:"mp-erp--material-type-union-show-dialog-comp-wrap",attrs:{width:"700px",top:"13vh",title:"元素组合显示",visible:t.visible,disabled:t.curData&&0===t.curData.ElementList.length},on:{"update:visible":function(e){t.visible=e},cancle:t.onCancle,open:t.onOpen,submit:t.onSubmit,closed:t.onClosed}},[t.curData?[i("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.curData.ElementList,(function(e){return i("el-checkbox",{key:e.ID,attrs:{label:e.ID,disabled:t.UnionShowIDs.includes(e.ID)}},[t._v(t._s(t.getCheckLabel(e)))])})),1),0===t.curData.ElementList.length?i("div",[i("el-alert",{attrs:{closable:!1,title:"暂无可用元素，请先设置元素 ！","show-icon":"",type:"error"}})],1):t._e(),i("p",{staticClass:"title"},[t._v("当前选择顺序")]),i("p",{staticClass:"btn"},[i("span",{staticClass:"blue-span",on:{click:t.onUnionClick}},[t._v("生成组合")]),i("span",{staticClass:"is-pink is-font-size-12"},[t._v(t._s(t.ErrMsg))])]),i("draggable",t._b({staticClass:"drag-wrap",model:{value:t.UnionShowList,callback:function(e){t.UnionShowList=e},expression:"UnionShowList"}},"draggable",t.dragOptions,!1),t._l(t.UnionShowList,(function(e,n){return i("li",{key:JSON.stringify(e)},[i("span",{attrs:{title:t.getItemText(e)}},[t._v(t._s(t.getItemText(e)))]),i("div",{staticClass:"ctrl"},[i("span",{staticClass:"del-btn",on:{click:function(e){return t.onItemRemove(n)}}},[i("i"),t._v(" 删除")]),i("div",[i("span",{directives:[{name:"show",rawName:"v-show",value:n<t.UnionShowList.length-1,expression:"i < UnionShowList.length - 1"}],on:{click:function(e){return t.onMove("down",n)}}},[i("i",{staticClass:"el-icon-bottom"}),t._v(" 下移")])]),i("div",[i("span",{directives:[{name:"show",rawName:"v-show",value:n>0,expression:"i > 0"}],on:{click:function(e){return t.onMove("up",n)}}},[i("i",{staticClass:"el-icon-top"}),t._v(" 上移")])])])])})),0)]:t._e()],2)}),[],!1,null,null,null)).exports,D=i("2f62"),y={components:{ExplainDrawer:s,MaterialTypeSaveDialog:c,MaterialTypeTableComp:d,UnionShowDialogComp:C},data:function(){return{drawer:!1,visible:!1,unionShowVisible:!1,curSaveData:null,listDataLoading:!1}},computed:Object(a.a)({},Object(D.e)("basicSet",["MaterialTypeList"])),methods:{onMaterialTypeSaveClick:function(t){this.curSaveData=t||null,this.visible=!0},onElementSetSubmit:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function i(){var n,a,l,o,s;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t){i.next=2;break}return i.abrupt("return");case 2:return n=!!t.ID,i.next=5,e.api.getMaterialTypeSave(t).catch((function(){}));case 5:(a=i.sent)&&200===a.status&&1e3===a.data.Status&&(l={isEdit:n,data:t,ID:a.data.Data},o=function(){e.handleEditSubmitSuccess(l)},s=n?"编辑成功":"添加成功",e.messageBox.successSingle(s,o,o));case 7:case"end":return i.stop()}}),i)})))()},handleEditSubmitSuccess:function(t){var e=t.isEdit,i=t.data,n=t.ID;this.$store.commit("basicSet/setMaterialTypeSave",{isEdit:e,data:i,ID:n}),this.visible=!1},onRemoveClick:function(t){var e=this;t&&this.messageBox.warnCancelBox("确定删除该物料类型吗","类型名称：[ ".concat(t.Name," ]"),(function(){e.$store.dispatch("basicSet/getMaterialTypeRemove",t.ID)}))},onSetElementClick:function(t){t&&t.ID&&this.$router.push("/MaterialElementSet/".concat(t.ID,"/").concat(t.Name))},onSetUnionShowClick:function(t){this.curSaveData=t,this.unionShowVisible=!0},onUnionShowSetSaveSubmit:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function i(){var n,a,l;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.curSaveData&&t){i.next=2;break}return i.abrupt("return");case 2:return n={UnionShowList:t,ID:e.curSaveData.ID},i.next=5,e.api.getMaterialTypeElementUnionShowSetup(n).catch((function(){}));case 5:(a=i.sent)&&200===a.status&&1e3===a.data.Status&&(l=function(){e.$store.commit("basicSet/setMaterialTypeUnionShowListChange",n),e.unionShowVisible=!1},e.messageBox.successSingle("设置成功",l,l));case 7:case"end":return i.stop()}}),i)})))()},onSetFormulaClick:function(t){t&&t.ID&&this.$router.push("/MaterialFormulaList/".concat(t.ID,"/").concat(t.Name,"/").concat(Date.now()))},getListData:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.listDataLoading=!0,e.next=3,t.$store.dispatch("basicSet/getMaterialTypeList");case 3:t.listDataLoading=!1;case 4:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.getListData()}},x=(i("1dc0"),Object(o.a)(y,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"mp-erp-material-type-page-wrap"},[i("header",[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onMaterialTypeSaveClick(null)}}},[t._v("添加物料类型")]),i("span",{staticClass:"info",attrs:{title:"点击查看"},on:{click:function(e){t.drawer=!0}}},[i("i",[t._v("?")]),i("em",[t._v("元素组合说明")])])],1),i("main",[i("ExplainDrawer",{attrs:{visible:t.drawer},on:{"update:visible":function(e){t.drawer=e}}}),i("MaterialTypeSaveDialog",{attrs:{visible:t.visible,curData:t.curSaveData},on:{"update:visible":function(e){t.visible=e},submit:t.onElementSetSubmit}}),i("UnionShowDialogComp",{attrs:{visible:t.unionShowVisible,curData:t.curSaveData},on:{"update:visible":function(e){t.unionShowVisible=e},submit:t.onUnionShowSetSaveSubmit}}),t._v(" "),i("MaterialTypeTableComp",{attrs:{loading:t.listDataLoading,dataList:t.MaterialTypeList},on:{edit:t.onMaterialTypeSaveClick,remove:t.onRemoveClick,setElement:t.onSetElementClick,setUnionShow:t.onSetUnionShowClick,setFormula:t.onSetFormulaClick}})],1),i("footer",[i("span",[t._v("共检索出 "),i("i",[t._v(t._s(t.MaterialTypeList.length))]),t._v(" 条数据")])])])}),[],!1,null,null,null));e.default=x.exports},"2af0":function(t,e,i){"use strict";i("4de4"),i("7db0"),i("c740"),i("caad"),i("d81d"),i("a434"),i("2532");var n=i("3835"),a=i("2909"),l=i("5530"),o=i("aa47"),s=i("c117"),r=i("2f62");e.a={data:function(){return{h:0,sortItem:null,tableKey:this.$utils.getRandomRangeId(8),notify:null,hideColLabelList:[],localShowLabelList:[]}},watch:{h:function(t){this.h=t;var e=document.getElementsByClassName("el-table")[0];e&&(e.style.maxHeight="".concat(t,"px"))},hideColLabelList:function(){var t=this;this.tableColData=this.tableColData.map((function(e){var i=Object(l.a)({},e);return t.hideColLabelList.includes(e.label)?i.show=!1:i.show=!0,i}))},isLeftCollapse:function(t){var e=this;setTimeout((function(){e.setHeightByDebounce()}),t?700:450)}},computed:Object(l.a)({},Object(r.e)("layout",["isLeftCollapse"]),{colLabels:function(){return this.tableColData?this.tableColData.map((function(t){return t.label})):[]},curShowColTableData:function(){return this.tableColData?this.tableColData.filter((function(t){return t.show})):[]}}),methods:{getHeight:function(t,e){var i=document.querySelector("#app > section > main");if(!i)return 600;var n=t?document.querySelector(t):null;return(n?i.offsetHeight-n.offsetHeight:i.offsetHeight)-e},initHeightAuto:function(){var t=this;this.$nextTick((function(){return t.setHeightByDebounce()})),window.addEventListener("resize",this.setHeightByDebounce)},removeHeightAuto:function(){window.removeEventListener("resize",this.setHeightByDebounce)},onHeaderDragend:function(t,e,i){var n=this;if(this.tableColData){var a=this.tableColData.find((function(t){return t.label===i.label}));if(a&&(a.width&&(a.width="".concat(t,"px")),a.minWidth&&(a.minWidth="".concat(t,"px"))),this.sortItem){try{this.sortItem.destroy()}catch(t){}this.$nextTick((function(){n.commonTableSortMixin()}))}}},commonTableSortMixin:function(){if(this.tableColData){var t=document.querySelector(".el-table__header thead tr"),e={onEnd:this.handleSortEnd};try{this.sortItem=o.a.create(t,e)}catch(t){}}},handleSortEnd:function(t){var e=this,i=t.oldIndex-1,l=t.newIndex-1;if(this.curShowColTableData.length<this.tableColData.length&&this.curShowColTableData[i]){var o=this.curShowColTableData[i].label,s=this.tableColData.findIndex((function(t){return t.label===o}));if(s>=0&&(i=s),l>0){var r=this.curShowColTableData[l-1].label,u=this.tableColData.findIndex((function(t){return t.label===r}));u>=0&&(l=u+1)}}var c=Object(a.a)(this.tableColData),p=c.splice(i,1),h=Object(n.a)(p,1)[0];c.splice(l,0,h),this.tableColData=c,this.tableKey=this.$utils.getRandomRangeId(8),this.$nextTick((function(){e.commonTableSortMixin()}))},handleMountedAndActivated:function(){var t=this;if(this.setHeightByDebounce=Object(s.a)(this.setHeight,30),this.initHeightAuto(),this.commonTableSortMixin(),this.tableName){var e=JSON.parse(localStorage.getItem(this.tableName));e.length>0&&(e=e.filter((function(e){return t.colLabels.includes(e)}))),this.hideColLabelList=e}},handleDestroyAndDeactivated:function(){if(this.removeHeightAuto(),this.sortItem)try{this.sortItem.destroy()}catch(t){}},onInfoClick:function(){var t=this,e=this.$createElement;if(this.tableColData){var i=160;this.$refs.oElTable&&this.$refs.oElTable.$el&&this.$refs.oElTable.$el.offsetTop&&(i=this.$refs.oElTable.$el.offsetTop-17),this.localShowLabelList=this.colLabels.filter((function(e){return!t.hideColLabelList.includes(e)}));var n=function(){t.notify&&t.notify.close()},l=function(e){var i=t.localShowLabelList.findIndex((function(t){return t===e}));i>=0?t.localShowLabelList.splice(i,1):t.localShowLabelList.push(e)},o=e("section",{class:"content-box"},[e("main",[e("el-checkbox-group",{attrs:{value:this.localShowLabelList}},[this.tableColData.map((function(t){return e("el-checkbox",{on:{change:function(){return l(t.label)}},attrs:{label:t.label},key:t.label})}))])]),e("footer",[e("el-button",{on:{click:function(){t.hideColLabelList=t.colLabels.filter((function(e){return!t.localShowLabelList.includes(e)})),t.tableName&&localStorage.setItem(t.tableName,JSON.stringify(t.hideColLabelList)),n()}},attrs:{type:"primary"}},["保存"]),e("el-button",{on:{click:n}},["关闭"]),e("span",{class:"span-title-blue",on:{click:function(){var e,i=t.colLabels.filter((function(e){return!t.localShowLabelList.includes(e)}));(e=t.localShowLabelList).push.apply(e,Object(a.a)(i))}}},["重置"]),e("p",{class:"is-gray"},[e("span",["1. 没有被选中的列将会被隐藏"]),e("span",["2. 列显示隐藏设置会缓存至本地，在不清除缓存或版本更新的情况下，下次打开会自动延续本次设置"]),e("span",["3. 中间列可左右拖动（不被缓存）"])])])]);this.notify=this.$notify({title:"设置列显示",customClass:"mp-erp-table-column-show-setup-wrap",duration:0,message:o,offset:i})}}},mounted:function(){this.handleMountedAndActivated()},beforeDestroy:function(){this.handleDestroyAndDeactivated()},activated:function(){this.handleMountedAndActivated()},deactivated:function(){this.handleDestroyAndDeactivated()}}},"2b50":function(t,e,i){},3582:function(t,e,i){"use strict";var n=i("c19b");i.n(n).a},4402:function(t,e,i){"use strict";var n=i("b335");i.n(n).a},"468e":function(t,e,i){"use strict";var n=i("4aae");i.n(n).a},"4aae":function(t,e,i){},"4d2b":function(t,e,i){"use strict";var n=i("5b0f");i.n(n).a},"5b0f":function(t,e,i){},a085:function(t,e,i){"use strict";var n=i("2b50");i.n(n).a},ad32:function(t,e,i){"use strict";var n={model:{prop:"value",event:"change"},props:{visible:{type:Boolean,default:!1},title:{type:String,default:"提示"},width:{default:"30%"},top:{type:String,default:"15vh"},showSubmit:{type:Boolean,default:!0},submitText:{type:String,default:"保存"},dangerText:{type:String,default:"重新生成"},cancelText:{type:String,default:"取消"},disabled:{type:Boolean,default:!1},showDanger:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},data:function(){return{checkList:[]}},methods:{onCancleClick:function(){this.$emit("cancle")},onSubmitClick:function(t){this.dialogVisible&&("BUTTON"===t.target.nodeName?t.target.blur():"BUTTON"===t.target.parentNode.nodeName&&t.target.parentNode.blur(),this.$emit("submit"))},onDangerClick:function(){this.$emit("danger")},onOpen:function(){this.$emit("open")},onOpened:function(){this.$emit("opened")},onClose:function(){this.$emit("close")},onClosed:function(){this.$emit("closed")}}},a=(i("468e"),i("2877")),l=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header mp-erp-common-dialog-comp-wrap",attrs:{title:t.title,visible:t.dialogVisible,"close-on-click-modal":!1,width:t.width,top:t.top,modal:!1,"before-close":t.onCancleClick},on:{"update:visible":function(e){t.dialogVisible=e},open:t.onOpen,opened:t.onOpened,close:t.onClose,closed:t.onClosed}},[t._t("default"),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.$slots["foot-tip"]?i("div",[t._t("foot-tip")],2):t._e(),i("p",[t.showSubmit?i("el-button",{attrs:{type:"primary",loading:t.loading,disabled:t.disabled},on:{click:t.onSubmitClick}},[t._v(t._s(t.loading?"加载中":t.submitText))]):t._e(),t.showDanger?i("el-button",{attrs:{type:"danger"},on:{click:t.onDangerClick}},[t._v(t._s(t.dangerText))]):t._e(),i("el-button",{on:{click:t.onCancleClick}},[t._v(t._s(t.cancelText))])],1)])],2)}),[],!1,null,null,null);e.a=l.exports},b335:function(t,e,i){},babe:function(t,e,i){},c19b:function(t,e,i){}}]);