(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4f25547f"],{"4d642":function(t,e,n){"use strict";var i=n("921c");n.n(i).a},6173:function(t,e,n){"use strict";var i=n("e5ca");n.n(i).a},"6e84":function(t,e,n){"use strict";var i={props:{leftWidth:{type:String,default:"49%"},single:{type:Boolean,default:!1}},data:function(){return{leftW:"48%",offsetWidth:0,oLeft:null,moving:!1,distance:7,initPageX:0}},methods:{onLineDown:function(t){!this.oLeft&&this.$refs.oLeft&&(this.oLeft=this.$refs.oLeft),this.oLeft&&(this.offsetWidth=this.oLeft.offsetWidth,document.addEventListener("mousemove",this.onLineMove),document.addEventListener("mouseup",this.onLineUp),this.moving=!0,this.distance=t.offsetX,this.initPageX=t.pageX),t.preventDefault()},onLineMove:function(t){this.leftW="".concat(t.pageX-this.initPageX-this.distance+this.offsetWidth,"px")},onLineUp:function(){document.removeEventListener("mousemove",this.onLineMove),document.removeEventListener("mouseup",this.onLineUp),this.moving=!1}},created:function(){this.leftW=this.leftWidth}},a=(n("6173"),n("2877")),s=Object(a.a)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{ref:"oWrap",staticClass:"mp-erp-common-comps-left-and-right-width-drap-auto-change-comp-wrap"},[n("div",{ref:"oLeft",staticClass:"left mp-scroll-wrap",style:"width:"+t.leftW},[t._t("left")],2),t.single?t._e():n("span",{staticClass:"vertical-line",class:t.moving?"moving":"",on:{mousedown:t.onLineDown}},[n("i")]),n("div",{staticClass:"right mp-scroll-wrap"},[t._t("right")],2)])}),[],!1,null,null,null);e.a=s.exports},"90bf":function(t,e,n){"use strict";var i=(n("99af"),n("d81d"),n("a9e3"),n("96cf"),n("1da1")),a=n("5530"),s=n("2909"),c=n("3835"),o=n("6e84"),r=(n("4160"),n("a434"),n("159b"),n("b76a")),l=n.n(r),u={props:{classifyData:{type:Array,default:function(){return[]}},title:{type:String,default:"产品"}},components:{draggable:l.a},data:function(){return{dataList:[],activeItemID:null,openList:[],editable:!1,recordOpenList:[]}},computed:{dragOptions:function(){return{animation:0,disabled:!this.editable,ghostClass:"ghost"}}},methods:{onActiveItemClick:function(t){this.activeItemID=t},onArrowClick:function(t,e){if(e){var n=0===this.openList[t]?1:0;this.openList.splice(t,1,n)}},onItemClassifyManageClick:function(t){if(!this.editable){var e="root"===t?this.classifyData:this.classifyData[t].children,n="root"===t?-1:this.classifyData[t].ID,i="root"===t?"根分类":this.classifyData[t].ClassName;this.$emit("setCurEditClassifyData",[e,n,i])}},onWrapMovEnd:function(t){var e=t.oldIndex,n=t.newIndex,i=this.openList.splice(e,1);this.openList.splice(n,0,i[0])},onSortClick:function(){this.editable=!0,this.recordOpenList=JSON.parse(JSON.stringify(this.openList))},onCancelClick:function(){this.dataList=JSON.parse(JSON.stringify(this.classifyData)),this.openList=this.recordOpenList,this.editable=!1},onSubmitClick:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var n,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dataList.map((function(t,e){return Object(a.a)({},t,{Index:e})})),t.dataList.forEach((function(t){if(t.children.length>0){var e=t.children.map((function(e,n){return Object(a.a)({},e,{Index:n,ParentID:t.ID})}));n.push.apply(n,Object(s.a)(e))}})),e.next=4,t.api.getClassOrder(n).catch((function(){}));case 4:(i=e.sent)&&200===i.status&&1e3===i.data.Status&&(c=function(){t.$emit("submit",n),t.editable=!1},t.messageBox.successSingle("保存成功",c,c));case 6:case"end":return e.stop()}}),e)})))()}},watch:{classifyData:{handler:function(t){t&&t.length>0?(this.dataList=JSON.parse(JSON.stringify(t)),this.openList=t.map((function(){return 1}))):(this.dataList=[],this.openList=[])},immediate:!0,deep:!0}}},f=(n("db06"),n("2877")),d=Object(f.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"mp-erp-product-classify-manage-page-left-content-wrap"},[n("header",[n("p",{staticClass:"mp-common-title-wrap"},[t._v(t._s(t.title)+"分类")])]),n("main",[n("p",[n("el-button",{staticClass:"cancel-blue-btn",on:{click:function(e){return t.onItemClassifyManageClick("root")}}},[t._v("管理根分类")])],1),n("div",{staticClass:"sort-wrap"},[t._m(0),t.dataList.length>0&&t.openList.length>0?n("draggable",t._b({staticClass:"sort-content",class:t.editable?"canMove":"",attrs:{group:{name:"wrap",pull:!1}},on:{end:t.onWrapMovEnd},model:{value:t.dataList,callback:function(e){t.dataList=e},expression:"dataList"}},"draggable",t.dragOptions,!1),t._l(t.dataList,(function(e,i){return n("div",{key:e.ID,staticClass:"sort-item",class:t.openList[i]?"show":"hidden"},[n("div",{staticClass:"item-title",class:t.activeItemID===e.ID?"active":"",on:{click:function(n){return n.target!==n.currentTarget?null:t.onActiveItemClick(e.ID)}}},[n("span",[t._v(t._s(e.ClassName))]),t._v(" "),n("div",[n("span",{attrs:{title:e.ClassName},on:{click:function(e){return t.onItemClassifyManageClick(i)}}},[n("i",{staticClass:"el-icon-s-tools"}),t._v("管理子类")]),n("div",{on:{click:function(n){return t.onArrowClick(i,e.children.length>0)}}},[e.children.length>0?n("i",{staticClass:"el-icon-arrow-right"}):t._e()])])]),n("draggable",t._b({staticClass:"item-content",class:t.editable?"canMove":"",attrs:{group:{name:"menu",put:!0}},model:{value:e.children,callback:function(n){t.$set(e,"children",n)},expression:"item.children"}},"draggable",t.dragOptions,!1),t._l(e.children,(function(e){return n("span",{key:e.ID,class:t.activeItemID===e.ID?"active":"",on:{click:function(n){return t.onActiveItemClick(e.ID)}}},[t._v(" "+t._s(e.ClassName)+" ")])})),0)],1)})),0):t._e(),0===t.classifyData.length?n("div",{staticClass:"non-data"},[t._v("暂无分类数据，快去添加吧")]):t._e()],1)]),n("footer",[t.editable?[n("el-button",{attrs:{type:"primary"},on:{click:t.onSubmitClick}},[t._v("保存")]),n("el-button",{staticClass:"cancel-blue-btn",on:{click:t.onCancelClick}},[t._v("取消")])]:[n("el-button",{attrs:{type:"primary",disabled:0===t.classifyData.length},on:{click:t.onSortClick}},[t._v("排序")])]],2)])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"sort-title"},[n("span",[t._v("分类名称")]),n("span",[t._v("管理")])])}],!1,null,null,null).exports,p=(n("4de4"),n("247a")),h={props:{dataList:{type:Array,default:function(){return[]}},ParentID:{required:!0},classifyName:{required:!0}},data:function(){return{list:[]}},methods:{onGoBackClick:function(){this.$emit("goback")},onItemAddClick:function(){var t={ClassName:"",key:Object(p.f)(10),ParentID:this.ParentID};-1===this.ParentID&&(t.children=[]),this.list.push(t),this.$nextTick((function(){var t=document.querySelector(".mp-erp-product-classify-manage-page-right-content-wrap > main");Object(p.a)(t.scrollTop,t.scrollHeight,(function(e){t.scrollTop=e}))}))},onItemDelClick:function(t,e){var n=this;t.ID?this.messageBox.warnCancelBox("确定删除分类吗 ?","分类名称：[ ".concat(t.ClassName," ]"),(function(){return n.handleItemDel(e)}),null):this.handleItemDel(e)},handleItemDel:function(t){this.list.splice(t,1)},onSubmitClick:function(){var t=this.list.filter((function(t){return t.ClassName}));this.$emit("submit",t)}},watch:{dataList:{handler:function(t){t&&t.length>0&&(this.list=t)},immediate:!0}}},m=(n("e206"),Object(f.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"mp-erp-product-classify-manage-page-right-content-wrap"},[n("header",[n("p",{staticClass:"mp-common-title-wrap"},[t._v(t._s(t.classifyName))])]),n("main",[n("ul",t._l(t.list,(function(e,i){return n("li",{key:e.key},[n("el-input",{attrs:{placeholder:"在此输入分类名称",maxlength:"20","show-word-limit":""},model:{value:e.ClassName,callback:function(n){t.$set(e,"ClassName","string"==typeof n?n.trim():n)},expression:"it.ClassName"}}),n("div",{staticClass:"menu-box"},[n("span",{on:{click:t.onItemAddClick}},[n("i"),t._v("添加 ")]),e.children&&e.children.length>0?n("span",{staticClass:"gray-item is-disabled"},[n("i"),t._v("删除 ")]):n("span",{on:{click:function(n){return t.onItemDelClick(e,i)}}},[n("i"),t._v("删除 ")])])],1)})),0)]),n("footer",[n("el-button",{attrs:{type:"primary"},on:{click:t.onSubmitClick}},[t._v("保存")]),n("el-button",{staticClass:"cancel-blue-btn",on:{click:t.onGoBackClick}},[t._v("＜＜ 返回")])],1)])}),[],!1,null,null,null)).exports,g={props:{classifyData:{type:Array,default:function(){return[]}},type:{type:Number,default:null},fetchData:{type:Function,default:function(){}},title:{type:String,default:"产品"}},components:{LRWidthDragAutoChangeComp:o.a,ContentLeft:d,ContentRight:m},data:function(){return{curEditClassify:[],ParentID:-1,curClassify:"根分类"}},methods:{setCurEditClassifyData:function(t){var e=this,n=Object(c.a)(t,3),i=n[0],o=n[1],r=n[2],l={ClassName:"",ParentID:o,ID:""};-1===o&&(l.children=[]),this.curEditClassify=[].concat(Object(s.a)(i),[l]).map((function(t){return Object(a.a)({},t,{key:e.$utils.getRandomRangeId(10)})})),this.ParentID=o,this.curClassify=r},onGobackClick:function(){this.$emit("goback")},onLeftSubmit:function(t){this.$emit("sort",t)},onRightSubmit:function(t){var e=this;return Object(i.a)(regeneratorRuntime.mark((function n(){var i,a,s,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.map((function(t){return{Name:t.ClassName,ID:t.ID}})),a={Type:e.type,ParentID:e.ParentID,List:i},n.next=4,e.api.getClassSave(a).catch((function(){}));case 4:(s=n.sent)&&200===s.status&&1e3===s.data.Status&&(c=function(){e.fetchData(!0)},e.messageBox.successSingle("保存成功",c,c));case 6:case"end":return n.stop()}}),n)})))()}},watch:{classifyData:function(){this.setCurEditClassifyData([this.classifyData,-1,"根分类"])}},mounted:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchData();case 2:e.sent&&t.$nextTick((function(){t.setCurEditClassifyData([t.classifyData,-1,"根分类"])}));case 4:case"end":return e.stop()}}),e)})))()}},C=(n("4d642"),Object(f.a)(g,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"mp-erp-common-classify-manage-comp-wrap"},[n("LRWidthDragAutoChangeComp",{attrs:{leftWidth:"45%"},scopedSlots:t._u([{key:"left",fn:function(){return[n("ContentLeft",{attrs:{classifyData:t.classifyData,title:t.title},on:{setCurEditClassifyData:t.setCurEditClassifyData,submit:t.onLeftSubmit}})]},proxy:!0},{key:"right",fn:function(){return[n("ContentRight",{attrs:{dataList:t.curEditClassify,ParentID:t.ParentID,classifyName:t.curClassify},on:{goback:t.onGobackClick,submit:t.onRightSubmit}})]},proxy:!0}])})],1)}),[],!1,null,null,null));e.a=C.exports},"921c":function(t,e,n){},db06:function(t,e,n){"use strict";var i=n("f217");n.n(i).a},dbc0:function(t,e,n){},e206:function(t,e,n){"use strict";var i=n("dbc0");n.n(i).a},e5ca:function(t,e,n){},f217:function(t,e,n){}}]);