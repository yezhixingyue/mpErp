(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-09943c66"],{"0571":function(t,e,a){},3e3:function(t,e,a){"use strict";a.r(e);var i=(a("7db0"),a("4160"),a("b0c0"),a("159b"),a("96cf"),a("1da1")),r=a("5530"),o=a("2f62"),n=a("dbbc"),s=a("2909"),u=a("ad32"),c={props:{visible:{type:Boolean,default:!1},saveData:{type:Object,default:null},rangeList:{type:Array,default:function(){return[]}},showGroup:{type:Boolean,default:!1}},components:{CommonDialogComp:u.a},computed:{GroupList:function(){var t=this;if(!this.showGroup)return[];var e=this.rangeList.find((function(e){return e.PartID===t.ruleForm.PartID}));return e?Object(s.a)(e.CraftGroupList):[]},curPartID:function(){return this.ruleForm.PartID}},data:function(){return{title:"添加费用",ruleForm:{ID:"",Name:"",PartID:"",GroupID:"",CraftPriceID:"",PriceID:"",CraftID:""},selectedGroupIDObj:{}}},methods:{onSubmit:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.ruleForm.validate().catch((function(){}));case 2:e.sent&&t.$emit("submit",t.ruleForm);case 4:case"end":return e.stop()}}),e)})))()},onCancle:function(){this.$emit("update:visible",!1)},onOpen:function(){this.$nextTick(this.initEditData)},onClosed:function(){this.$refs.ruleForm.resetFields()},initEditData:function(){this.title=this.saveData.ID?"编辑费用":"添加费用",this.selectedGroupIDObj={},this.saveData&&this.saveData.GroupID&&(this.selectedGroupIDObj[this.saveData.PartID||"product"]=this.saveData.GroupID),this.ruleForm=Object(r.a)({},this.saveData)}},watch:{curPartID:function(t,e){var a=t||"product",i=e||"product";this.ruleForm.GroupID&&(this.selectedGroupIDObj[i]=this.ruleForm.GroupID),this.ruleForm.GroupID=this.selectedGroupIDObj[a]||""}}},l=(a("4b08"),a("2877")),p=Object(l.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CommonDialogComp",{staticClass:"mp-erp-comps-price-module-price-solution-item-save-dialog-comp-wrap",class:t.showGroup?"show-group":"",attrs:{width:"700px",top:"15vh",title:t.title,visible:t.visible},on:{"update:visible":function(e){t.visible=e},submit:t.onSubmit,cancle:t.onCancle,open:t.onOpen,closed:t.onClosed},scopedSlots:t._u([{key:"foot-tip",fn:function(){return[a("p",{staticClass:"tips-box is-pink"},[a("i",{staticClass:"el-icon-warning"}),a("span",[t._v("注：应用范围只能在添加时设定，")]),a("span",{staticClass:"is-bold"},[t._v("后期不能更改 ！")])])]},proxy:!0}])},[a("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,"label-width":"100px","hide-required-asterisk":""}},[a("el-form-item",{attrs:{label:"费用名称：",prop:"Name",rules:[{required:!0,message:"费用名称不能为空"}]}},[a("el-input",{attrs:{"show-word-limit":"",maxlength:"8",size:"small"},model:{value:t.ruleForm.Name,callback:function(e){t.$set(t.ruleForm,"Name","string"==typeof e?e.trim():e)},expression:"ruleForm.Name"}})],1),a("el-form-item",{attrs:{label:"应用范围："}},[a("el-radio-group",{model:{value:t.ruleForm.PartID,callback:function(e){t.$set(t.ruleForm,"PartID",e)},expression:"ruleForm.PartID"}},t._l(t.rangeList,(function(e){return a("el-radio",{key:e.PartID||e.Name,attrs:{title:e.Name,label:e.PartID}},[t._v(t._s(e.Name))])})),1),a("p",{directives:[{name:"show",rawName:"v-show",value:t.GroupList.length>0,expression:"GroupList.length > 0"}]}),a("el-radio-group",{directives:[{name:"show",rawName:"v-show",value:t.GroupList.length>0,expression:"GroupList.length > 0"}],model:{value:t.ruleForm.GroupID,callback:function(e){t.$set(t.ruleForm,"GroupID",e)},expression:"ruleForm.GroupID"}},t._l(t.GroupList,(function(e){return a("el-radio",{key:e.ID,attrs:{title:e.Name,label:e.ID}},[t._v(t._s(e.Name))])})),1)],1)],1)],1)}),[],!1,null,null,null).exports,m={name:"CompositionCostOfCraft",components:{TopRadioButtonComp:n.a,CraftPriceTitleItemSaveDialog:p},computed:Object(r.a)({},Object(o.e)("priceManage",["curCraftPriceItemData","curPriceItem","PriceManageList"]),{curProduct:function(){var t=this;return this.PriceManageList.find((function(e){return e.ID===t.ProductID}))},curCraft:function(){return this.curCraftPriceItemData&&this.curCraftPriceItemData.Craft||{}},rangeList:function(){var t=this;if(!this.ProductData)return[];var e=[],a={PartID:"",Name:"产品",CraftGroupList:this.getCraftGroupList(this.ProductData.CraftList)};return e.push(a),Array.isArray(this.ProductData.PartList)&&this.ProductData.PartList.forEach((function(a){var i=a.ID,r=a.Name,o=a.CraftList,n={PartID:i,Name:r,CraftGroupList:t.getCraftGroupList(o)};e.push(n)})),e}}),data:function(){return{PriceID:"",PriceName:"",ProductID:"",ProductName:"",curCraftPriceID:"",visible:!1,saveData:null,ProductData:null,isQuotationPage:!1,isSolutionLoading:!0,SolutionList:[]}},methods:{onGoBackClick:function(){this.$goback()},onRemoveClick:function(){this.messageBox.warnCancelBox("确定要删除当前方案吗","方案名称：[ ".concat(this.curSolutionItem?this.curSolutionItem.Name:"未知方案名称"," ]"),(function(){}))},onItemSaveClick:function(t){var e={CraftPriceID:this.isQuotationPage?"":this.curCraftPriceID,PriceID:this.PriceID,CraftID:this.isQuotationPage?"":this.curCraft.ID,ID:"",Name:"",GroupID:(this.isQuotationPage,""),PartID:""};this.saveData=e,this.visible=!0},handleDialogSubmit:function(t){var e=this;return Object(i.a)(regeneratorRuntime.mark((function a(){var i,r;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.api.getPriceSolutionSave(t).catch((function(){}));case 2:(i=a.sent)&&1e3===i.data.Status&&(r=function(){e.visible=!1},e.messageBox.successSingle("保存成功",r,r));case 5:case"end":return a.stop()}}),a)})))()},getProductData:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("priceManage/getProductCraftData",t.ProductID);case 2:a=e.sent,t.ProductData=a;case 4:case"end":return e.stop()}}),e)})))()},getCraftGroupList:function(t){if(!Array.isArray(t))return[];var e=[];return t.forEach((function(t){Array.isArray(t.GroupList)&&t.GroupList.forEach((function(t){var a=t.UseTimes;a&&a.MaxValue>1&&e.push(t)}))})),e},getPriceResultList:function(){var t=this;return Object(i.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.getPriceResultList(t.PriceID).catch((function(){}));case 2:a=e.sent,t.isSolutionLoading=!1,a&&1e3===a.data.Status&&(t.SolutionList=a.data.Data);case 5:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this.$route.params.isQuotation;if(t||this.curPriceItem&&this.curCraftPriceItemData&&this.curCraftPriceItemData.Craft){var e=this.curPriceItem,a=e.ID,i=e.Name;this.PriceID=a,this.PriceName=i,this.ProductID=this.$route.params.id,this.ProductName=this.$route.params.name,t&&(this.isQuotationPage=t),this.getProductData(),this.getPriceResultList()}else this.$goback()}},d=(a("c4d7"),Object(l.a)(m,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"mp-erp-price-module-craft-price-cost-composition-set-page-wrap"},[a("header",[a("span",[t._v("当前产品：")]),a("span",[t._v(t._s(t.ProductName))]),a("span",{staticClass:"name"},[t._v("价格名称："+t._s(t.PriceName))]),t.isQuotationPage?t._e():a("span",{staticClass:"name"},[t._v("设置工艺："+t._s(t.curCraft.Name))]),a("TopRadioButtonComp",{attrs:{title:"费用",list:t.SolutionList,loading:t.isSolutionLoading},on:{remove:t.onRemoveClick,itemSave:t.onItemSaveClick},model:{value:t.curCraftPriceID,callback:function(e){t.curCraftPriceID=e},expression:"curCraftPriceID"}})],1),a("main",[a("CraftPriceTitleItemSaveDialog",{attrs:{showGroup:!t.isQuotationPage,visible:t.visible,rangeList:t.rangeList,saveData:t.saveData},on:{"update:visible":function(e){t.visible=e},submit:t.handleDialogSubmit}})],1),a("footer",[a("el-button",{on:{click:t.onGoBackClick}},[a("i",{staticClass:"el-icon-d-arrow-left"}),t._v(" 返回")])],1)])}),[],!1,null,null,null));e.default=d.exports},"468e":function(t,e,a){"use strict";var i=a("4aae");a.n(i).a},"4aae":function(t,e,a){},"4b08":function(t,e,a){"use strict";var i=a("e75c");a.n(i).a},ad32:function(t,e,a){"use strict";var i={model:{prop:"value",event:"change"},props:{visible:{type:Boolean,default:!1},title:{type:String,default:"提示"},width:{default:"30%"},top:{type:String,default:"15vh"},showSubmit:{type:Boolean,default:!0},submitText:{type:String,default:"保存"},dangerText:{type:String,default:"重新生成"},cancelText:{type:String,default:"取消"},disabled:{type:Boolean,default:!1},showDanger:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},data:function(){return{checkList:[]}},methods:{onCancleClick:function(){this.$emit("cancle")},onSubmitClick:function(t){this.dialogVisible&&("BUTTON"===t.target.nodeName?t.target.blur():"BUTTON"===t.target.parentNode.nodeName&&t.target.parentNode.blur(),this.$emit("submit"))},onDangerClick:function(){this.$emit("danger")},onOpen:function(){this.$emit("open")},onOpened:function(){this.$emit("opened")},onClose:function(){this.$emit("close")},onClosed:function(){this.$emit("closed")}}},r=(a("468e"),a("2877")),o=Object(r.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header mp-erp-common-dialog-comp-wrap",attrs:{title:t.title,visible:t.dialogVisible,"close-on-click-modal":!1,width:t.width,top:t.top,modal:!1,"before-close":t.onCancleClick},on:{"update:visible":function(e){t.dialogVisible=e},open:t.onOpen,opened:t.onOpened,close:t.onClose,closed:t.onClosed}},[t._t("default"),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.$slots["foot-tip"]?a("div",[t._t("foot-tip")],2):t._e(),a("p",[t.showSubmit?a("el-button",{attrs:{type:"primary",loading:t.loading,disabled:t.disabled},on:{click:t.onSubmitClick}},[t._v(t._s(t.loading?"加载中":t.submitText))]):t._e(),t.showDanger?a("el-button",{attrs:{type:"danger"},on:{click:t.onDangerClick}},[t._v(t._s(t.dangerText))]):t._e(),a("el-button",{on:{click:t.onCancleClick}},[t._v(t._s(t.cancelText))])],1)])],2)}),[],!1,null,null,null);e.a=o.exports},b355:function(t,e,a){},c4d7:function(t,e,a){"use strict";var i=a("0571");a.n(i).a},dbbc:function(t,e,a){"use strict";var i={model:{prop:"value",event:"change"},props:{title:{type:String,default:"方案"},list:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},value:{}},computed:{radio:{get:function(){return this.value},set:function(t){this.$emit("change",t)}}},methods:{onRemoveClick:function(){this.$emit("remove")},onItemSaveClick:function(t){this.$emit("itemSave",t)}}},r=(a("e04b"),a("2877")),o=Object(r.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mp-erp-common-comps-top-radio-button-comp-wrap"},[t.loading?a("span",{staticClass:"is-font-size-12 is-gray"},[t._v(" "+t._s(t.title)+"加载中...")]):a("el-scrollbar",{attrs:{"wrap-class":"scrollbar-wrapper"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},t._l(t.list,(function(e){return a("el-radio-button",{key:e.ID,attrs:{label:e.ID}},[t._v(t._s(e.Name))])})),1)],1),t.loading||0!==t.list.length?t._e():a("span",{staticClass:"is-font-size-12 is-gray"},[t._v("该分类尚无"+t._s(t.title)+"，请添加")]),a("span",{staticClass:"blue-span",on:{click:function(e){return t.onItemSaveClick(null)}}},[t._v("+添加"+t._s(t.title))]),t.radio?a("div",{staticClass:"menus"},[a("span",{staticClass:"blue-span",on:{click:function(e){return t.onItemSaveClick(t.radio)}}},[t._v("编辑当前"+t._s(t.title)+"名称")]),a("span",{staticClass:"red-span",on:{click:t.onRemoveClick}},[t._v("删除当前"+t._s(t.title))])]):t._e()],1)}),[],!1,null,null,null);e.a=o.exports},e04b:function(t,e,a){"use strict";var i=a("b355");a.n(i).a},e75c:function(t,e,a){}}]);