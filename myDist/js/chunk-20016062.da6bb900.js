(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-20016062"],{"0970":function(t,e,a){},"11b2":function(t,e,a){"use strict";var n=a("c73b");a.n(n).a},"125c":function(t,e,a){"use strict";a.r(e);var n=(a("99af"),a("4de4"),a("96cf"),a("1da1")),i=a("2909"),r=a("5530"),l=(a("7db0"),a("ad32")),s=a("c209"),o={props:{visible:{type:Boolean,default:!1},curData:{type:Object,default:null},classifyData:{type:Array,default:null}},components:{CommonDialogComp:l.a,TwoLevelSelectComp:s.a},computed:{level1Options:function(){return this.classifyData&&Array.isArray(this.classifyData)&&0!==this.classifyData.length?this.classifyData:[]},level2Options:function(){var t=this;if(!this.ClassifyComputed.level1Val&&0!==this.ClassifyComputed.level1Val||0===this.level1Options.length)return[];var e=this.level1Options.find((function(e){return e.ID===t.ClassifyComputed.level1Val}));return e?e.children:[]},ClassifyComputed:{get:function(){return{level1Val:this.ruleForm.Classify.FirstLevel.ID,level2Val:this.ruleForm.Classify.SecondLevel.ID}},set:function(t){var e=t.level1Val,a=t.level2Val;this.ruleForm.Classify.FirstLevel.ID=e,this.ruleForm.Classify.SecondLevel.ID=a}}},data:function(){return{title:"添加工艺",ruleForm:null,rules:{Name:[{required:!0,message:"请输入内部名称",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],ShowName:[{required:!0,message:"请输入显示名称",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],Classify:[{validator:this.classifyValidator,trigger:"change"}]}}},methods:{onSubmit:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var a,n,i,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.ruleForm.validate().catch((function(){}));case 2:if(!e.sent){e.next=11;break}return a=!!t.curData,t.ruleForm.Classify.FirstLevel.Name=t.getLevelName(t.ruleForm.Classify.FirstLevel.ID,t.level1Options),t.ruleForm.Classify.SecondLevel.Name=t.getLevelName(t.ruleForm.Classify.SecondLevel.ID,t.level2Options),e.next=9,t.api.getCraftSave(t.ruleForm).catch((function(){}));case 9:(n=e.sent)&&200===n.status&&1e3===n.data.Status&&(i=a?"编辑工艺成功":"添加工艺成功",l=function(){t.handleSaveSuccess(a,Object(r.a)({},t.ruleForm,{ID:n.data.Data}))},t.messageBox.successSingle(i,l,l));case 11:case"end":return e.stop()}}),e)})))()},getLevelName:function(t,e){var a=e.find((function(e){return e.ID===t}));return a?a.ClassName:""},handleSaveSuccess:function(t,e){this.$emit("submitSuccess",t,e),this.onCancle()},classifyValidator:function(t,e,a){var n=e.FirstLevel,i=e.SecondLevel,r=n.ID||0===n.ID,l=i.ID||0===i.ID;r?l?a():a(new Error("请选择二级工艺分类")):a(new Error("请选择工艺分类"))},onCancle:function(){this.$emit("update:visible",!1)},onOpen:function(){this.$nextTick(this.initEditData)},onClosed:function(){this.ruleForm=null,this.$emit("close")},initEditData:function(){this.curData?this.ruleForm=JSON.parse(JSON.stringify(this.curData)):this.ruleForm={ID:"",Name:"",ShowName:"",Classify:{Type:0,FirstLevel:{ID:"",Name:""},SecondLevel:{ID:"",Name:""}},ElementList:[],GroupList:[]},this.title=this.curData?"编辑工艺":"添加工艺"}}},c=(a("8449"),a("2877")),u=Object(c.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CommonDialogComp",{staticClass:"mp-erp-comps-craft-manage-save-dialog-comp-wrap",attrs:{width:"800px",top:"15vh",title:t.title,visible:t.visible},on:{"update:visible":function(e){t.visible=e},submit:t.onSubmit,cancle:t.onCancle,open:t.onOpen,closed:t.onClosed}},[t.ruleForm?a("el-form",{ref:"ruleForm",staticClass:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"168px",size:"small"}},[a("el-form-item",{attrs:{label:"内部名称：",prop:"Name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{maxlength:"10","show-word-limit":""},model:{value:t.ruleForm.Name,callback:function(e){t.$set(t.ruleForm,"Name","string"==typeof e?e.trim():e)},expression:"ruleForm.Name"}})],1),a("el-form-item",{attrs:{label:"显示名称：",prop:"ShowName"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{maxlength:"10","show-word-limit":""},model:{value:t.ruleForm.ShowName,callback:function(e){t.$set(t.ruleForm,"ShowName","string"==typeof e?e.trim():e)},expression:"ruleForm.ShowName"}})],1),a("el-form-item",{attrs:{label:"工艺分类：",prop:"Classify"}},[a("TwoLevelSelectComp",{attrs:{level1Options:t.level1Options,level2Options:t.level2Options,defaultProps:{label:"ClassName",value:"ID"}},model:{value:t.ClassifyComputed,callback:function(e){t.ClassifyComputed=e},expression:"ClassifyComputed"}})],1)],1):t._e()],1)}),[],!1,null,null,null).exports,f=(a("a15b"),a("d81d"),a("2af0")),m={props:{dataList:{default:function(){return[]},type:Array},loading:{type:Boolean,default:!1}},computed:{localTableData:function(){var t=this;return this.dataList&&Array.isArray(this.dataList)&&0!==this.dataList.length?this.dataList.map((function(e){return Object(r.a)({},e,{ClassiftText:t.getClassiftText(e),ElementText:t.getElementText(e.ElementList)})})):[]}},mixins:[f.a],methods:{setHeight:function(){var t=this.getHeight(".mp-erp-craft-manage-craft-list-page-wrap > header",53);this.h=t},onEditClick:function(t){this.$emit("edit",t)},onRemoveClick:function(t){this.$emit("remove",t)},onElementClick:function(t){this.$emit("setElement",t)},getClassiftText:function(t){if(!t)return"";var e=t.Classify;if(e){var a=e.FirstLevel,n=e.SecondLevel;return"".concat(a.Name," ").concat(n.Name)}return""},getElementText:function(t){return t&&Array.isArray(t)&&0!==t.length?t.map((function(t){return t.Name})).join("、"):""},getTips:function(t){return t&&0!==t.length?t.map((function(t){return t.Name})).join("、"):""}}},p=(a("6143"),Object(c.a)(m,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{key:"mp-erp-craft-list-page-craft-table-comp-wrap",staticClass:"mp-erp-craft-list-page-craft-table-comp-wrap",staticStyle:{width:"100%"},attrs:{"max-height":t.h,height:t.h,stripe:"",border:"",data:t.localTableData,fit:""}},[a("el-table-column",{attrs:{prop:"Name",label:"内部名称",width:"260"}}),a("el-table-column",{attrs:{prop:"ShowName",label:"显示名称","min-width":"240","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"ClassiftText",label:"所属分类","min-width":"240","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"ElementText",label:"元素","min-width":"240","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"GroupText",label:"元素组","min-width":"240","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.GroupList,(function(e){return a("span",{key:e.ID,attrs:{title:t.getTips(e.ElementList)}},[t._v(" "+t._s(e.Name)+"（"+t._s(e.UseTimes.MinValue)+"-"+t._s(e.UseTimes.MaxValue)+"次）")])}))}}])}),a("el-table-column",{attrs:{label:"操作","min-width":"380"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{staticClass:"menu-list"},[a("span",{on:{click:function(a){return t.onElementClick(e.row)}}},[a("i"),t._v("界面元素")]),a("span",{on:{click:function(a){return t.onEditClick(e.row)}}},[a("i"),t._v("编辑")]),a("span",{on:{click:function(a){return t.onRemoveClick(e.row,e.$index)}}},[a("i"),t._v("删除")])])}}])}),a("div",{attrs:{slot:"empty"},slot:"empty"},[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}]},[t._v("暂无数据")])])],1)}),[],!1,null,null,null)).exports,d=a("8aa1"),h=a("daf5"),v=a("6538"),C=a("2f62"),g={name:"CraftManageList",mixins:[Object(h.a)(".mp-erp-craft-list-page-craft-table-comp-wrap .el-table__body-wrapper")],components:{CraftSaveDialog:u,CraftListTableComp:p,CountComp:d.a,OrderChannelSelector:v.a},data:function(){return{visible:!1,curData:null,loading:!1}},computed:Object(r.a)({},Object(C.e)("basicSet",["CraftDataList","CraftDataNumber","Condition4CraftList","craftFetchData"]),{},Object(C.e)("common",["CraftClassifyData"]),{},Object(C.c)("common",["twoLevelsCraftClassify"]),{level1OptionList:function(){var t,e=[];return(null===(t=this.CraftClassifyData)||void 0===t?void 0:t.length)>0&&(e=this.CraftClassifyData.filter((function(t){return-1===t.ParentID}))),[{ClassName:"不限",ID:""}].concat(Object(i.a)(e))},level2OptionList:function(){var t,e,a,n,r,l=this,s=[];return(null===(t=this.CraftClassifyData)||void 0===t?void 0:t.length)>0&&((null===(e=this.Condition4CraftList)||void 0===e||null===(a=e.Category)||void 0===a?void 0:a.First)||0===(null===(n=this.Condition4CraftList)||void 0===n||null===(r=n.Category)||void 0===r?void 0:r.First))&&(s=this.CraftClassifyData.filter((function(t){return t.ParentID===l.Condition4CraftList.Category.First}))),[{ClassName:"不限",ID:""}].concat(Object(i.a)(s))}}),methods:Object(r.a)({},Object(C.d)("basicSet",["setCondition4CraftList"]),{onCraftItemSave:function(t){this.curData=t,this.visible=!0},jumpToClassifyPageClick:function(){this.$router.push("/CraftClassifyManage")},onCraftSaveSuccess:function(t,e){this.$store.commit("basicSet/setCraftDataListItemSave",[t,e])},getCraftListData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Object(n.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t.loading=!0,a.next=3,t.$store.dispatch("basicSet/getCraftDataList",e);case 3:t.loading=!1;case 4:case"end":return a.stop()}}),a)})))()},onRemoveClick:function(t){var e=this,a=t.Name,n=t.ID;this.messageBox.warnCancelBox("确实删除该工艺吗","工艺名称：[ ".concat(a," ]"),(function(){e.$store.dispatch("basicSet/getCraftRemove",n)}))},onSetElementClick:function(t){if(t){var e=t.Name,a=t.ID;this.$router.push("CraftElementSet/".concat(a,"/").concat(e))}}}),mounted:function(){this.$store.commit("basicSet/clearCondition4CraftList"),this.$store.dispatch("common/getCraftClassifyData"),this.getCraftListData()},activated:function(){this.craftFetchData&&(this.getCraftListData(),this.$store.commit("basicSet/setCraftFetchData",!1))}},b=(a("6d48"),Object(c.a)(g,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"mp-erp-craft-manage-craft-list-page-wrap"},[a("header",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onCraftItemSave(null)}}},[t._v("添加工艺")]),a("span",{staticClass:"blue-span",on:{click:t.jumpToClassifyPageClick}},[t._v("管理工艺分类")]),a("order-channel-selector",{key:"order-OrderType",attrs:{options:t.level1OptionList,requestFunc:t.getCraftListData,changePropsFunc:t.setCondition4CraftList,typeList:[["Category","First"]],value:t.Condition4CraftList.Category.First,label:"工艺分类筛选",defaultProps:{label:"ClassName",value:"ID"}}}),a("order-channel-selector",{key:"order-Terminal",staticClass:"terminal-select",attrs:{options:t.level2OptionList,requestFunc:t.getCraftListData,changePropsFunc:t.setCondition4CraftList,typeList:[["Category","Second"]],value:t.Condition4CraftList.Category.Second,defaultProps:{label:"ClassName",value:"ID"},label:""}})],1),a("main",[a("CraftSaveDialog",{attrs:{curData:t.curData,visible:t.visible,classifyData:t.twoLevelsCraftClassify},on:{"update:visible":function(e){t.visible=e},submitSuccess:t.onCraftSaveSuccess}}),a("CraftListTableComp",{attrs:{loading:t.loading,dataList:t.CraftDataList},on:{edit:t.onCraftItemSave,remove:t.onRemoveClick,setElement:t.onSetElementClick}})],1),a("footer",[a("CountComp",{attrs:{count:t.CraftDataNumber,watchPage:t.Condition4CraftList.Page,handlePageChange:t.getCraftListData,center:""}})],1)])}),[],!1,null,null,null));e.default=b.exports},4439:function(t,e,a){},6143:function(t,e,a){"use strict";var n=a("b61a");a.n(n).a},6538:function(t,e,a){"use strict";var n={components:{SelectComp:a("e5bf").a},props:{options:{type:Array,default:function(){return[]}},label:{type:String,default:"下单渠道"},defaultProps:{type:Object,default:function(){return{label:"name",value:"ID"}}},value:{default:"",required:!0},typeList:{type:Array,required:!0},changePropsFunc:{type:Function,default:function(){}},requestFunc:{type:Function,default:function(){}},showLabel:{type:Boolean,default:!0}},computed:{title:function(){return this.value}},methods:{handleChange:function(t){this.changePropsFunc([this.typeList[0],t]),this.requestFunc()}}},i=(a("11b2"),a("2877")),r=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"mp-common-comps-order-channel-selector-wrap",class:t.showLabel?"":"ml-15"},[t.showLabel?a("header",[t._v(t._s(t.label)+"：")]):t._e(),a("main",[a("select-comp",{attrs:{options:t.options,defaultProps:t.defaultProps,title:t.title},on:{handleChange:t.handleChange}})],1)])}),[],!1,null,null,null);e.a=r.exports},"6a15":function(t,e,a){},"6b3f":function(t,e,a){"use strict";var n=a("862d");a.n(n).a},"6d48":function(t,e,a){"use strict";var n=a("0970");a.n(n).a},8449:function(t,e,a){"use strict";var n=a("4439");a.n(n).a},"862d":function(t,e,a){},"8aa1":function(t,e,a){"use strict";var n=(a("a9e3"),{components:{},props:{showLoading:{type:Boolean,default:!1},pageSize:{type:Number,default:30},count:{type:Number,default:0},handlePageChange:{type:Function,default:function(){}},watchPage:{},center:{type:Boolean,default:!1}},watch:{watchPage:{handler:function(t){var e=this;this.$nextTick((function(){e.currentPage!==t&&(e.currentPage=t)}))},immediate:!0}},methods:{handleCurrentChange:function(t){this.handlePageChange(t)}},data:function(){return{currentPage:1}}}),i=(a("b91d"),a("2877")),r=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"count-wrap",class:t.center?"is-center":""},[a("div",{staticClass:"mp-pagination-wrap"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"hide-on-single-page":"","page-size":t.pageSize,"pager-count":5,layout:"prev, pager, next, jumper",total:t.count},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),t._t("default"),a("span",{staticClass:"count"},[t._v("共检索出"),a("i",[t._v(t._s(t.count))]),t._v("条记录")])],2)}),[],!1,null,null,null);e.a=r.exports},b61a:function(t,e,a){},b91d:function(t,e,a){"use strict";var n=a("6a15");a.n(n).a},c73b:function(t,e,a){},e5bf:function(t,e,a){"use strict";var n={props:{title:{default:"不限"},options:{type:Array,default:function(){return[{value:"",label:"不限"}]}},defaultProps:{type:Object,default:function(){return{label:"label",value:"value"}}},mini:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1}},computed:{value:{get:function(){return this.title},set:function(t){t!==this.title&&this.$emit("handleChange",t)}}}},i=(a("6b3f"),a("2877")),r=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-select",{staticClass:"mp-common-select-comp-wrap",class:t.mini?"font-12":"",attrs:{filterable:t.filterable},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e[t.defaultProps.label],value:e[t.defaultProps.value]}})})),1)}),[],!1,null,null,null);e.a=r.exports}}]);