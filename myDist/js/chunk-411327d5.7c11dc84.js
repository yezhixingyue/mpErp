(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-411327d5"],{1798:function(t,e,a){"use strict";var n=a("9a6f");a.n(n).a},"1d08":function(t,e,a){"use strict";var n=a("56c7");a.n(n).a},3340:function(t,e,a){},"4f0c":function(t,e,a){"use strict";var n=a("50e4");a.n(n).a},"50e4":function(t,e,a){},"56c7":function(t,e,a){},"5ea6":function(t,e,a){},"6e30":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkY3NDlERTgxNzdEMTExRUFCREM5RjNGQzRGRkFBQ0U4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkY3NDlERTgyNzdEMTExRUFCREM5RjNGQzRGRkFBQ0U4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Rjc0OURFN0Y3N0QxMTFFQUJEQzlGM0ZDNEZGQUFDRTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6Rjc0OURFODA3N0QxMTFFQUJEQzlGM0ZDNEZGQUFDRTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7W2NX3AAACRUlEQVR42mxSS2tTQRQ+Z2buKze1MSWpfWB9IAUFFy5EEAT3/gH/gktBxYVb/4GK2I0WYkFw7cqtuOrChRJqMJioTXLbYtPcx9yZ45kkS4cL98zcb873OBdvdtpwCFW4FnyFTrF+65veeBBjXicASq2fXfR/Pr8afHn/Kb0BDTkCVcEU+qYBu+kmjClqMa6tSX4EtxA2e+VyK7NBeGwX4ILXBVWSXDuy8aMRLVZCzNc8sB8s4MChPTRhTkHQLs/uKLIHKfkvcbk9tiMbYygIiHUg0rQ1M/GDMGMiyKyAupwA1tr53SVx3GUmOUP9b/FNRJuRfwpv/9iNvutzTyTYCn+w3NMyQsyR05q7CA0qX5HJMzU0jYd9U3vsoUPRVAx7gJLfvtuzHE0CSr4Vol5VEwr7Vb5fw5P7LLaXgr8VYf6U0+smdvGFD+W9WGTqtz39piDVER6YgeEOVZy0YszecT05I5JXV4K9HZY4ZtDbCItt506BORA+FkMnRGJ5XaEG1ioR6DyfKUNSucROKLjsMAKpJwSYERfAGTcNuxCcrfNgXY2z0AzIBuKUYSD4cMgJQUZRoyRvPgeYA3l4bN8H3XRMHEoiAiyOXPwKymaEmcvFKjQTPi95QwJdsrDgMBJNolgvdzE8lOCSZDk+FLRvliq6kCpAjZoUjCHckFM+GKnMRm72e3+pcie1QcrywoGpff5j6pr/rbAElRY2DjnqMU/IiHX1C1bU/ms2at1suI9maulhybXUbD90ETTF4daqSOCfAAMArfYZ68CyjZgAAAAASUVORK5CYII="},"935c":function(t,e,a){"use strict";a.r(e);var n=a("3835"),i=a("5530"),o=a("8aa1"),s=a("2f62"),r=a("daf5"),l=a("09f8"),c=a("ee41"),u=a("1394"),d=a("0af5"),p=a("d962"),m=a("b1b8"),f=a("57d5"),g={components:{normalBtnFull:l.a,RadioButtonGroupComp:c.a,AreaSelector:u.a,ProductSelector:d.a,UserSelector:p.a,StaffSelector:m.a,SearchInputComp:f.a},computed:Object(i.a)({},Object(s.e)("couponStore",["condition2ListData","searchWatchKey"]),{},Object(s.e)("common",["CouponProvideStatusList","CouponUseStatusList","Permission"]),{CouponProvideStatus:{get:function(){return this.condition2ListData.ProvideStatus},set:function(t){this.setCondition2ListData([["ProvideStatus",""],t])}},CouponUseStatus:{get:function(){return this.condition2ListData.UseStatus},set:function(t){this.setCondition2ListData([["UseStatus",""],t])}}}),methods:Object(i.a)({},Object(s.d)("couponStore",["setCondition2ListData","clearCondition2ListData"]),{},Object(s.b)("couponStore",["getCouponList"]),{jump2AddPage:function(){this.$router.push({name:"couponAdd",params:{type:"add"}})}})},b=(a("e3b2"),a("2877")),h=Object(b.a)(g,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"mp-coupon-page-header-wrap"},[a("ul",[t.Permission.PermissionList.PermissionCoupon.Obj.Setup?a("li",[a("normal-btn-full",{attrs:{title:"新建优惠券"},nativeOn:{click:function(e){return t.jump2AddPage(e)}}})],1):t._e(),a("li",{staticClass:"selector-wrap-2"},[a("area-selector",{attrs:{changePropsFunc:t.setCondition2ListData,requestFunc:t.getCouponList,RegionalID:t.condition2ListData.SellArea.RegionalID,CityID:t.condition2ListData.SellArea.CityID,CountyID:t.condition2ListData.SellArea.CountyID,typeList:[["SellArea","RegionalID"],["SellArea","CityID"],["SellArea","CountyID"]]}}),a("product-selector",{attrs:{changePropsFunc:t.setCondition2ListData,requestFunc:t.getCouponList,ClassID:t.condition2ListData.Product.ClassID,TypeID:t.condition2ListData.Product.TypeID,ProductID:t.condition2ListData.Product.ProductID,typeList:[["Product","ClassID"],["Product","TypeID"],["Product","ProductID"]]}}),a("user-selector",{attrs:{changePropsFunc:t.setCondition2ListData,requestFunc:t.getCouponList,isValueEq1:"",userType:t.condition2ListData.Customer.First,userRank:t.condition2ListData.Customer.Second,typeList:[["Customer","First"],["Customer","Second"]]}})],1),a("li",[a("radio-button-group-comp",{attrs:{radioList:t.CouponProvideStatusList,requestFunc:t.getCouponList,isFull:!0,title:"发放状态"},model:{value:t.CouponProvideStatus,callback:function(e){t.CouponProvideStatus=e},expression:"CouponProvideStatus"}})],1),a("li",{staticClass:"last-row-selector-wrap"},[a("radio-button-group-comp",{attrs:{radioList:t.CouponUseStatusList,requestFunc:t.getCouponList,isFull:!0,title:"使用状态"},model:{value:t.CouponUseStatus,callback:function(e){t.CouponUseStatus=e},expression:"CouponUseStatus"}}),a("div",[a("staff-selector",{staticClass:"first-section",attrs:{needlimit:"",changePropsFunc:t.setCondition2ListData,requestFunc:t.getCouponList,typeList:[["ApplyUserID",""]],title:"申请人",value:t.condition2ListData.ApplyUserID}}),a("staff-selector",{staticClass:"second-section",attrs:{title:"操作人",needlimit:"",changePropsFunc:t.setCondition2ListData,requestFunc:t.getCouponList,typeList:[["OperateUserID",""]],value:t.condition2ListData.OperateUserID}}),a("search-input-comp",{attrs:{title:"关键词",placeholder:"请输入搜索关键词",typeList:[["KeyWords",""]],requestFunc:t.getCouponList,changePropsFunc:t.setCondition2ListData,word:t.condition2ListData.KeyWords,searchWatchKey:t.searchWatchKey},on:{reset:t.clearCondition2ListData}})],1)],1)])])}),[],!1,null,null,null).exports,v=(a("4160"),a("d81d"),a("159b"),a("96cf"),a("1da1")),C=a("2af0"),D=a("9342"),A=a("c31e"),S=a("286f"),w={mixins:[C.a],components:{TableItemShowComp:D.a},computed:Object(i.a)({},Object(s.e)("couponStore",["couponListData","tableDataLoading"]),{},Object(s.c)("common",["allProductClassify","allAreaTreeList"]),{},Object(s.e)("common",["CouponProvideStatusList","CouponUseStatusList","Permission"]),{SellAreaArrayList:function(){var t=this;if(0===this.allAreaTreeList.length)return[];var e=this.couponListData.map((function(t){return t.SellAreaArray})).map((function(e){return Object(S.a)(e,t.allAreaTreeList)}));return e&&0!==e.length?e.map((function(t){var e=[];return"全部区域"===t?["全部区域"]:(t.forEach((function(t){if(S.c.test(t.children[0]))e.push("".concat(t.ClassName,"全部区域"));else{var a="".concat(t.ClassName,"：[");t.children.forEach((function(t,e){e>0&&(a+="、"),S.c.test(t.children[0])?a+="".concat(t.ClassName,"全部区域 "):(a+="".concat(t.ClassName,": "),t.children.forEach((function(t,e){a+=0===e?"".concat(t.ClassName):"、".concat(t.ClassName)})))})),a+=" ]",e.push(a)}})),e)})):""},ProductListArray:function(){var t=this;if(0===this.allProductClassify.length)return[];var e=this.couponListData.map((function(t){return t.ProductList}));return(e=e.map((function(e){return Object(S.b)(e,t.allProductClassify)})))&&0!==e.length?e.map((function(t){var e=[];return"全部产品"===t?["全部产品"]:(t.forEach((function(t){if(S.c.test(t.children[0]))e.push("".concat(t.ClassName,"全部产品"));else{var a="".concat(t.ClassName,"：[");t.children.forEach((function(t,e){e>0&&(a+="、"),S.c.test(t.children[0])?a+="全部".concat(t.ClassName,"产品 "):(a+="".concat(t.ClassName,": "),t.children.forEach((function(t,e){a+=0===e?"".concat(t.ClassName):"、".concat(t.ClassName)})))})),a+=" ]",e.push(a)}})),e)})):""}}),methods:Object(i.a)({},Object(s.b)("couponStore",["getCouponList"]),{setHeight:function(){var t=this.getHeight(".mp-coupon-page-header-wrap",48);this.h=t},onGenerateCoupons:function(t,e,a){var n=t;this.$emit("handleOpenDialog",[n,e,a])},handleDeleteClick:function(t,e){var a=this,n=t.CouponID;this.messageBox.warnCancelNullMsg("确定要删除该条优惠券吗?",(function(){a.$store.dispatch("couponStore/removeCoupon",[n,e])}))},handleEditClick:function(t){this.$store.commit("couponStore/backfillCondition2CouponSave",t),this.$store.commit("couponStore/setAddPageCurStaff",t.ApplyUser),this.$router.push({name:"couponAdd",params:{type:"edit"}})},handle2Detail:function(t,e){0!==t.Data.GenerateNumber?(this.$store.commit("couponStore/setCondition2CouponUseList",[["ID",""],t.CouponID]),this.$store.commit("couponStore/setInfo2CouponUseListPage",[t,e]),this.$router.push({name:"couponDetailList"})):this.messageBox.failSingle("当前优惠券尚未生成可用数量!")},getAreaContent:function(t){var e={List:t.AreaList,IsIncludeIncreased:t.IsIncludeIncreasedArea};return Object(A.e)(e,this.allAreaTreeList)}}),mounted:function(){var t=this;return Object(v.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.initLoading=!0,t.$store.commit("couponStore/clearCondition2ListData"),e.next=4,t.getCouponList();case 4:t.initLoading=!1;case 5:case"end":return e.stop()}}),e)})))()}},L=(a("a214"),Object(b.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-table",{staticClass:"mp-coupon-table-list-comp-wrap mp-common-table-styles",staticStyle:{width:"100%"},attrs:{"max-height":t.h,height:t.h,fit:"",data:t.couponListData,stripe:"",border:""}},[n("el-table-column",{attrs:{"min-width":"75px",prop:"InternalSN",label:"内部代号"}}),n("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"70px",label:"金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"is-origin is-thick-line is-font-size-14"},[t._v(t._s(e.row.Data.Amount)+"元")])]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"88px",label:"满额"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"is-font-size-14"},[t._v("满"+t._s(e.row.Data.MinPayAmount)+"元")])]}}])}),n("el-table-column",{attrs:{"min-width":"130px",label:"限产品"},scopedSlots:t._u([{key:"default",fn:function(e){return t.ProductListArray&&t.ProductListArray[e.$index]?[n("el-tooltip",{attrs:{placement:"top-start",enterable:!1}},[n("div",{attrs:{slot:"content"},slot:"content"},t._l(t.ProductListArray[e.$index],(function(e,a){return n("p",{key:e+"---"+a},[t._v(" "+t._s(e)+" ")])})),0),n("span",{staticClass:"area-span"},[t._v(t._s(t.ProductListArray[e.$index].join(" ")))])])]:void 0}}],null,!0)}),n("el-table-column",{attrs:{"min-width":"130px",label:"使用区域"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("TableItemShowComp",{attrs:{list:t.getAreaContent(e.row),effect:"dark"}})]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"78px",label:"用户类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatPromoteCustomerType")(e.row.CustomerTypeList)))]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"78px",label:"用户等级"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatPromoteCustomerGrade")(e.row.GradeList))+" ")]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":"","min-width":"85px",label:"下单渠道"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatPromoteOrderType")(e.row.OrderTypeList))+" ")]}}])}),n("el-table-column",{attrs:{"min-width":"65px","class-name":"two-layers-wrap left",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("span",{class:{"is-pink":2===e.row.ProvideStatus,"is-success":1===e.row.ProvideStatus}},[t._v(t._s(t._f("formatProvideStatus")(e.row.ProvideStatus)))]),n("span",{class:{"is-pink":2===e.row.UseStatus,"is-success":1===e.row.UseStatus}},[t._v(t._s(t._f("formatUseStatus")(e.row.UseStatus)))])])]}}])}),n("el-table-column",{attrs:{"min-width":"75px","class-name":"two-layers-wrap left",label:"生成/总数"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("span",[n("i",[t._v(t._s(e.row.Data.GenerateNumber))]),t._v("张")]),n("span",[n("i",[t._v(t._s(e.row.Data.TotalNumber))]),t._v("张")])])]}}])}),n("el-table-column",{attrs:{"min-width":"75px","class-name":"two-layers-wrap left",label:"使用/激活"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("span",[n("i",[t._v(t._s(e.row.Data.UseNumber))]),t._v("张")]),n("span",[n("i",[t._v(t._s(e.row.Data.BindNumber))]),t._v("张")])])]}}])}),n("el-table-column",{attrs:{"min-width":"140px","class-name":"two-layers-wrap",label:"发放起止时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"is-gray"},[n("span",[t._v(t._s(t._f("format2LangTypeDate")(e.row.ProvideStartTime)))]),n("span",[t._v(t._s(t._f("format2LangTypeDate")(e.row.ProvideEndTime)))])])]}}])}),n("el-table-column",{attrs:{"min-width":"140px","class-name":"two-layers-wrap",label:"有效期起止时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"is-gray"},[n("span",[t._v(t._s(t._f("format2LangTypeDate")(e.row.ValidStartTime)))]),n("span",[t._v(t._s(t._f("format2LangTypeDate")(e.row.ValidEndTime)))])])]}}])}),n("el-table-column",{attrs:{"min-width":"65px",prop:"ApplyUser.StaffName",label:"申请人"}}),n("el-table-column",{attrs:{"min-width":"65px",prop:"OperateUser.StaffName",label:"操作人"}}),n("el-table-column",{attrs:{width:"356px",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return n("ul",{staticClass:"handle-menus"},[t.Permission.PermissionList.PermissionCoupon.Obj.Generate?n("li",{staticClass:"stop-box"},[n("span",{staticClass:"is-list-btn",on:{click:function(a){return t.onGenerateCoupons(e.row,e.$index,t.ProductListArray[e.$index])}}},[n("img",{attrs:{src:a("fae7"),alt:""}}),t._v("手动生成 ")])]):t._e(),t.Permission.PermissionList.PermissionCoupon.Obj.Query?n("li",[e.row.Data.GenerateNumber>0?n("span",{staticClass:"is-list-btn",on:{click:function(a){return t.handle2Detail(e.row,t.ProductListArray[e.$index])}}},[n("img",{attrs:{src:a("f344"),alt:""}}),t._v("查看使用列表")]):n("span",{staticClass:"is-disabled"},[n("img",{attrs:{src:a("3e46"),alt:""}}),t._v("查看使用列表")])]):t._e(),t.Permission.PermissionList.PermissionCoupon.Obj.Setup?n("li",[0===e.row.ProvideStatus?n("span",{staticClass:"is-list-btn",on:{click:function(a){return t.handleEditClick(e.row)}}},[n("img",{attrs:{src:a("3a48"),alt:""}}),t._v("编辑 ")]):n("span",{staticClass:"is-disabled"},[n("img",{attrs:{src:a("42b6"),alt:""}}),t._v("编辑 ")])]):t._e(),t.Permission.PermissionList.PermissionCoupon.Obj.Setup?n("li",[0===e.row.Data.GenerateNumber?n("span",{staticClass:"is-list-btn",on:{click:function(a){return t.handleDeleteClick(e.row,e.$index)}}},[n("img",{attrs:{src:a("6e30"),alt:""}}),t._v("删除 ")]):n("span",{staticClass:"is-disabled"},[n("img",{attrs:{src:a("fa18"),alt:""}}),t._v("删除 ")])]):t._e()])}}])}),n("div",{attrs:{slot:"empty"},slot:"empty"},[n("span",{directives:[{name:"show",rawName:"v-show",value:!t.tableDataLoading,expression:"!tableDataLoading"}]},[t._v("暂无数据")]),n("span",{directives:[{name:"show",rawName:"v-show",value:t.tableDataLoading&&t.initLoading,expression:"tableDataLoading && initLoading"}],staticStyle:{"margin-top":"-80px"}},[n("i",{staticClass:"el-icon-loading",staticStyle:{"font-size":"20px",color:"#428dfa"}}),t._v(" 正在加载数据...，请稍候 ")])])],1)}),[],!1,null,null,null)).exports,I=(a("a9e3"),a("edeb")),y=a("d06f"),R={props:{data:{default:function(){return{}},type:Object},dialogProductInfo:{type:Array,default:function(){return[]}}}},N=(a("f730"),Object(b.a)(R,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"mp-coupon-generate-dialog-show-detail-comp-wrap"},[a("header",{staticClass:"is-primary"},[a("div",{staticClass:"left"},[a("span",{staticClass:"is-pink is-thick-line"},[t._v("¥"+t._s(t.data.Data.Amount)+" ")]),t._v("满 "),a("span",{staticClass:"is-pink"},[t._v(t._s(t.data.Data.MinPayAmount))]),t._v("元使用 ")]),a("div",{staticClass:"right"},[t.dialogProductInfo&&t.dialogProductInfo.length>0?a("el-tooltip",{attrs:{placement:"top",enterable:!1}},[a("div",{attrs:{slot:"content"},slot:"content"},t._l(t.dialogProductInfo,(function(e,n){return a("p",{key:e+"---"+n},[t._v(t._s(e))])})),0),a("span",{staticClass:"is-thick-line"},[t._v("限产品："+t._s(t.dialogProductInfo.join(" ")))])]):t._e()],1)]),a("div",{staticClass:"content"},[a("div",{staticClass:"left is-primary"},[a("div",[a("span",[t._v("总数量："+t._s(t.data.Data.TotalNumber)+"张")])]),a("div",[a("span",[t._v("已生成："+t._s(t.data.Data.GenerateNumber)+"张")]),a("span",[t._v("未生成："+t._s(t.data.Data.TotalNumber-t.data.Data.GenerateNumber)+"张")])])]),a("ul",{staticClass:"right is-gray"},[a("li",[a("span",[t._v("有效期开始时间："+t._s(t._f("format2MiddleLangTypeDate")(t.data.ValidStartTime)))]),a("span",[t._v("有效期结束时间："+t._s(t._f("format2MiddleLangTypeDate")(t.data.ValidEndTime)))])]),a("li",[a("span",[t._v("开始发放时间："+t._s(t._f("format2MiddleLangTypeDate")(t.data.ProvideStartTime)))]),a("span",[t._v("结束发放时间："+t._s(t._f("format2MiddleLangTypeDate")(t.data.ProvideEndTime)))])])])])])}),[],!1,null,null,null)).exports,P={props:{tableData:{type:Array,default:function(){return[]}},amount:{type:Number,default:-1},minPayAmount:{type:Number,default:-1},ValidEndTime:{type:String,default:""}},components:{normalBtnFull:l.a},methods:{handleExport2Excel:function(t,e){var a=this;t&&this.$store.dispatch("couponStore/getAccountReceivableExcel",[t,this.amount,this.minPayAmount,this.ValidEndTime,function(){a.$emit("changeGeneratedCouponList",e)}])}}},T=(a("b467"),Object(b.a)(P,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{staticClass:"mp-common-table-styles mp-coupon-generate-dialog-table-comp-wrap mp-scroll-wrap",attrs:{data:t.tableData,"max-height":"240px"}},[a("el-table-column",{attrs:{label:"生成时间",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"is-gray"},[t._v(t._s(t._f("format2MiddleLangTypeDate")(e.row.CreateTime)))])]}}])}),a("el-table-column",{attrs:{prop:"Number",label:"生成数量",width:"85"}}),a("el-table-column",{attrs:{prop:"ReceiveUser.StaffName",label:"领取人",width:"85"}}),a("el-table-column",{attrs:{prop:"OperateUser.StaffName",label:"操作人",width:"85"}}),a("el-table-column",{attrs:{label:"状态",width:"85"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.HaveExported?a("span",{staticClass:"is-success"},[t._v("已导出")]):t._e(),e.row.HaveExported?t._e():a("span",{staticClass:"is-red"},[t._v("未导出")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"208"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("normal-btn-full",{staticClass:"btn",attrs:{title:"导出"},nativeOn:{click:function(a){return t.handleExport2Excel(e.row,e.$index)}}})]}}])})],1)}),[],!1,null,null,null)).exports,G={props:{dialogVisible:{type:Boolean,default:!1},dialogData:{type:Object,default:function(){return{}}},dialogIndex:{type:Number,default:-1},dialogProductInfo:{type:Array,default:function(){return[]}}},components:{normalBtnFull:l.a,normalBtn:I.a,GenerateDiaShowDeatilComp:N,StaffSelector:m.a,SingleBottomLineInputComp:y.a,GenerateDiaTableComp:T},computed:Object(i.a)({},Object(s.e)("common",["Permission"]),{btnTitle:function(){if(!this.dialogData)return"";var t="";switch(this.dialogData.ProvideStatus){case 0:t="尚未开始发放";break;case 1:t="生成";break;case 2:t="已结束发放"}return t}}),data:function(){return{ReceiveUser:{StaffID:""},generateNum:"",generateNumRules:[{strategy:"isNotEmpty",errorMsg:"生成数量不能为空"},{strategy:"isPositiveInt",errorMsg:"生成数量必须为正整数类型"},{strategy:"Maximum:10000",errorMsg:"单次最大生成数量为10000条"}],generatedCouponList:[]}},methods:Object(i.a)({},Object(s.d)("couponStore",["changeCouponListData"]),{handleClose:function(){this.$emit("close"),this.ReceiveUser.StaffID="",this.generateNum=""},changeReceiveUser:function(t){var e=t[1];this.ReceiveUser.StaffID=e},handleGenerateClick:function(){var t=this;return Object(v.a)(regeneratorRuntime.mark((function e(){var a,n,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(a=t.dialogData.ProvideStatus)){e.next=4;break}return t.messageBox.failSingle("尚未开始发放!"),e.abrupt("return");case 4:if(2!==a){e.next=7;break}return t.messageBox.failSingle("已结束发放!"),e.abrupt("return");case 7:if(t.dialogData.Data){e.next=9;break}return e.abrupt("return");case 9:if(n=t.dialogData.Data,i=n.TotalNumber,o=n.GenerateNumber,i!==o){e.next=13;break}return t.messageBox.failSingle("当前优惠券已全部生成!"),e.abrupt("return");case 13:if(t.ReceiveUser.StaffID){e.next=16;break}return t.messageBox.failSingle("请输入领取人!"),e.abrupt("return");case 16:if(!t.check(t.generateNum,t.generateNumRules,(function(e){return t.messageBox.failSingle(e)}))){e.next=25;break}if(!(i<o+ +t.generateNum)){e.next=20;break}return t.messageBox.failSingle("超出最大可生成数量!"),e.abrupt("return");case 20:return s={CouponID:t.dialogData.CouponID,Number:t.generateNum,ReceiveUser:t.ReceiveUser},e.next=23,t.api.generateCoupons(s);case 23:1e3===e.sent.data.Status&&t.messageBox.successSingle("生成成功!",Object(v.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=+t.dialogData.Data.GenerateNumber+ +t.generateNum,t.ReceiveUser.StaffID="",t.generateNum="",e.next=5,t.getGeneratedCoupons();case 5:t.dialogIndex>=0&&t.changeCouponListData([t.dialogIndex,["Data","GenerateNumber"],a]);case 6:case"end":return e.stop()}}),e)}))));case 25:case"end":return e.stop()}}),e)})))()},getGeneratedCoupons:function(){var t=this;return Object(v.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.dialogData||!t.dialogData.CouponID){e.next=5;break}return e.next=3,t.api.getGeneratedCoupons(t.dialogData.CouponID);case 3:1e3===(a=e.sent).data.Status&&(t.generatedCouponList=a.data.Data);case 5:case"end":return e.stop()}}),e)})))()},changeGeneratedCouponList:function(t){!0!==this.generatedCouponList[t].HaveExported&&(this.generatedCouponList[t].HaveExported=!0)},handleDialogOpenEvent:function(){this.getGeneratedCoupons()}})},k=(a("1798"),Object(b.a)(G,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header mp-coupon-generate-comp-wrap",attrs:{title:"手动生成优惠券",visible:t.dialogVisible,width:"855px",top:"8vh",modal:!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e},open:t.handleDialogOpenEvent}},[a("section",{staticClass:"content-wrap"},[a("header",{staticClass:"title mp-common-title-wrap"},[t._v("基本信息")]),t.dialogData?a("div",{staticClass:"content"},[a("generate-dia-show-deatil-comp",{attrs:{data:t.dialogData,dialogProductInfo:t.dialogProductInfo}}),t._v(" "),t.Permission.PermissionList.PermissionCoupon.Obj.Generate?a("div",{staticClass:"generate-box"},[a("staff-selector",{attrs:{isLineStyle:"",title:"领取人",changePropsFunc:t.changeReceiveUser,typeList:[["ReceiveUser",""]],value:t.ReceiveUser.StaffID}}),a("div",[a("SingleBottomLineInputComp",{attrs:{title:"生成数量",remark:""},model:{value:t.generateNum,callback:function(e){t.generateNum=e},expression:"generateNum"}}),a("normal-btn-full",{attrs:{disabled:1!==t.dialogData.ProvideStatus,title:t.btnTitle},nativeOn:{click:function(e){return t.handleGenerateClick(e)}}})],1)],1):t._e(),t.dialogData?a("generate-dia-table-comp",{attrs:{tableData:t.generatedCouponList,amount:t.dialogData.Data.Amount,ValidEndTime:t.dialogData.ValidEndTime,minPayAmount:t.dialogData.Data.MinPayAmount},on:{changeGeneratedCouponList:t.changeGeneratedCouponList}}):t._e()],1):t._e()]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("normal-btn",{attrs:{title:"关闭"},nativeOn:{click:function(e){return t.handleClose()}}})],1)])}),[],!1,null,null,null)).exports,E={name:"CouponListPage",mixins:[Object(r.a)(".mp-coupon-page-wrap .el-table__body-wrapper")],components:{CouponHeader:h,CouponTableListComp:L,CountComp:o.a,Dialog2GenerateCoupons:k},computed:Object(i.a)({},Object(s.e)("couponStore",["count","condition2ListData"])),data:function(){return{dialogVisible:!1,dialogData:null,dialogIndex:-1,dialogProductInfo:[]}},methods:{handlePageChange:function(t){this.$store.dispatch("couponStore/getCouponList",t)},handleOpenDialog:function(t){var e=Object(n.a)(t,3),a=e[0],i=e[1],o=e[2];this.dialogVisible=!0,this.dialogData=a,this.dialogIndex=i,this.dialogProductInfo=o},handleDialogClose:function(){this.dialogVisible=!1}}},x=(a("4f0c"),Object(b.a)(E,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mp-coupon-page-wrap"},[a("coupon-header"),a("coupon-table-list-comp",{on:{handleOpenDialog:t.handleOpenDialog}}),a("dialog-2-generate-coupons",{attrs:{dialogVisible:t.dialogVisible,dialogData:t.dialogData,dialogIndex:t.dialogIndex,dialogProductInfo:t.dialogProductInfo},on:{close:t.handleDialogClose}}),a("footer",[a("count-comp",{attrs:{count:t.count,pageSize:t.condition2ListData.PageSize,watchPage:t.condition2ListData.Page,handlePageChange:t.handlePageChange}})],1)],1)}),[],!1,null,null,null));e.default=x.exports},"9a6f":function(t,e,a){},"9adb":function(t,e,a){},a214:function(t,e,a){"use strict";var n=a("dee0");a.n(n).a},b467:function(t,e,a){"use strict";var n=a("3340");a.n(n).a},d06f:function(t,e,a){"use strict";var n={props:{title:{type:String,default:"金额"},remark:{type:String,default:"元"},value:{},isNum:{type:Boolean,default:!1}},model:{prop:"value",event:"change"},computed:{inpVal:{get:function(){return this.value},set:function(t){var e=t;this.isNum&&(e=this.$utils.filterNumber(e)),this.$emit("change",e)}}}},i=(a("1d08"),a("2877")),o=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mp-common-comp-single-bottom-line-input-wrap"},[a("span",{staticClass:"title"},[t._v(t._s(t.title)+"：")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.inpVal,expression:"inpVal"}],attrs:{type:"text"},domProps:{value:t.inpVal},on:{input:function(e){e.target.composing||(t.inpVal=e.target.value)}}}),a("span",{staticClass:"remark is-gray"},[t._v(t._s(t.remark))])])}),[],!1,null,null,null);e.a=o.exports},daf5:function(t,e,a){"use strict";e.a=function(t){return{data:function(){return{SCROLL_Y:0,SCROLL_X:0}},deactivated:function(){var e=document.querySelector(t);e&&(this.SCROLL_Y=e.scrollTop,this.SCROLL_X=e.scrollLeft)},activated:function(){var e=this,a=document.querySelector(t);a&&(this.$nextTick((function(){a.scrollTop=e.SCROLL_Y,a.scrollLeft=e.SCROLL_X})),setTimeout((function(){a.scrollTop=e.SCROLL_Y,a.scrollLeft=e.SCROLL_X}),2))}}}},dee0:function(t,e,a){},e3b2:function(t,e,a){"use strict";var n=a("9adb");a.n(n).a},f730:function(t,e,a){"use strict";var n=a("5ea6");a.n(n).a},fa18:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkVCMDc0MzE1RTdEMTExRTg5MTgxQTEyNDZDMjU1ODVBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkVCMDc0MzE2RTdEMTExRTg5MTgxQTEyNDZDMjU1ODVBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RUIwNzQzMTNFN0QxMTFFODkxODFBMTI0NkMyNTU4NUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RUIwNzQzMTRFN0QxMTFFODkxODFBMTI0NkMyNTU4NUEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7+lHsPAAAAx0lEQVR42mJkQAK3b9/eDaRcGFDBblVVVTcYhxFJMQuQ+g7EGkD8FiosCsRXgZgTqOkvWANQ4SQgnQXEzAz4AUjDNJAGEIOJgTjwD+QMYQYSAEhDGRBXEqm+DeQURRIsUARpeAHlKAGxApQtiMZWhrKfgzS8hHJAofQRxAAG4Qc0NiwEX4E0PIdyhPA4BSb3AtkGYjS8JEsDzNPCxDrpNZQjBcT80HQlgMaWgqp5zQgVfAVNaPjAa2CIicHS0EYiIm0DiAAIMACQDTYpwNTgygAAAABJRU5ErkJggg=="},fae7:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkY1RURDRTMxQ0JFRjExRUE5NUU4RjAzMzdCMUI4NThCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkY1RURDRTMyQ0JFRjExRUE5NUU4RjAzMzdCMUI4NThCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RjVFRENFMkZDQkVGMTFFQTk1RThGMDMzN0IxQjg1OEIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RjVFRENFMzBDQkVGMTFFQTk1RThGMDMzN0IxQjg1OEIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6Wje31AAABXUlEQVR42oyTzytEURSAr+lFWQilZGFsiNiRhZ2NspUmCzWzosnCpNhoJP+ArDRSWNhYaYh6LBR/BRFWY4WFiHi+W+fpeL1fp77OvDv3fee+886ra7lxx40x29BhkuMDdmDuuXvM8xcd2IRXEXkJkj4owgFcaEkWFjCvJx2DU7eSctCl1zOSPZMufsIWHVWlk7QWI3DhJFYifTmMkdwGHq2dtAt5LbHPW4iRHME11OAdzmAAqlryDS8RghUa/ygn6CWdi+ALylpiK6xGSGoiaJS+DEnRSeTun4SLT9I9G+vJw1xfBXrQQDqGEXlLefZU9SvWsWcbzE09UBGpjWUYld9FBPvBOfGrTchonwq26pL8PSg9mEewFTZsfkzBIlRgGkois7EBbfAkk/uvugelNOPKvibZXwg7SSbl2DtRiw8wi7056ttQ0S/5LiiZAduocoqTvIH92i/14q8AAwCRHWygmAZjGgAAAABJRU5ErkJggg=="}}]);