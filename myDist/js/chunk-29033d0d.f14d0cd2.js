(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-29033d0d"],{"0970":function(e,t,a){},"0a1e":function(e,t,a){"use strict";var l=a("e57c");a.n(l).a},"125c":function(e,t,a){"use strict";a.r(t);var l=(a("99af"),a("96cf"),a("1da1")),i=a("5530"),n=(a("7db0"),a("ad32")),s=a("c209"),o={props:{visible:{type:Boolean,default:!1},curData:{type:Object,default:null},classifyData:{type:Array,default:null}},components:{CommonDialogComp:n.a,TwoLevelSelectComp:s.a},computed:{level1Options:function(){return this.classifyData&&Array.isArray(this.classifyData)&&0!==this.classifyData.length?this.classifyData:[]},level2Options:function(){var e=this;if(!this.ClassifyComputed.level1Val&&0!==this.ClassifyComputed.level1Val||0===this.level1Options.length)return[];var t=this.level1Options.find((function(t){return t.ID===e.ClassifyComputed.level1Val}));return t?t.children:[]},ClassifyComputed:{get:function(){return{level1Val:this.ruleForm.Classify.FirstLevel.ID,level2Val:this.ruleForm.Classify.SecondLevel.ID}},set:function(e){var t=e.level1Val,a=e.level2Val;this.ruleForm.Classify.FirstLevel.ID=t,this.ruleForm.Classify.SecondLevel.ID=a}}},data:function(){return{title:"添加工艺",ruleForm:null,rules:{Name:[{required:!0,message:"请输入内部名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],ShowName:[{required:!0,message:"请输入显示名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],Classify:[{validator:this.classifyValidator,trigger:"change"}]}}},methods:{onSubmit:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var a,l,n,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.ruleForm.validate().catch((function(){}));case 2:if(!t.sent){t.next=11;break}return a=!!e.curData,e.ruleForm.Classify.FirstLevel.Name=e.getLevelName(e.ruleForm.Classify.FirstLevel.ID,e.level1Options),e.ruleForm.Classify.SecondLevel.Name=e.getLevelName(e.ruleForm.Classify.SecondLevel.ID,e.level2Options),t.next=9,e.api.getCraftSave(e.ruleForm).catch((function(){}));case 9:(l=t.sent)&&200===l.status&&1e3===l.data.Status&&(n=a?"编辑工艺成功":"添加工艺成功",s=function(){e.handleSaveSuccess(a,Object(i.a)({},e.ruleForm,{ID:l.data.Data}))},e.messageBox.successSingle(n,s,s));case 11:case"end":return t.stop()}}),t)})))()},getLevelName:function(e,t){var a=t.find((function(t){return t.ID===e}));return a?a.ClassName:""},handleSaveSuccess:function(e,t){this.$emit("submitSuccess",e,t),this.onCancle()},classifyValidator:function(e,t,a){var l=t.FirstLevel,i=t.SecondLevel,n=l.ID||0===l.ID,s=i.ID||0===i.ID;n?s?a():a(new Error("请选择二级工艺分类")):a(new Error("请选择工艺分类"))},onCancle:function(){this.$emit("update:visible",!1)},onOpen:function(){this.$nextTick(this.initEditData)},onClosed:function(){this.ruleForm=null,this.$emit("close")},initEditData:function(){this.curData?this.ruleForm=JSON.parse(JSON.stringify(this.curData)):this.ruleForm={ID:"",Name:"",ShowName:"",Classify:{Type:0,FirstLevel:{ID:"",Name:""},SecondLevel:{ID:"",Name:""}},ElementList:[],GroupList:[]},this.title=this.curData?"编辑工艺":"添加工艺"}}},r=(a("8449"),a("2877")),c=Object(r.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("CommonDialogComp",{staticClass:"mp-erp-comps-craft-manage-save-dialog-comp-wrap",attrs:{width:"800px",top:"15vh",title:e.title,visible:e.visible},on:{"update:visible":function(t){e.visible=t},submit:e.onSubmit,cancle:e.onCancle,open:e.onOpen,closed:e.onClosed}},[e.ruleForm?a("el-form",{ref:"ruleForm",staticClass:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"168px",size:"small"}},[a("el-form-item",{attrs:{label:"内部名称：",prop:"Name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{maxlength:"10","show-word-limit":""},model:{value:e.ruleForm.Name,callback:function(t){e.$set(e.ruleForm,"Name","string"==typeof t?t.trim():t)},expression:"ruleForm.Name"}})],1),a("el-form-item",{attrs:{label:"显示名称：",prop:"ShowName"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{maxlength:"10","show-word-limit":""},model:{value:e.ruleForm.ShowName,callback:function(t){e.$set(e.ruleForm,"ShowName","string"==typeof t?t.trim():t)},expression:"ruleForm.ShowName"}})],1),a("el-form-item",{attrs:{label:"工艺分类：",prop:"Classify"}},[a("TwoLevelSelectComp",{attrs:{level1Options:e.level1Options,level2Options:e.level2Options,defaultProps:{label:"ClassName",value:"ID"}},model:{value:e.ClassifyComputed,callback:function(t){e.ClassifyComputed=t},expression:"ClassifyComputed"}})],1)],1):e._e()],1)}),[],!1,null,null,null).exports,u=(a("a15b"),a("d81d"),a("2af0")),f={props:{dataList:{default:function(){return[]},type:Array},loading:{type:Boolean,default:!1}},computed:{localTableData:function(){var e=this;return this.dataList&&Array.isArray(this.dataList)&&0!==this.dataList.length?this.dataList.map((function(t){return Object(i.a)({},t,{ClassiftText:e.getClassiftText(t),ElementText:e.getElementText(t.ElementList)})})):[]}},mixins:[u.a],methods:{setHeight:function(){var e=this.getHeight(".mp-erp-craft-manage-craft-list-page-wrap > header",53);this.h=e},onEditClick:function(e){this.$emit("edit",e)},onRemoveClick:function(e){this.$emit("remove",e)},onElementClick:function(e){this.$emit("setElement",e)},getClassiftText:function(e){if(!e)return"";var t=e.Classify;if(t){var a=t.FirstLevel,l=t.SecondLevel;return"".concat(a.Name," ").concat(l.Name)}return""},getElementText:function(e){return e&&Array.isArray(e)&&0!==e.length?e.map((function(e){return e.Name})).join("、"):""},getTips:function(e){return e&&0!==e.length?e.map((function(e){return e.Name})).join("、"):""}}},m=(a("6143"),Object(r.a)(f,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{key:"mp-erp-craft-list-page-craft-table-comp-wrap",staticClass:"mp-erp-craft-list-page-craft-table-comp-wrap",staticStyle:{width:"100%"},attrs:{"max-height":e.h,height:e.h,stripe:"",border:"",data:e.localTableData,fit:""}},[a("el-table-column",{attrs:{prop:"Name",label:"内部名称",width:"260"}}),a("el-table-column",{attrs:{prop:"ShowName",label:"显示名称","min-width":"240","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"ClassiftText",label:"所属分类","min-width":"240","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"ElementText",label:"元素","min-width":"240","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"GroupText",label:"元素组","min-width":"240","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.GroupList,(function(t){return a("span",{key:t.ID,attrs:{title:e.getTips(t.ElementList)}},[e._v(" "+e._s(t.Name)+"（"+e._s(t.UseTimes.MinValue)+"-"+e._s(t.UseTimes.MaxValue)+"次）")])}))}}])}),a("el-table-column",{attrs:{label:"操作","min-width":"380"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticClass:"menu-list"},[a("span",{on:{click:function(a){return e.onElementClick(t.row)}}},[a("i"),e._v("界面元素")]),a("span",{on:{click:function(a){return e.onEditClick(t.row)}}},[a("i"),e._v("编辑")]),a("span",{on:{click:function(a){return e.onRemoveClick(t.row,t.$index)}}},[a("i"),e._v("删除")])])}}])}),a("div",{attrs:{slot:"empty"},slot:"empty"},[a("span",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}]},[e._v("暂无数据")])])],1)}),[],!1,null,null,null)).exports,p=a("8aa1"),d=a("2f62"),v={components:{CraftSaveDialog:c,CraftListTableComp:m,CountComp:p.a},data:function(){return{visible:!1,curData:null,loading:!1}},computed:Object(i.a)({},Object(d.e)("basicSet",["CraftDataList","CraftDataNumber","Condition4CraftList","craftFetchData"]),{},Object(d.c)("common",["twoLevelsCraftClassify"])),methods:{onCraftItemSave:function(e){this.curData=e,this.visible=!0},jumpToClassifyPageClick:function(){this.$router.push("/CraftClassifyManage")},onCraftSaveSuccess:function(e,t){this.$store.commit("basicSet/setCraftDataListItemSave",[e,t])},getCraftListData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Object(l.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.loading=!0,a.next=3,e.$store.dispatch("basicSet/getCraftDataList",t);case 3:e.loading=!1;case 4:case"end":return a.stop()}}),a)})))()},onRemoveClick:function(e){var t=this,a=e.Name,l=e.ID;this.messageBox.warnCancelBox("确实删除该工艺吗","工艺名称：[ ".concat(a," ]"),(function(){t.$store.dispatch("basicSet/getCraftRemove",l)}))},onSetElementClick:function(e){if(e){var t=e.Name,a=e.ID;this.$router.push("CraftElementSet/".concat(a,"/").concat(t))}}},mounted:function(){this.$store.dispatch("common/getCraftClassifyData"),this.getCraftListData()},activated:function(){this.craftFetchData&&(this.getCraftListData(),this.$store.commit("basicSet/setCraftFetchData",!1))}},h=(a("6d48"),Object(r.a)(v,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"mp-erp-craft-manage-craft-list-page-wrap"},[a("header",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onCraftItemSave(null)}}},[e._v("添加工艺")]),a("span",{staticClass:"blue-span",on:{click:e.jumpToClassifyPageClick}},[e._v("管理工艺分类")])],1),a("main",[a("CraftSaveDialog",{attrs:{curData:e.curData,visible:e.visible,classifyData:e.twoLevelsCraftClassify},on:{"update:visible":function(t){e.visible=t},submitSuccess:e.onCraftSaveSuccess}}),a("CraftListTableComp",{attrs:{loading:e.loading,dataList:e.CraftDataList},on:{edit:e.onCraftItemSave,remove:e.onRemoveClick,setElement:e.onSetElementClick}})],1),a("footer",[a("CountComp",{attrs:{count:e.CraftDataNumber,watchPage:e.Condition4CraftList.Page,handlePageChange:e.getCraftListData,center:""}})],1)])}),[],!1,null,null,null));t.default=h.exports},4439:function(e,t,a){},"468e":function(e,t,a){"use strict";var l=a("4aae");a.n(l).a},"4aae":function(e,t,a){},6143:function(e,t,a){"use strict";var l=a("b61a");a.n(l).a},"6d48":function(e,t,a){"use strict";var l=a("0970");a.n(l).a},8449:function(e,t,a){"use strict";var l=a("4439");a.n(l).a},"8e6e":function(e,t,a){"use strict";var l=a("dc48");a.n(l).a},ad32:function(e,t,a){"use strict";var l={model:{prop:"value",event:"change"},props:{visible:{type:Boolean,default:!1},title:{type:String,default:"提示"},width:{default:"30%"},top:{type:String,default:"15vh"},showSubmit:{type:Boolean,default:!0},submitText:{type:String,default:"保存"},dangerText:{type:String,default:"重新生成"},cancelText:{type:String,default:"取消"},disabled:{type:Boolean,default:!1},showDanger:{type:Boolean,default:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},data:function(){return{checkList:[]}},methods:{onCancleClick:function(){this.$emit("cancle")},onSubmitClick:function(){this.dialogVisible&&this.$emit("submit")},onDangerClick:function(){this.$emit("danger")},onOpen:function(){this.$emit("open")},onOpened:function(){this.$emit("opened")},onClose:function(){this.$emit("close")},onClosed:function(){this.$emit("closed")}}},i=(a("468e"),a("2877")),n=Object(i.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header mp-erp-common-dialog-comp-wrap",attrs:{title:e.title,visible:e.dialogVisible,"close-on-click-modal":!1,width:e.width,top:e.top,modal:!1,"before-close":e.onCancleClick},on:{"update:visible":function(t){e.dialogVisible=t},open:e.onOpen,opened:e.onOpened,close:e.onClose,closed:e.onClosed}},[e._t("default"),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.showSubmit?a("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:e.onSubmitClick}},[e._v(e._s(e.submitText))]):e._e(),e.showDanger?a("el-button",{attrs:{type:"danger"},on:{click:e.onDangerClick}},[e._v(e._s(e.dangerText))]):e._e(),a("el-button",{on:{click:e.onCancleClick}},[e._v(e._s(e.cancelText))])],1)],2)}),[],!1,null,null,null);t.a=n.exports},b61a:function(e,t,a){},c209:function(e,t,a){"use strict";var l=a("c6ab"),i={props:{title:{type:String,default:""},level1Options:{type:Array,default:function(){return[]}},level2Options:{type:Array,default:function(){return[]}},defaultProps:{type:Object,default:function(){return{label:"Name",value:"ID"}}},lv2DefaultProps:{type:Object,default:null},value:{type:Object,default:function(){return{level1Val:"",level2Val:""}}},isAssociated:{type:Boolean,default:!0}},model:{prop:"value",event:"change"},components:{SelectComp:l.a},computed:{level1:{get:function(){return this.value.level1Val},set:function(e){this.value.level1Val!==e&&this.$emit("change",{level1Val:e,level2Val:this.isAssociated?"":this.level2})}},level2:{get:function(){return this.value.level2Val},set:function(e){this.$emit("change",{level1Val:this.level1,level2Val:e})}}}},n=(a("0a1e"),a("2877")),s=Object(n.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"mp-erp-common-select-comps-two-level-select-comp-wrap"},[e.title?a("li",{staticClass:"text"},[a("span",[e._v(e._s(e.title)+"：")])]):e._e(),a("li",{staticClass:"first-select-box"},[a("SelectComp",{attrs:{options:e.level1Options,defaultProps:e.defaultProps},model:{value:e.level1,callback:function(t){e.level1=t},expression:"level1"}})],1),a("li",[a("SelectComp",{attrs:{options:e.level2Options,defaultProps:e.lv2DefaultProps||e.defaultProps},model:{value:e.level2,callback:function(t){e.level2=t},expression:"level2"}})],1)])}),[],!1,null,null,null);t.a=s.exports},c6ab:function(e,t,a){"use strict";var l={props:{value:{default:"不限"},options:{type:Array,default:function(){return[{value:"",label:"不限"}]}},defaultProps:{type:Object,default:function(){return{label:"label",value:"value"}}},filterable:{type:Boolean,default:!1}},model:{prop:"value",event:"change"},computed:{result:{get:function(){return this.value},set:function(e){e!==this.value&&this.$emit("change",e)}}}},i=(a("8e6e"),a("2877")),n=Object(i.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{staticClass:"mp-erp-new-common-select-comp-wrap",attrs:{filterable:e.filterable,size:"small"},model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},e._l(e.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t[e.defaultProps.label],value:t[e.defaultProps.value]}})})),1)}),[],!1,null,null,null);t.a=n.exports},dc48:function(e,t,a){},e57c:function(e,t,a){}}]);