(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e2af82da"],{"06e5":function(t,e,i){},"09f8":function(t,e,i){"use strict";var n={props:{title:{type:String,default:"关闭"},disabled:{type:Boolean,default:!1}}},r=(i("3f2b"),i("2877")),a=Object(r.a)(n,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"normal-full-btn",class:t.disabled?"is-disabled":"",attrs:{disabled:t.disabled}},[t._v(t._s(t.title))])}),[],!1,null,null,null);e.a=a.exports},"0c68":function(t,e,i){},"24de":function(t,e,i){},2845:function(t,e,i){"use strict";i.r(e);var n=(i("7db0"),i("4160"),i("a15b"),i("d81d"),i("ac1f"),i("5319"),i("159b"),i("96cf"),i("1da1")),r=i("5530"),a=i("2f62"),o=i("09f8"),s=i("edeb"),l=i("2909"),c={props:{ProductList:{type:Array,required:!0},ProductClass:{type:Object,required:!0}},computed:Object(r.a)({},Object(a.e)("timelimit",["setPageType","TimeLimitData"]),{},Object(a.c)("common",["allProductClassify"]),{showList:function(){var t=this;if(!this.allProductClassify||0===this.allProductClassify.length)return[];var e=this.allProductClassify.find((function(e){return e.ID===t.ProductClass.FirstLevelID}));if(!e)return[];var i=e.children.find((function(e){return e.ID===t.ProductClass.SecondLevelID}));return i?i.children.map((function(t){return{ID:t.ID,Name:t.ClassName}})):[]},checkList:{get:function(){return this.ProductList.map((function(t){return t.ID}))},set:function(t){this.setProductListChange(t.map((function(t){return{ID:t}})))}},checkAll:{get:function(){return 0!==this.showList&&this.showList.length===this.ProductList.length},set:function(t){this.setProductListChange(t?this.showList:[])}},isIndeterminate:function(){return 0!==this.ProductList.length&&this.showList.length!==this.ProductList.length&&this.ProductList.length<this.showList.length}}),data:function(){return{productDisabled:!1}},methods:{setProductListChange:function(t){var e=this;if(t.length>1&&this.checkList.length>1)this.$store.commit("timelimit/setTimeLimitData",["ProductList",t]);else{if(this.TimeLimitData.SchemaList.length>0)if(this.TimeLimitData.SchemaList.find((function(t){var e,i;return(null===(e=t.Constraint)||void 0===e||null===(i=e.ItemList)||void 0===i?void 0:i.length)>0}))){return void this.messageBox.warnCancelBox("当前修改将会清空其它条件设置","执行当前修改将会清空已设置工期列表中的所有其它条件，确认修改吗 ？",(function(){e.$store.commit("timelimit/setTimeLimitData",["SchemaPropertyList",[]]),e.$store.commit("timelimit/setTimeLimitData",["ProductList",t]),e.$store.commit("timelimit/setTimeLimitAllSchemaItemConstraintClear")}),(function(){var i=Object(l.a)(e.checkList).map((function(t){return{ID:t}}));e.$store.commit("timelimit/setTimeLimitData",["ProductList",t]),e.$nextTick((function(){e.$store.commit("timelimit/setTimeLimitData",["ProductList",i])}))}))}this.$store.commit("timelimit/setTimeLimitData",["SchemaPropertyList",[]]),this.$store.commit("timelimit/setTimeLimitData",["ProductList",t])}}},mounted:function(){this.$store.dispatch("common/getAllProductNames")}},u=(i("7db5"),i("2877")),f=Object(u.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"mp-erp-time-limit-set-page-content-product-select-comp-wrap"},[i("header",[t._v("指定产品：")]),i("div",[i("p",[i("el-checkbox",{attrs:{indeterminate:t.isIndeterminate,disabled:t.productDisabled},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")])],1),i("el-checkbox-group",{attrs:{disabled:t.productDisabled},model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.showList,(function(e){return i("el-checkbox",{key:e.ID,attrs:{label:e.ID}},[t._v(" "+t._s(e.Name)+" ")])})),1)],1)])}),[],!1,null,null,null).exports,m=(i("99af"),i("4de4"),i("caad"),i("b0c0"),i("2532"),i("3835")),d=i("3eca"),p=i("286f"),h={components:{},data:function(){return{dialogTitle:"添加工期",IncludeLimitArea:!0,curEditIndex:0,bool4GetCondition:!1}},computed:Object(r.a)({},Object(a.e)("timelimit",["SchemaItemData","TimeLimitData","ConditionList4ProducePeriodProduct","setPageType"]),{},Object(a.e)("common",["OperatorKeyValueList"]),{},Object(a.c)("common",["subExpressList","allAdAreaTreeList"]),{subExpressIDList:function(){return this.subExpressList&&0!==this.subExpressList.length?this.subExpressList.map((function(t){return t.ID})):[]},SellAreaArrayList:function(){var t=this;if(0===this.allAdAreaTreeList.length)return[];var e=this.TimeLimitData.SchemaList.map((function(t){return t.AreaList})).map((function(e){return Object(p.a)(e,t.allAdAreaTreeList,"Name")})),i="Name";return e&&0!==e.length?e.map((function(t){var e=[];return"全部区域"===t?["全部区域"]:(t.forEach((function(t){if(p.c.test(t.children[0]))e.push("".concat(t[i]));else{var n="".concat(t[i],"：[");t.children.forEach((function(t,e){e>0&&(n+="、"),p.c.test(t.children[0])?n+="".concat(t[i],"全部区域 "):(n+="".concat(t[i],": "),t.children.forEach((function(t,e){n+=0===e?"".concat(t[i]):"、".concat(t[i])})))})),n+=" ]",e.push(n)}})),e)})):""},ConditionTextList:function(){var t=this;return this.TimeLimitData.SchemaList.map((function(e){return e.Constraint?t.getConditionText(e.Constraint.ItemList,e.Constraint.FilterType):{type:"",_list:[]}}))},watchVal4SetBool4GetCondition:function(){return this.TimeLimitData&&this.TimeLimitData.ProductList?this.TimeLimitData.ProductList.length:0},tableDataList:function(){var t=this;return this.TimeLimitData.SchemaList&&0!==this.TimeLimitData.SchemaList.length?this.TimeLimitData.SchemaPropertyList&&0!==this.TimeLimitData.SchemaPropertyList.length?this.TimeLimitData.SchemaList.map((function(e){if(!e.Constraint)return Object(r.a)({},e,{conditionText:"无"});var i=d.d.getConstraintAndTextByImperfectConstraint(e.Constraint,t.TimeLimitData.SchemaPropertyList),n=Object(m.a)(i,2),a=n[0],o=n[1];return Object(r.a)({},e,{Constraint:a,conditionText:o})})):this.TimeLimitData.SchemaList:[]}}),methods:{onAddOrEditBtnClick:function(t){this.TimeLimitData&&(0!==this.TimeLimitData.ProductList.length?(this.$store.commit("timelimit/setSchemaItemDataInit",t||0===t?this.TimeLimitData.SchemaList[t]:{}),this.$router.push({name:"SchemaItemSet",params:{EditIndex:t||0===t?t:"new"}})):this.$message({showClose:!0,message:"请先选择指定产品",type:"error"}))},handleSchemaDel:function(t){var e=this;this.messageBox.warnCancelNullMsg("确定删除该条工期吗 ?",(function(){return e.$store.commit("timelimit/deleteTimeLimitSchemaItem",t)}),null)},getConditionText:function(t,e){var i=this,n={type:1===e?"并且":2===e?"或者":"",_list:[]};return t.forEach((function(t){var e=i.ConditionList4ProducePeriodProduct.find((function(e){return e.PropertyType===t.PropertyType&&e.PropertyID===t.PropertyID&&e.GroupID===t.GroupID&&e.CraftID===t.CraftID&&e.PartID===t.PartID&&e.ProductID===t.ProductID}));if(e){var r={};r.Prefix=e.Prefix;var a=i.OperatorKeyValueList.find((function(e){return e.ID===t.Operator}));if(r.Operator=a.name,1===e.ValueType)r.Value="".concat(t.Value).concat(e.Unit);else if(2===e.ValueType){var o=e.OptionList.find((function(e){return e.OptionID===t.Value})),s=o?o.Value:"";r.Value=s}n._list.push(r)}})),n},getExpressNames:function(t){var e=this,i=t.filter((function(t){return e.subExpressIDList.includes(t.ID)}));if(0===i.length||0===this.subExpressList.length)return"";if(i.length===this.subExpressList.length-1){var n=!0;if(i.forEach((function(t){1!==t.ID&&n||(n=!1)})),n)return"名片之家除外"}var r=[];return i.forEach((function(t){var i=e.subExpressList.find((function(e){return e.ID===t.ID}));i&&r.push(i.Name)})),r.join("、")},getSchemaPropertyList:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var i,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.TimeLimitData.SchemaPropertyList&&0!==t.TimeLimitData.SchemaPropertyList.length){e.next=8;break}return i=t.TimeLimitData.ProductList,n={UseModule:41},1===i.length&&(n.ProductID=i[0].ID),e.next=6,d.d.getPropertyList(n);case 6:(r=e.sent)&&t.$store.commit("timelimit/setTimeLimitData",["SchemaPropertyList",r]);case 8:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.$store.dispatch("common/getExpressList"),t.$store.dispatch("common/fetchAdAreaList"),"edit"===t.setPageType&&t.TimeLimitData.SchemaList.length>=1&&t.getSchemaPropertyList();case 3:case"end":return e.stop()}}),e)})))()},watch:{watchVal4SetBool4GetCondition:function(){this.bool4GetCondition=!0}}},v=(i("3307"),Object(u.a)(h,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"mp-erp-time-limit-set-page-content-schema-list-comp-wrap"},[i("header",[t._v("工期列表：")]),i("div",[i("p",[i("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.onAddOrEditBtnClick(null)}}},[t._v("+添加工期")])],1),t.TimeLimitData?i("el-table",{staticStyle:{width:"1600px"},attrs:{border:"",data:t.tableDataList,"max-height":"261"}},[i("el-table-column",{attrs:{label:"选中区域",width:"186"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.SellAreaArrayList[e.$index]&&t.SellAreaArrayList[e.$index].length>0?i("el-tooltip",{attrs:{placement:"top-start",enterable:!0,transition:"none"}},[i("div",{attrs:{slot:"content"},slot:"content"},t._l(t.SellAreaArrayList[e.$index],(function(e,n){return i("p",{key:e+"-"+n},[t._v(" "+t._s(e)+" ")])})),0),i("span",{staticClass:"area-span"},[t._v(t._s(t.SellAreaArrayList[e.$index].join(" ")))])]):t._e(),t.SellAreaArrayList[e.$index]&&0===t.SellAreaArrayList[e.$index].length?i("span",[t._v("全部区域"),i("i",{staticClass:"is-gray"},[t._v("（反选）")])]):t._e()]}}],null,!1,756546676)}),i("el-table-column",{attrs:{width:"105","show-overflow-tooltip":"",label:"生效方式"},scopedSlots:t._u([{key:"default",fn:function(e){return[!e.row.IncludeLimitArea&&t.SellAreaArrayList[e.$index]&&0===t.SellAreaArrayList[e.$index].length?i("span",{staticClass:"is-success"},[t._v("全部区域生效")]):e.row.IncludeLimitArea?i("span",[t._v("选中区域生效")]):i("span",{staticClass:"is-pink"},[t._v("非选中区域生效")])]}}],null,!1,2525464108)}),i("el-table-column",{attrs:{label:"配送方式","show-overflow-tooltip":"",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.subExpressList.length>e.row.ExpressList.length?t.getExpressNames(e.row.ExpressList):"所有配送方式")+" ")]}}],null,!1,1731328528)}),i("el-table-column",{attrs:{prop:"address",width:"365","show-overflow-tooltip":"",label:"其它条件"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.conditionText&&"object"==typeof e.row.conditionText?i("el-tooltip",{attrs:{effect:"light","popper-class":"common-property-condition-text-tips-box",placement:"bottom-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",{staticClass:"if-box"},[i("span",{staticClass:"is-origin"},[t._v("如果")]),t._v(" "+t._s(e.row.Constraint&&1===e.row.Constraint.FilterType?"满足所有":"满足任一")+"：")]),t._l(e.row.conditionText,(function(n,r){return i("p",{key:n.name+"tips"+r},[r>0?i("span",{staticClass:"type"},[t._v(t._s(1===e.row.Constraint.FilterType?"且":"或"))]):t._e(),i("span",{staticClass:"name"},[t._v(t._s(n.name))]),i("span",{staticClass:"is-origin"},[t._v(t._s(n.operator))]),i("span",{staticClass:"val"},[t._v(t._s(n.val))]),r===e.row.conditionText.length-1?i("span",{staticStyle:{"margin-left":"2px"}},[t._v(" 。")]):i("span",{staticStyle:{"margin-left":"2px"}},[t._v("；")])])}))],2),i("div",{staticClass:"common-property-condition-text-content-box"},[i("p",{staticClass:"if-box"},[i("span",{staticClass:"is-origin"},[t._v("如果")]),t._v(" "+t._s(e.row.Constraint&&1===e.row.Constraint.FilterType?"满足所有":"满足任一")+"：")]),t._l(e.row.conditionText,(function(n,r){return i("p",{key:n.name+"content"+r},[r>0?i("span",{staticClass:"type"},[t._v(t._s(1===e.row.Constraint.FilterType?"且":"或"))]):t._e(),i("span",[t._v(t._s(n.name))]),i("span",{staticClass:"is-origin"},[t._v(t._s(n.operator))]),i("span",[t._v(t._s(n.val))])])}))],2)]):t._e(),e.row.conditionText&&"string"==typeof e.row.conditionText?i("span",[t._v(t._s(e.row.conditionText))]):t._e(),e.row.conditionText?t._e():i("span",[t._v("无")])]}}],null,!1,4286354977)}),i("el-table-column",{attrs:{width:"125","show-overflow-tooltip":"",label:"付款时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(("0"+e.row.LatestPayTime.First).slice(-2)+":"+("0"+e.row.LatestPayTime.Second).slice(-2)+"之前")+" ")]}}],null,!1,2173409803)}),i("el-table-column",{attrs:{width:"105","show-overflow-tooltip":"",label:"生产工期"},scopedSlots:t._u([{key:"default",fn:function(e){return i("span",{staticClass:"is-success"},[t._v(" "+t._s(e.row.ProduceDuration>=24?Math.floor(e.row.ProduceDuration/24)+"天 "+e.row.ProduceDuration%24+"小时":e.row.ProduceDuration+"小时")+" ")])}}],null,!1,3034502388)}),i("el-table-column",{attrs:{width:"115","show-overflow-tooltip":"",label:"数量递增"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.ProductIncrementDuration&&e.row.ProductIncrement?e.row.ProductIncrementDuration+"小时 / "+e.row.ProductIncrement:"")+" ")]}}],null,!1,646371726)}),i("el-table-column",{attrs:{width:"125","show-overflow-tooltip":"",label:"工艺工期"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(3===e.row.CraftPeriodType?e.row.CraftIncrementDuration+"小时 / "+e.row.CraftIncrement+"种":"")+" "),0===e.row.CraftPeriodType?i("span",[t._v("不额外增加")]):t._e(),1===e.row.CraftPeriodType?i("span",[t._v("累加工艺工期")]):t._e(),2===e.row.CraftPeriodType?i("span",[t._v("仅增长最长工艺工期")]):t._e()]}}],null,!1,1716044465)}),i("el-table-column",{attrs:{prop:"address",width:"80","show-overflow-tooltip":"",label:"配送工期"},scopedSlots:t._u([{key:"default",fn:function(e){return i("span",{class:e.row.IncludeExpress?"":"is-gray"},[t._v(" "+t._s(e.row.IncludeExpress?e.row.DeliveryDuration>=24?Math.floor(e.row.DeliveryDuration/24)+"天 "+e.row.DeliveryDuration%24+"小时":e.row.DeliveryDuration+"小时":"不含")+" ")])}}],null,!1,433828229)}),i("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{staticClass:"menu-list"},[i("span",{on:{click:function(i){return t.onAddOrEditBtnClick(e.$index)}}},[i("i"),t._v("编辑")]),i("span",{on:{click:function(i){return t.handleSchemaDel(e.$index)}}},[i("i"),t._v("删除")])])}}],null,!1,3230772198)})],1):t._e()],1)])}),[],!1,null,null,null)).exports,D=(i("a434"),i("d3b7"),i("3ca3"),i("ddb0"),i("fafd")),C={components:{normalBtnFull:o.a,normalBtn:s.a},data:function(){return{dialogOpenType:"add",showMultipleDialog:!1,conditionList:[],curEditIndex:0,showSingleDialog:!1}},computed:Object(r.a)({},Object(a.e)("timelimit",["TimeLimitData","CraftPeriodItemData","CraftPeriodCraftListData"]),{},Object(a.e)("common",["OperatorKeyValueList"]),{dialogTitle:function(){if(!this.showSingleDialog&&!this.showMultipleDialog)return"";var t="add"===this.dialogOpenType?"添加":"编辑",e=this.showSingleDialog?"单个":this.showMultipleDialog?"多个":"";return"".concat(t).concat(e,"工艺工期")},DurationDay:{get:function(){return this.CraftPeriodItemData?this.CraftPeriodItemData.DurationDay:""},set:function(t){var e=t.replace(/[^\d]/g,"");this.$store.commit("timelimit/setCraftPeriodItemData",["DurationDay",e]);var i=this.CraftPeriodItemData.Duration?Math.floor(this.CraftPeriodItemData.Duration%24):0;this.$store.commit("timelimit/setCraftPeriodItemData",["Duration",+i+24*+e])}},DurationHour:{get:function(){return this.CraftPeriodItemData?this.CraftPeriodItemData.DurationHour:""},set:function(t){var e=t.replace(/[^\d]/g,"");e>=24&&(e=23),this.$store.commit("timelimit/setCraftPeriodItemData",["DurationHour",e]);var i=this.CraftPeriodItemData.Duration?Math.floor(this.CraftPeriodItemData.Duration/24):0;this.$store.commit("timelimit/setCraftPeriodItemData",["Duration",24*+i+ +e])}},CheckAllCraft:{get:function(){return this.CraftPeriodItemData.CraftList.length>0&&this.CraftPeriodItemData.CraftList.length===this.craftList.length},set:function(t){var e=t?this.craftList.map((function(t){return{ID:t.ID}})):[];this.$store.commit("timelimit/setCraftPeriodItemData",["CraftList",e])}},isIndeterminate:function(){return 0!==this.CraftPeriodItemData.CraftList.length&&this.craftList.length!==this.CraftPeriodItemData.CraftList.length&&this.CraftPeriodItemData.CraftList.length<this.craftList.length},CraftListNames:function(){var t=this;return 0!==this.craftList.lenght&&this.TimeLimitData.CraftPeriodList&&0!==this.TimeLimitData.CraftPeriodList.length?this.TimeLimitData.CraftPeriodList.map((function(e){var i=[];return e.CraftList.forEach((function(e){var n=t.craftList.find((function(t){return e.ID===t.ID}));n&&i.push(n.Name)})),i.length>0?i.join("、"):""})):[]},ConditionTextList:function(){var t=this;return this.TimeLimitData.CraftPeriodList.map((function(e){return e.Constraint?t.getConditionText(e.Constraint.ItemList,e.Constraint.FilterType):{type:"",_list:[]}}))},craftList:{get:function(){return this.CraftPeriodCraftListData},set:function(t){this.$store.commit("timelimit/setCraftPeriodCraftListData",t)}},selectedCraftList:{get:function(){return this.showMultipleDialog?this.CraftPeriodItemData.CraftList.map((function(t){return t.ID})):""},set:function(t){var e=t.map((function(t){return{ID:t}}));this.$store.commit("timelimit/setCraftPeriodItemData",["CraftList",e])}},tableDataList:function(){return this.TimeLimitData&&this.TimeLimitData.CraftPeriodList&&0!==this.TimeLimitData.CraftPeriodList.length?this.TimeLimitData.CraftPeriodList.map((function(t){if(!t.Constraint)return Object(r.a)({},t,{conditionText:"无"});var e=t.CraftPeriodProppertyList||[],i=d.d.getConstraintAndTextByImperfectConstraint(t.Constraint,e),n=Object(m.a)(i,2),a=n[0],o=n[1];return Object(r.a)({},t,{Constraint:a,conditionText:o,FilterTypeText:t.Constraint&&1===t.Constraint.FilterType?"满足所有":"满足任一"})})):[]}}),methods:{getCraftList:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var i,n,r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.TimeLimitData&&!(t.craftList.length>0)){e.next=2;break}return e.abrupt("return");case 2:return i=t.TimeLimitData.ProductClass,n=i.FirstLevelID,r=i.SecondLevelID,a={ProductClass:{First:n,Second:r}},e.next=6,t.api.getCraftList(a).catch((function(){}));case 6:if(!(o=e.sent)||1e3===o.data.Status){e.next=9;break}return e.abrupt("return");case 9:t.craftList=o.data.Data;case 10:case"end":return e.stop()}}),e)})))()},onSingleCraftClick:function(t){this.$store.commit("timelimit/setCraftPeriodItemDataInit",{IsSignle:!0}),this.$router.push({name:"SingleCraftPeriodItemSet",params:{EditIndex:t||0===t?t:"new"}})},onMultipleCraftClick:function(){this.dialogOpenType="add",this.showMultipleDialog=!0,this.$store.commit("timelimit/setCraftPeriodItemDataInit",{IsSignle:!1})},handleMultipleDialogClose:function(){this.showMultipleDialog=!1},handleConditionItemDEdit:function(t){var e=Object(m.a)(t,2),i=e[0],n=e[1];this.$store.commit("timelimit/editCraftPeriodItemData4Constraint",[n,i])},handleConditionItemDel:function(t){this.$store.commit("timelimit/editCraftPeriodItemData4Constraint",[t])},handleDialogSave:function(){if(this.showMultipleDialog){var t=D.a.check(this.CraftPeriodItemData);if(!0===t){var e=[];"edit"===this.dialogOpenType?(e=Object(l.a)(this.TimeLimitData.CraftPeriodList)).splice(this.curEditIndex,1,Object(r.a)({},this.CraftPeriodItemData)):e=[Object(r.a)({},this.CraftPeriodItemData)].concat(Object(l.a)(this.TimeLimitData.CraftPeriodList)),this.$store.commit("timelimit/setTimeLimitData",["CraftPeriodList",e]),this.showMultipleDialog&&(this.showMultipleDialog=!1)}else"string"==typeof t&&this.messageBox.failSingleError("保存失败","[ ".concat(t," ]"))}},handleDialogClose:function(){this.showMultipleDialog&&(this.showMultipleDialog=!1)},handleSchemaEdit:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:e.$store.commit("timelimit/setCraftPeriodItemDataInit",e.TimeLimitData.CraftPeriodList[t]),e.curEditIndex=t,e.dialogOpenType="edit",e.TimeLimitData.CraftPeriodList[t].IsSignle?e.$router.push({name:"SingleCraftPeriodItemSet",params:{EditIndex:t||0===t?t:"new"}}):e.showMultipleDialog=!0;case 5:case"end":return i.stop()}}),i)})))()},handleSchemaDel:function(t){var e=this;this.messageBox.warnCancelNullMsg("确定删除该条工艺工期吗 ?",(function(){return e.$store.commit("timelimit/deleteTimeLimitCraftPeriodItem",t)}),null)},getConditionText:function(t,e){var i=this,n={type:1===e?"并且":2===e?"或者":"",_list:[]};return t.forEach((function(t){var e={};e.Prefix=t.Prefix;var r=i.OperatorKeyValueList.find((function(e){return e.ID===t.Operator}));if(e.Operator=r.name,1===t.ValueType)e.Value="".concat(t.Value).concat(t.Unit?t.Unit:"");else if(2===t.ValueType){var a=t.OptionList?t.OptionList.find((function(e){return e.OptionID===t.Value})):null,o=a?a.Value:"";e.Value=o}n._list.push(e)})),n},getComparePropertyList:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var i,a,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((null===(i=t.TimeLimitData)||void 0===i||null===(a=i.CraftPeriodList)||void 0===a?void 0:a.length)>0)){e.next=6;break}return e.next=3,Promise.all(t.TimeLimitData.CraftPeriodList.map(function(){var t=Object(n.a)(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.IsSignle||1!==e.CraftList.length){t.next=7;break}return i={UseModule:42,CraftID:e.CraftList[0].ID},t.next=4,d.d.getPropertyList(i);case 4:if(!(n=t.sent)){t.next=7;break}return t.abrupt("return",n);case 7:return t.abrupt("return",[]);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:o=e.sent,s=t.TimeLimitData.CraftPeriodList.map((function(t,e){return Object(r.a)({},t,{CraftPeriodProppertyList:o[e]})})),t.$store.commit("timelimit/setTimeLimitData",["CraftPeriodList",s]);case 6:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.getCraftList(),this.getComparePropertyList()}},L=(i("90b7"),Object(u.a)(C,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"mp-erp-time-limit-set-page-content-craft-schema-comp-wrap"},[i("header",[t._v("工艺工期：")]),i("div",[i("p",[i("span",{staticClass:"blue-span",on:{click:function(e){return t.onSingleCraftClick(null)}}},[t._v("+添加单个工艺工期")]),i("span",{staticClass:"blue-span",on:{click:t.onMultipleCraftClick}},[t._v("+添加多个工艺工期")])]),t.TimeLimitData?i("el-table",{staticStyle:{width:"1600px"},attrs:{border:"",data:t.tableDataList,"max-height":"261"}},[i("el-table-column",{attrs:{label:"工艺","show-overflow-tooltip":"",width:"291"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.CraftListNames[e.$index])+" ")]}}],null,!1,3125022769)}),i("el-table-column",{attrs:{width:"180","show-overflow-tooltip":"",label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.IsSignle?"单个工艺":"多个工艺")+" ")]}}],null,!1,2382572021)}),i("el-table-column",{attrs:{prop:"address",width:"595",label:"其它条件"},scopedSlots:t._u([{key:"default",fn:function(e){return["object"==typeof e.row.conditionText?i("el-tooltip",{attrs:{effect:"light","popper-class":"common-property-condition-text-tips-box",placement:"bottom-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",{staticClass:"if-box"},[i("span",{staticClass:"is-origin"},[t._v("如果")]),t._v(" "+t._s(e.row.FilterTypeText)+"：")]),t._l(e.row.conditionText,(function(n,r){return i("p",{key:n.name+"tips"+r},[r>0?i("span",{staticClass:"type"},[t._v(t._s(1===e.row.Constraint.FilterType?"且":"或"))]):t._e(),i("span",{staticClass:"name"},[t._v(t._s(n.name))]),i("span",{staticClass:"is-origin"},[t._v(t._s(n.operator))]),i("span",{staticClass:"val"},[t._v(t._s(n.val))]),r===e.row.conditionText.length-1?i("span",{staticStyle:{"margin-left":"2px"}},[t._v(" 。")]):i("span",{staticStyle:{"margin-left":"2px"}},[t._v("；")])])}))],2),i("div",{staticClass:"common-property-condition-text-content-box",staticStyle:{"text-align":"left"}},[i("p",{staticClass:"if-box"},[i("span",{staticClass:"is-origin"},[t._v("如果")]),t._v(" "+t._s(e.row.FilterTypeText)+"：")]),t._l(e.row.conditionText,(function(n,r){return i("p",{key:n.name+"content"+r},[r>0?i("span",{staticClass:"type"},[t._v(t._s(1===e.row.Constraint.FilterType?"且":"或"))]):t._e(),i("span",[t._v(t._s(n.name))]),i("span",{staticClass:"is-origin"},[t._v(t._s(n.operator))]),i("span",[t._v(t._s(n.val))])])}))],2)]):t._e(),"string"==typeof e.row.conditionText?i("span",[t._v(t._s(e.row.conditionText))]):t._e()]}}],null,!1,2090023917)}),i("el-table-column",{attrs:{width:"320","show-overflow-tooltip":"",label:"工期"},scopedSlots:t._u([{key:"default",fn:function(e){return i("span",{staticClass:"is-success"},[t._v(" "+t._s(e.row.Duration>=24?Math.floor(e.row.Duration/24)+"天 "+e.row.Duration%24+"小时 / 工艺":e.row.Duration+"小时 / 工艺")+" ")])}}],null,!1,1004984500)}),i("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{staticClass:"menu-list"},[i("span",{on:{click:function(i){return t.handleSchemaEdit(e.$index)}}},[i("i"),t._v("编辑")]),i("span",{on:{click:function(i){return t.handleSchemaDel(e.$index)}}},[i("i"),t._v("删除")])])}}],null,!1,950361526)})],1):t._e()],1),t.CraftPeriodItemData?i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header single-craft-wrap",attrs:{title:t.dialogTitle,modal:!1,visible:t.showSingleDialog,width:"850px",top:"8vh"},on:{"update:visible":function(e){t.showSingleDialog=e}}},[i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("normal-btn-full",{attrs:{title:"确定"},nativeOn:{click:function(e){return t.handleDialogSave(e)}}}),i("normalBtn",{attrs:{title:"取消"},nativeOn:{click:function(e){return t.handleDialogClose(e)}}})],1)]):t._e(),t.CraftPeriodItemData?i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header multiple-craft-wrap",attrs:{title:t.dialogTitle,modal:!1,visible:t.showMultipleDialog,width:"850px",top:"8vh","before-close":t.handleMultipleDialogClose},on:{"update:visible":function(e){t.showMultipleDialog=e}}},[i("section",[i("div",[i("span",{staticClass:"title"},[t._v("工艺选择：")]),i("div",{staticClass:"right-content-check-box-wrap"},[i("p",[i("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},model:{value:t.CheckAllCraft,callback:function(e){t.CheckAllCraft=e},expression:"CheckAllCraft"}},[t._v("全选")])],1),i("el-checkbox-group",{model:{value:t.selectedCraftList,callback:function(e){t.selectedCraftList=e},expression:"selectedCraftList"}},t._l(t.craftList,(function(e){return i("el-checkbox",{key:e.ID,attrs:{label:e.ID}},[t._v(t._s(e.Name))])})),1)],1)]),i("div",[i("span",{staticClass:"title"},[t._v("工期：")]),i("div",{staticClass:"right-content"},[i("el-input",{model:{value:t.DurationDay,callback:function(e){t.DurationDay=e},expression:"DurationDay"}}),i("span",[t._v("天")]),i("el-input",{attrs:{max:24},model:{value:t.DurationHour,callback:function(e){t.DurationHour=e},expression:"DurationHour"}}),i("span",[t._v("小时")])],1)])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("normal-btn-full",{attrs:{title:"确定"},nativeOn:{click:function(e){return t.handleDialogSave(e)}}}),i("normalBtn",{attrs:{title:"取消"},nativeOn:{click:function(e){return t.handleDialogClose(e)}}})],1)]):t._e()],1)}),[],!1,null,null,null)).exports,g={props:{TimeLimitData:{type:Object,required:!0}},components:{ProductSelectComp:f,SchemaListComp:v,CraftSchemaComp:L}},b=(i("4ba8"),Object(u.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("article",{staticClass:"mp-erp-time-limit-set-page-content-wrap"},[i("ProductSelectComp",{attrs:{ProductList:t.TimeLimitData.ProductList,ProductClass:t.TimeLimitData.ProductClass}}),i("SchemaListComp"),i("CraftSchemaComp")],1)}),[],!1,null,null,null)).exports,w={name:"timeLimitSet",components:{normalBtnFull:o.a,normalBtn:s.a,LimitSetContentComp:b},computed:Object(r.a)({},Object(a.e)("timelimit",["TimeLimitData","setPageType"]),{},Object(a.c)("common",["allProductClassify","subExpressList"]),{subExpressIDList:function(){return this.subExpressList&&0!==this.subExpressList.length?this.subExpressList.map((function(t){return t.ID})):[]}}),methods:{onSubmitTimeLimitDataClick:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var i,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("timelimit/fetchProducePeriodSave",t.subExpressIDList);case 2:(i=e.sent)&&(n=function(){if(t.TimeLimitData){var e="",n=t.TimeLimitData,r=n.ProductClass,a=n.ProductList,o=n.SchemaList,s=r.FirstLevelID,l=r.SecondLevelID;if(t.allProductClassify&&t.allProductClassify.length>0){var c=t.allProductClassify.find((function(t){return t.ID===s}));if(c){var u=c.children.find((function(t){return t.ID===l}));if(u){var f=u.children,m=[];a.length===f.length?e="全部产品":(a.forEach((function(t){var e=f.find((function(e){return e.ID===t.ID}));e&&m.push(e.ClassName)})),e=m.join("、"))}}}t.$store.commit("timelimit/changeDataList",{ProductClass:r,ID:i,ProductString:e,RecordCount:o.length}),t.onReturnClick()}else t.onReturnClick(!0)},r="edit"===t.setPageType?"编辑成功":"添加成功",t.messageBox.successSingle(r,(function(){return n()}),(function(){return n()})));case 4:case"end":return e.stop()}}),e)})))()},onReturnClick:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?this.$router.replace("/timeLimitList"):this.$router.replace({path:"/timeLimitList",query:{notNeedFetch:!0}})}},mounted:function(){this.TimeLimitData||this.$router.replace("/timeLimitList")}},x=(i("306a"),Object(u.a)(w,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.TimeLimitData?i("section",{staticClass:"mp-erp-time-limit-set-page-wrap"},[i("header",[i("span",[t._v("当前产品：")]),i("span",[t._v(t._s(t.TimeLimitData.ProductClass.FirstLevelName)+" - "+t._s(t.TimeLimitData.ProductClass.SecondLevelName))])]),i("LimitSetContentComp",{attrs:{TimeLimitData:t.TimeLimitData}}),i("footer",[i("normal-btn-full",{attrs:{title:"保存"},nativeOn:{click:function(e){return t.onSubmitTimeLimitDataClick(e)}}}),i("normal-btn",{attrs:{title:"返回"},nativeOn:{click:function(e){return t.onReturnClick(!1)}}})],1)],1):t._e()}),[],!1,null,null,null));e.default=x.exports},"286f":function(t,e,i){"use strict";i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return s})),i("4de4"),i("7db0"),i("4160"),i("caad"),i("d81d"),i("d3b7"),i("6062"),i("2532"),i("3ca3"),i("159b"),i("ddb0");var n=i("5530"),r=i("2909"),a=/^全部/;function o(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ClassName";if(!t||0===t.length)return[];var o=JSON.parse(JSON.stringify(e)),s=Object(r.a)(new Set(t.map((function(t){return t.RegionalID})))),l=Object(r.a)(new Set(t.map((function(t){return t.CityID})))),c=Object(r.a)(new Set(t.map((function(t){return t.CountyID})))),u=o.filter((function(t){return s.includes(t.ID)}));if((u=(u=u.map((function(t){return Object(n.a)({},t,{children:t.children.filter((function(t){return l.includes(t.ID)}))})}))).map((function(t){var e=t.children.map((function(t){var e,r=!0;return t.children.forEach((function(t){c.includes(t.ID)||(r=!1)})),r?r&&(e=["全部".concat(t[i],"区域")]):e=t.children.filter((function(t){return c.includes(t.ID)})),Object(n.a)({},t,{children:e})})),r=!0;(e.forEach((function(t){a.test(t.children[0])||(r=!1)})),r)&&o.find((function(e){return e.ID===t.ID})).children.forEach((function(t){!l.includes(t.ID)&&t.children.length>0&&(r=!1)}));var s=r?["全部".concat(t[i])]:e;return Object(n.a)({},t,{children:s})}))).length===e.length){var f=!0;u.forEach((function(t){a.test(t.children[0])||(f=!1)})),f&&(u="全部区域")}return u}function s(t,e){if(!t||0===t.length)return[];var i=JSON.parse(JSON.stringify(e)),o=Object(r.a)(new Set(t.map((function(t){return t.FirstLevelID})))),s=Object(r.a)(new Set(t.map((function(t){return t.SecondLevelID})))),l=Object(r.a)(new Set(t.map((function(t){return t.ProductID})))),c=i.filter((function(t){return o.includes(t.ID)}));if((c=(c=c.map((function(t){return Object(n.a)({},t,{children:t.children.filter((function(t){return s.includes(t.ID)}))})}))).map((function(t){var e=t.children.map((function(t){var e,i=!0;return t.children.forEach((function(t){l.includes(t.ID)||(i=!1)})),i?i&&(e=["全部".concat(t.ClassName,"产品")]):e=t.children.filter((function(t){return l.includes(t.ID)})),Object(n.a)({},t,{children:e})})),r=!0;(e.forEach((function(t){a.test(t.children[0])||(r=!1)})),r)&&i.find((function(e){return e.ID===t.ID})).children.forEach((function(t){s.includes(t.ID)||(r=!1)}));var o=r?["全部".concat(t.ClassName,"产品")]:e;return Object(n.a)({},t,{children:o})}))).length===e.filter((function(t){return t.children.length>0})).length){var u=!0;c.forEach((function(t){a.test(t.children[0])||(u=!1)})),u&&(c="全部产品")}return c}},"306a":function(t,e,i){"use strict";var n=i("06e5");i.n(n).a},3307:function(t,e,i){"use strict";var n=i("0c68");i.n(n).a},"3f2b":function(t,e,i){"use strict";var n=i("436f");i.n(n).a},"436f":function(t,e,i){},"4ba8":function(t,e,i){"use strict";var n=i("b12f");i.n(n).a},6062:function(t,e,i){"use strict";var n=i("6d61"),r=i("6566");t.exports=n("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),r)},6566:function(t,e,i){"use strict";var n=i("9bf2").f,r=i("7c73"),a=i("e2cc"),o=i("0366"),s=i("19aa"),l=i("2266"),c=i("7dd0"),u=i("2626"),f=i("83ab"),m=i("f183").fastKey,d=i("69f3"),p=d.set,h=d.getterFor;t.exports={getConstructor:function(t,e,i,c){var u=t((function(t,n){s(t,u,e),p(t,{type:e,index:r(null),first:void 0,last:void 0,size:0}),f||(t.size=0),null!=n&&l(n,t[c],t,i)})),d=h(e),v=function(t,e,i){var n,r,a=d(t),o=D(t,e);return o?o.value=i:(a.last=o={index:r=m(e,!0),key:e,value:i,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=o),n&&(n.next=o),f?a.size++:t.size++,"F"!==r&&(a.index[r]=o)),t},D=function(t,e){var i,n=d(t),r=m(e);if("F"!==r)return n.index[r];for(i=n.first;i;i=i.next)if(i.key==e)return i};return a(u.prototype,{clear:function(){for(var t=d(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,f?t.size=0:this.size=0},delete:function(t){var e=this,i=d(e),n=D(e,t);if(n){var r=n.next,a=n.previous;delete i.index[n.index],n.removed=!0,a&&(a.next=r),r&&(r.previous=a),i.first==n&&(i.first=r),i.last==n&&(i.last=a),f?i.size--:e.size--}return!!n},forEach:function(t){for(var e,i=d(this),n=o(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:i.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!D(this,t)}}),a(u.prototype,i?{get:function(t){var e=D(this,t);return e&&e.value},set:function(t,e){return v(this,0===t?0:t,e)}}:{add:function(t){return v(this,t=0===t?0:t,t)}}),f&&n(u.prototype,"size",{get:function(){return d(this).size}}),u},setStrong:function(t,e,i){var n=e+" Iterator",r=h(e),a=h(n);c(t,e,(function(t,e){p(this,{type:n,target:t,state:r(t),kind:e,last:void 0})}),(function(){for(var t=a(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?"keys"==e?{value:i.key,done:!1}:"values"==e?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),i?"entries":"values",!i,!0),u(e)}}},"6d61":function(t,e,i){"use strict";var n=i("23e7"),r=i("da84"),a=i("94ca"),o=i("6eeb"),s=i("f183"),l=i("2266"),c=i("19aa"),u=i("861d"),f=i("d039"),m=i("1c7e"),d=i("d44e"),p=i("7156");t.exports=function(t,e,i){var h=-1!==t.indexOf("Map"),v=-1!==t.indexOf("Weak"),D=h?"set":"add",C=r[t],L=C&&C.prototype,g=C,b={},w=function(t){var e=L[t];o(L,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(v&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!u(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!u(t))&&e.call(this,0===t?0:t)}:function(t,i){return e.call(this,0===t?0:t,i),this})};if(a(t,"function"!=typeof C||!(v||L.forEach&&!f((function(){(new C).entries().next()})))))g=i.getConstructor(e,t,h,D),s.REQUIRED=!0;else if(a(t,!0)){var x=new g,y=x[D](v?{}:-0,1)!=x,_=f((function(){x.has(1)})),I=m((function(t){new C(t)})),P=!v&&f((function(){for(var t=new C,e=5;e--;)t[D](e,e);return!t.has(-0)}));I||((g=e((function(e,i){c(e,g,t);var n=p(new C,e,g);return null!=i&&l(i,n[D],n,h),n}))).prototype=L,L.constructor=g),(_||P)&&(w("delete"),w("has"),h&&w("get")),(P||y)&&w(D),v&&L.clear&&delete L.clear}return b[t]=g,n({global:!0,forced:g!=C},b),d(g,t),v||i.setStrong(g,t,h),g}},"7db5":function(t,e,i){"use strict";var n=i("aead");i.n(n).a},"8e71":function(t,e,i){},"90b7":function(t,e,i){"use strict";var n=i("8e71");i.n(n).a},aead:function(t,e,i){},b12f:function(t,e,i){},bb2f:function(t,e,i){var n=i("d039");t.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},e668:function(t,e,i){"use strict";var n=i("24de");i.n(n).a},edeb:function(t,e,i){"use strict";var n={props:{title:{type:String,default:"关闭"}}},r=(i("e668"),i("2877")),a=Object(r.a)(n,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"normal-btn"},[t._v(t._s(t.title))])}),[],!1,null,null,null);e.a=a.exports},f183:function(t,e,i){var n=i("d012"),r=i("861d"),a=i("5135"),o=i("9bf2").f,s=i("90e3"),l=i("bb2f"),c=s("meta"),u=0,f=Object.isExtensible||function(){return!0},m=function(t){o(t,c,{value:{objectID:"O"+ ++u,weakData:{}}})},d=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,c)){if(!f(t))return"F";if(!e)return"E";m(t)}return t[c].objectID},getWeakData:function(t,e){if(!a(t,c)){if(!f(t))return!0;if(!e)return!1;m(t)}return t[c].weakData},onFreeze:function(t){return l&&d.REQUIRED&&f(t)&&!a(t,c)&&m(t),t}};n[c]=!0}}]);