(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-11f9dbb0"],{3692:function(t,e,i){"use strict";var o=i("394e");i.n(o).a},"394e":function(t,e,i){},"50ed":function(t,e,i){"use strict";var o=i("9f42");i.n(o).a},"9f42":function(t,e,i){},b78c:function(t,e,i){"use strict";i.r(e);var o=(i("99af"),i("4de4"),i("7db0"),i("a15b"),i("d81d"),i("b0c0"),i("ac1f"),i("5319"),i("96cf"),i("1da1")),r=i("5530"),n=i("2f62"),a=i("2af0"),s=i("3eca"),c={props:{dataList:{default:function(){return[]},type:Array},loading:{type:Boolean,default:!1},PropertyList:{default:function(){return[]},type:Array}},computed:{localTableData:function(){var t=this;return this.dataList&&Array.isArray(this.dataList)&&0!==this.dataList.length?this.dataList.map((function(e){return Object(r.a)({},e,{PriorityText:"".concat(e.Priority,"级"),FilterTypeText:1===e.Constraint.FilterType?"满足所有条件":"满足任一条件",FileInfoText:t.getFileInfoText(e.FileList),conditionText:t.getConditionText(e.Constraint.ItemList)})})):[]}},mixins:[a.a],methods:{setHeight:function(){var t=this.getHeight(".mp-erp-product-list-page-product-file-list-page-wrap > header",110);this.h=t},onEditClick:function(t){this.$emit("edit",t)},onRemoveClick:function(t){this.$emit("remove",t)},getFileInfoText:function(t){return Array.isArray(t)&&0!==t.length?t.map((function(t){var e=t.File,i=t.IsRequired;return"".concat(e.Name,"（").concat(i?"必须上传":"可不上传","）")})).join("、"):""},getConditionText:function(t){return s.c.getPropertyConditionText(t,this.PropertyList)||"无"}}},l=(i("3692"),i("2877")),u={data:function(){return{ProductID:"",PartID:"",ProductName:"",titleType:"",curEditData:null,loading:!1}},components:{FileTable:Object(l.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-table",{key:"mp-erp-product-module-factory-list-page-file-table-comp-wrap",staticClass:"mp-erp-product-module-factory-list-page-file-table-comp-wrap",staticStyle:{width:"100%"},attrs:{"max-height":t.h,height:t.h,stripe:"",border:"",data:t.localTableData,fit:""}},[i("el-table-column",{attrs:{prop:"conditionText",label:"条件","min-width":"260"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tooltip",{attrs:{effect:"light","popper-class":"common-property-condition-text-tips-box"}},[i("div",{attrs:{slot:"content"},slot:"content"},t._l(e.row.conditionText,(function(o,r){return i("p",{key:o.name+"tips"+r},[r>0?i("span",{staticClass:"type"},[t._v(t._s(1===e.row.Constraint.FilterType?"且":"或"))]):t._e(),i("span",{staticClass:"name"},[t._v(t._s(o.name))]),i("span",{staticClass:"is-origin"},[t._v(t._s(o.operator))]),i("span",{staticClass:"val"},[t._v(t._s(o.val))]),r===e.row.conditionText.length-1?i("span",{staticStyle:{"margin-left":"2px"}},[t._v(" 。")]):i("span",{staticStyle:{"margin-left":"2px"}},[t._v("；")])])})),0),i("div",{staticClass:"common-property-condition-text-content-box"},t._l(e.row.conditionText,(function(o,r){return i("p",{key:o.name+"content"+r},[r>0?i("span",{staticClass:"type"},[t._v(t._s(1===e.row.Constraint.FilterType?"且":"或"))]):t._e(),i("span",[t._v(t._s(o.name))]),i("span",{staticClass:"is-origin"},[t._v(t._s(o.operator))]),i("span",[t._v(t._s(o.val))])])})),0)])]}}])}),i("el-table-column",{attrs:{prop:"FilterTypeText",label:"条件类型",width:"180","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"PriorityText",label:"优先级",width:"140","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"FileInfoText",label:"文件类目",width:"420","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{label:"操作",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{staticClass:"menu-list"},[i("span",{on:{click:function(i){return t.onEditClick(e.row)}}},[i("i"),t._v("编辑")]),i("span",{on:{click:function(i){return t.onRemoveClick(e.row,e.$index)}}},[i("i"),t._v("删除")])])}}])}),i("div",{attrs:{slot:"empty"},slot:"empty"},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}]},[t._v("暂无数据")])])],1)}),[],!1,null,null,null).exports},computed:Object(r.a)({},Object(n.e)("productManage",["ProductManageList","ProductModuleKeyIDList","ProductFileList","ProductFilePropertyList"]),{curProduct:function(){var t=this;return this.ProductID?this.ProductManageList.find((function(e){return e.ID===t.ProductID})):null},curPart:function(){var t=this;return this.PartID&&this.curProduct?this.curProduct.PartList.find((function(e){return e.ID===t.PartID})):null},localTableData:function(){var t=this;return this.ProductFileList&&0!==this.ProductFileList.length&&this.ProductFilePropertyList&&0!==this.ProductFilePropertyList.length?JSON.parse(JSON.stringify(this.ProductFileList)).map((function(e){var i=e.Constraint;return i.ItemList=i.ItemList.map((function(e){var i=s.c.getPerfectPropertyByImperfectProperty(e.Property,t.ProductFilePropertyList);return Object(r.a)({},e,{Property:i})})).filter((function(t){return t.Property})),Object(r.a)({},e,{Constraint:i})})):[]}}),methods:{getPositionID:function(){if(this.$route.params){var t=this.$route.params,e=t.ProductID,i=t.PartID,o=t.name,r=t.type;e&&i&&o&&r?(this.ProductID=e,this.PartID="null"!==i?i:"",this.ProductName=o,this.titleType=r,this.getProductOrderData(),this.getPropertyList()):this.onGoBackClick()}else this.onGoBackClick()},onFileSaveClick:function(t){this.$store.commit("productManage/setCurEditFileData",t);var e="/ProductFileSet/".concat(this.ProductID,"/").concat(this.PartID?this.PartID:"null","/").concat(this.ProductName,"/").concat(this.titleType,"/").concat(Date.now());this.$router.push(e)},getProductOrderData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["File"];return Object(o.a)(regeneratorRuntime.mark((function i(){var o,r,n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=t.PartID?t.PartID:t.ProductID,r=t.$utils.getIDFromListByNames(e,t.ProductModuleKeyIDList),n={ID:o,List:r},t.loading=!0,i.next=6,t.$store.dispatch("productManage/getProductFileList",n);case 6:t.loading=!1;case 7:case"end":return i.stop()}}),i)})))()},getPropertyList:function(){this.$store.dispatch("productManage/getProductFilePropertyList",this.ProductID)},onGoBackClick:function(){this.$router.replace("/ProductManageList")},onRemove:function(t,e){var i=this,o=t.FileList.map((function(t){return t.File.Name})).join("、"),r=t.FileList.length>2?"其中文件类目数量共 [ ".concat(t.FileList.length," ]条"):"文件类目：[ ".concat(o," ]");this.messageBox.warnCancelBox("确定删除该条文件类目设置吗",r,(function(){i.$store.dispatch("productManage/getProductFilePropertyRemove",[t.ID,e])}))},onEdit:function(t){this.onFileSaveClick(t)}},mounted:function(){this.getPositionID()}},p=(i("50ed"),Object(l.a)(u,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"mp-erp-product-list-page-product-file-list-page-wrap"},[i("header",[i("span",[t._v("当前"+t._s(t.titleType)+"：")]),i("span",[t._v(t._s(t.ProductName))]),i("p",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.onFileSaveClick(null)}}},[t._v("+添加关联")])],1)]),i("main",[i("FileTable",{attrs:{dataList:t.localTableData,loading:t.loading,PropertyList:t.ProductFilePropertyList},on:{remove:t.onRemove,edit:t.onEdit}})],1),i("footer",[i("el-button",{on:{click:t.onGoBackClick}},[i("i",{staticClass:"el-icon-d-arrow-left"}),t._v(" 返回")])],1)])}),[],!1,null,null,null));e.default=p.exports}}]);