(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-433b5258"],{2298:function(t,e,a){},"3b2b":function(t,e,a){"use strict";var i=a("f549");a.n(i).a},"3c0c":function(t,e,a){"use strict";var i=a("9d1e");a.n(i).a},4989:function(t,e,a){},"5c16":function(t,e,a){"use strict";var i=a("2298");a.n(i).a},7397:function(t,e,a){"use strict";a.r(e);var i=a("5530"),n=a("57d5"),s=a("2f62"),o=(a("99af"),a("7db0"),a("a15b"),a("d81d"),a("2387")),r=(a("96cf"),a("1da1")),c=a("ad32"),u=a("7775"),l={props:{visible:{type:Boolean,default:!1},curData:{type:Object,default:null},ProductID:{type:String,default:""}},components:{CommonDialogComp:c.a},data:function(){return{title:"添加部件",ruleForm:null,isEdit:!1,rules:{Name:[{required:!0,message:"请输入部件名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"},{pattern:u.f,message:"名称仅支持中文、英文(全角/半角)、+-_(全角/半角)、数字等",trigger:"blur"}],UseTimes:[{validator:this.checkUseTimes,trigger:"change"}]}}},methods:{onSubmit:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.ruleForm.validate().catch((function(){}));case 2:e.sent&&t.$emit("submit",t.ruleForm);case 4:case"end":return e.stop()}}),e)})))()},onCancle:function(){this.$emit("update:visible",!1)},onOpen:function(){this.$nextTick(this.initEditData)},onClosed:function(){this.ruleForm=null,this.isEdit=!1},initEditData:function(){this.title=this.curData?"编辑部件":"添加部件",this.isEdit=!!this.curData;var t={ID:"",Name:"",UseTimes:{MinValue:"",MaxValue:""},ProductID:this.ProductID};if(this.isEdit){var e=this.curData,a=e.ID,n=e.Name,s=e.UseTimes;t.ID=a,t.Name=n,t.UseTimes=Object(i.a)({},s)}this.ruleForm=t},checkUseTimes:function(t,e,a){if(e){var i=e.MinValue,n=e.MaxValue;if(!i&&0!==i||!n&&0!==n)a(new Error("请填写和补充最大最小值"));else if(this.$utils.isPositiveInteger(i,!1,!0))if(this.$utils.isPositiveInteger(n))if(0!==i||0!==n)if(i<0||n<0)a(new Error("输入值不能为负，最大值不可设为-1"));else if(n<i)a(new Error("最大值不能小于最小值"));else{if(this.isEdit&&this.curData&&this.curData.UseTimes.MinValue>0&&this.curData.UseTimes.MaxValue>1){if(1===n&&1===i)return void a(new Error("1至多次及多至多次均不能改为1至1次"));if(0===i&&n>1)return void a(new Error("1至多次及多至多次均不能改为0至多次"))}a()}else a(new Error("最大最小值不能同时为0"));else a(new Error("最大值应为数字类型且必须为正整数"));else a(new Error("最小值应为数字类型且不小于0"))}else a(new Error("未获取到填写数值"))}}},m=(a("3b2b"),a("2877")),d=Object(m.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CommonDialogComp",{staticClass:"mp-erp-comps-pruduct-module-part-save-dialog-comp-wrap",attrs:{width:"800px",top:"13vh",title:t.title,visible:t.visible},on:{"update:visible":function(e){t.visible=e},submit:t.onSubmit,cancle:t.onCancle,open:t.onOpen,closed:t.onClosed}},[t.ruleForm?a("el-form",{ref:"ruleForm",staticClass:"file-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"188px",size:"small"}},[a("el-form-item",{key:"FileName",attrs:{label:"名称：",prop:"Name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入部件名称",maxlength:"10","show-word-limit":""},model:{value:t.ruleForm.Name,callback:function(e){t.$set(t.ruleForm,"Name","string"==typeof e?e.trim():e)},expression:"ruleForm.Name"}})],1),a("el-form-item",{key:"GroupUseTimes",staticClass:"use-times-box",attrs:{label:"使用次数：",prop:"UseTimes"}},[a("el-input",{staticStyle:{width:"110px"},attrs:{disabled:t.isEdit&&1===t.curData.UseTimes.MinValue&&1===t.curData.UseTimes.MaxValue,maxlength:"9"},model:{value:t.ruleForm.UseTimes.MinValue,callback:function(e){t.$set(t.ruleForm.UseTimes,"MinValue",t._n("string"==typeof e?e.trim():e))},expression:"ruleForm.UseTimes.MinValue"}}),a("span",[t._v("≤ 次数 ≤")]),a("el-input",{staticStyle:{width:"110px"},attrs:{disabled:t.isEdit&&1===t.curData.UseTimes.MinValue&&1===t.curData.UseTimes.MaxValue,maxlength:"9"},model:{value:t.ruleForm.UseTimes.MaxValue,callback:function(e){t.$set(t.ruleForm.UseTimes,"MaxValue",t._n("string"==typeof e?e.trim():e))},expression:"ruleForm.UseTimes.MaxValue"}})],1),a("p",{staticClass:"remark"},[t._v("编辑时，需要注意以下几点：")]),a("p",{staticClass:"tips-box"},[a("i",{staticClass:"el-icon-warning"}),t._v(" 使用次数1至1次时：使用次数不能更改，影响很大。")]),a("p",{staticClass:"tips-box"},[a("i",{staticClass:"el-icon-warning"}),t._v(" 1至多次：不能改为1至1次，影响很大。改为0至多次，有些影响。")]),a("p",{staticClass:"tips-box"},[a("i",{staticClass:"el-icon-warning"}),t._v(" 多至多次：不能改为1至1次，影响很大。改为0至多次，有些影响。")])],1):t._e()],1)}),[],!1,null,null,null).exports,p=(a("4de4"),{props:{visible:{type:Boolean,default:!1},curData:{type:Object,default:null},itemData:{type:Object,default:null}},components:{CommonDialogComp:c.a},computed:Object(i.a)({},Object(s.e)("productManage",["ProductElementTypeList"]),{selectedElementIDs:function(){return this.List.map((function(t){return t.Number})).filter((function(t){return t}))}}),data:function(){return{PartID:"",ElementData:{PositionID:"",List:[]},loading:!1,List:[]}},methods:{onSubmit:function(){var t={ProductID:this.itemData.ID,PartID:this.PartID,List:this.List};this.$emit("submit",t)},onCancle:function(){this.$emit("update:visible",!1)},onOpen:function(){this.$nextTick(this.initEditData)},onClosed:function(){this.PartID="",this.List=[]},initEditData:function(){var t=this;this.curData&&(this.PartID=this.curData.ID);var e=this.PartID||this.itemData.ID;this.ElementData.PositionID!==e&&(this.ElementData.PositionID=e,this.getElementList()),this.List=this.ProductElementTypeList.map((function(e){var a="",i=(t.curData?t.curData.TypeList:t.itemData.TypeList).find((function(t){return t.First===e.ID}));return i&&(a=i.Second),{Second:a,First:e.ID,label:e.Name}}))},getElementList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.api.getElementList({positionID:t.ElementData.PositionID},!0).catch((function(){}));case 3:(a=e.sent)&&200===a.status&&1e3===a.data.Status&&(t.ElementData.List=a.data.Data.filter((function(t){return 1===t.Type&&!t.Group}))),t.loading=!1;case 6:case"end":return e.stop()}}),e)})))()}}}),h=(a("c06b"),Object(m.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.itemData?a("CommonDialogComp",{staticClass:"mp-erp-comps-pruduct-module-product-element-map-set-dialog-comp-wrap",attrs:{width:"650px",top:"15vh",title:"设置元素",visible:t.visible,loading:t.loading},on:{"update:visible":function(e){t.visible=e},submit:t.onSubmit,cancle:t.onCancle,open:t.onOpen,closed:t.onClosed}},[t.loading?t._e():a("ul",{staticClass:"list"},t._l(t.List,(function(e){return a("li",{key:e.First,staticClass:"item"},[a("span",{staticClass:"label"},[t._v(t._s(e.label)+"：")]),a("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:e.Second,callback:function(a){t.$set(e,"Second",a)},expression:"it.Second"}},t._l(t.ElementData.List,(function(e){return a("el-option",{key:e.ID,attrs:{disabled:t.selectedElementIDs.includes(e.ID),label:e.Name,value:e.ID}})})),1)],1)})),0)]):t._e()}),[],!1,null,null,null)).exports,f={props:{itemData:{type:Object,default:null}},components:{TipsSpanButton:o.a,PartSaveDialog:d,ProductMapSetDialog:h},computed:Object(i.a)({},Object(s.c)("common",["twoLevelsProductClassify"]),{helpOrderChecked:{get:function(){return!!this.itemData&&this.itemData.AllowValetOrder},set:function(){this.$store.dispatch("productManage/getOrderStatusChange",["ValetOrderStatus",this.itemData.ID])}},customOrderChecked:{get:function(){return!!this.itemData&&this.itemData.AllowCustomOrder},set:function(){this.$store.dispatch("productManage/getOrderStatusChange",["CustomOrderStatus",this.itemData.ID])}},ClassifyText:function(){if(!this.itemData)return"";var t=this.itemData.ClassifyList;return t&&Array.isArray(t)&&0!==t.length?t.map((function(t){return"".concat(t.FirstLevel.Name,"-").concat(t.SecondLevel.Name)})).join("，"):""}}),data:function(){return{extend:!1,visible:!1,curPartData:null,mapVisible:!1}},methods:{onProductSaveClick:function(){this.$store.commit("productManage/setCurEditData",this.itemData),this.$router.push("/ProductDataSave/".concat(Date.now()))},onRemoveClick:function(){var t=this;this.messageBox.warnCancelBox("确定删除该产品吗","产品名称：".concat(this.itemData.Name),(function(){t.$store.dispatch("productManage/getProductRemove",t.itemData.ID)}))},setCommonPathJump:function(t,e){var a=this.itemData,i=a.Name,n="",s=a.ClassifyList.find((function(t){return 1===t.Type}));s&&(n="".concat(s.FirstLevel.Name)),n+="-".concat(i);var o=e?e.ID:this.itemData.ID;n+=e?"：".concat(e.Name):"";var r=e?"部件":"产品";if("ProductElementSet"!==t)if("ProductDisplaySort"!==t){var c=e?e.ID:null;this.$router.push("/".concat(t,"/").concat(this.itemData.ID,"/").concat(c,"/").concat(n,"/").concat(r,"/").concat(Date.now()))}else{var u=e?e.ID:null,l=e?e.MaterialDisplayName:this.itemData.MaterialDisplayName;this.$router.push("/".concat(t,"/").concat(this.itemData.ID,"/").concat(u,"/").concat(n,"/").concat(r,"/").concat(l,"/").concat(Date.now()))}else this.$router.push("/".concat(t,"/").concat(o,"/").concat(n,"/").concat(r,"/").concat(Date.now()))},onElementSaveClick:function(t){this.setCommonPathJump("ProductElementSet",t)},onProductSizeMaterialSetClick:function(t){this.setCommonPathJump("ProductSizeMaterialSet",t)},onProductCraftSetClick:function(t){this.setCommonPathJump("ProductCraftSet",t)},onProductDisplaySortSetClick:function(t){this.setCommonPathJump("ProductDisplaySort",t)},onProductFactorySetClick:function(){this.setCommonPathJump("ProductFactorySet")},onPartSaveClick:function(t){this.curPartData=t,this.visible=!0},onPartSaveSubmit:function(t){var e=this;if(this.itemData.PartList.find((function(e){return e.Name===t.Name&&e.ID!==t.ID})))this.messageBox.failSingleError("保存失败","部件名称不能与其它部件名称重复");else{this.$store.dispatch("productManage/getProductPartSave",[t,function(){e.visible=!1}])}},onPartRemoveClick:function(t){var e=this,a=t.ID,i=t.ProductID,n=t.Name;this.messageBox.warnCancelBox("确定删除该部件吗","部件名称：".concat(n),(function(){e.$store.dispatch("productManage/getProductPartRemove",[a,i])}))},onElementMapSetClick:function(t){this.curPartData=t,this.mapVisible=!0},onMapSetSubmit:function(t){var e=this;this.$store.dispatch("productManage/getProductBindElementType",[t,function(){e.mapVisible=!1}])}}},v=(a("5c16"),Object(m.a)(f,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.itemData?a("section",{staticClass:"mp-erp-product-manage-table-item-comp-wrap",class:t.extend?"extend":""},[a("header",[a("div",{staticClass:"title-box"},[a("span",{staticClass:"name",attrs:{title:t.itemData.Name}},[t._v(t._s(t.itemData.Name))]),a("span",{staticClass:"show-name",attrs:{title:t.itemData.ShowName}},[t._v(t._s(t.itemData.ShowName))])]),a("div",{staticClass:"classify-box"},[a("span",{attrs:{title:t.ClassifyText}},[t._v(t._s(t.ClassifyText))])]),a("div",{staticClass:"order-ctrl"},[a("el-checkbox",{model:{value:t.helpOrderChecked,callback:function(e){t.helpOrderChecked=e},expression:"helpOrderChecked"}},[t._v("可代客下单")]),a("el-checkbox",{model:{value:t.customOrderChecked,callback:function(e){t.customOrderChecked=e},expression:"customOrderChecked"}},[t._v("可自助上传")])],1),a("div",{staticClass:"text-menu-box"},[a("TipsSpanButton",{attrs:{text:"界面元素"},nativeOn:{click:function(e){return t.onElementSaveClick(null)}}}),a("TipsSpanButton",{attrs:{text:"尺寸物料"},nativeOn:{click:function(e){return t.onProductSizeMaterialSetClick(null)}}}),a("TipsSpanButton",{attrs:{text:"工艺"},nativeOn:{click:function(e){return t.onProductCraftSetClick(null)}}}),a("TipsSpanButton",{attrs:{text:"设置元素"},nativeOn:{click:function(e){return t.onElementMapSetClick(null)}}}),a("TipsSpanButton",{staticStyle:{"margin-right":"40px"},attrs:{text:"显示顺序"},nativeOn:{click:function(e){return t.onProductDisplaySortSetClick(null)}}}),a("TipsSpanButton",{attrs:{text:"工厂"},nativeOn:{click:function(e){return t.onProductFactorySetClick(e)}}}),a("TipsSpanButton",{attrs:{text:"文件"},nativeOn:{click:function(e){return t.setCommonPathJump("ProductFileList")}}}),a("TipsSpanButton",{attrs:{text:"公式"},nativeOn:{click:function(e){return t.setCommonPathJump("ProductFormulaList")}}}),a("TipsSpanButton",{attrs:{text:"交互"},nativeOn:{click:function(e){return t.setCommonPathJump("ProductInteractionList")}}}),a("TipsSpanButton",{attrs:{text:"文件名设置"},nativeOn:{click:function(e){return t.setCommonPathJump("ProductFileNameSet")}}}),a("TipsSpanButton",{attrs:{text:"库存"},nativeOn:{click:function(e){return t.setCommonPathJump("ProductStockList")}}})],1),a("div",{staticClass:"img-menu-box"},[a("span",{on:{click:function(e){return t.onPartSaveClick(null)}}},[a("i"),t._v("添加部件 ")]),a("span",{on:{click:t.onProductSaveClick}},[a("i"),t._v("编辑 ")]),a("span",{on:{click:t.onRemoveClick}},[a("i"),t._v("删除 ")])]),a("div",{staticClass:"extend-box",class:t.itemData.PartList&&t.itemData.PartList.length>0?"":"disabled",on:{click:function(e){t.extend=!t.extend}}},[t.extend?a("span",[t._v("隐藏")]):a("span",[t._v("展开")]),t.extend?a("i",{staticClass:"el-icon-caret-top"}):a("i",{staticClass:"el-icon-caret-bottom"})])]),a("ul",t._l(t.itemData.PartList,(function(e){return a("li",{key:e.PartID},[a("div",[a("span",{attrs:{title:e.Name}},[t._v(t._s(e.Name))])]),a("div",[a("TipsSpanButton",{attrs:{text:"界面元素"},nativeOn:{click:function(a){return t.onElementSaveClick(e)}}}),a("TipsSpanButton",{attrs:{text:"尺寸物料"},nativeOn:{click:function(a){return t.onProductSizeMaterialSetClick(e)}}}),a("TipsSpanButton",{attrs:{text:"工艺"},nativeOn:{click:function(a){return t.onProductCraftSetClick(e)}}}),a("TipsSpanButton",{attrs:{text:"设置元素"},nativeOn:{click:function(a){return t.onElementMapSetClick(e)}}}),a("TipsSpanButton",{attrs:{text:"显示顺序"},nativeOn:{click:function(a){return t.onProductDisplaySortSetClick(e)}}})],1),a("div",[a("TipsSpanButton",{attrs:{text:"编辑"},nativeOn:{click:function(a){return t.onPartSaveClick(e)}}}),a("TipsSpanButton",{attrs:{text:"删除",isRed:""},nativeOn:{click:function(a){return t.onPartRemoveClick(e)}}})],1)])})),0),a("PartSaveDialog",{attrs:{visible:t.visible,curData:t.curPartData,ProductID:t.itemData.ID},on:{"update:visible":function(e){t.visible=e},submit:t.onPartSaveSubmit}}),a("ProductMapSetDialog",{attrs:{visible:t.mapVisible,curData:t.curPartData,itemData:t.itemData},on:{"update:visible":function(e){t.mapVisible=e},submit:t.onMapSetSubmit}})],1):t._e()}),[],!1,null,null,null)).exports,C={props:{listData:{type:Array,default:function(){return[]}}},components:{ProductTableItemComp:v},computed:Object(i.a)({},Object(s.e)("productManage",["isTableDataLoading"]))},D=(a("3c0c"),Object(m.a)(C,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("article",{staticClass:"mp-erp-product-manage-table-comp-wrap"},[i("div",{staticClass:"content"},[t._m(0),t.isTableDataLoading||0!==t.listData.length?t._e():i("div",{staticClass:"empty-box"},[i("img",{attrs:{src:a("5731"),alt:""}}),i("p",{staticClass:"is-font-size-12 is-gray"},[t._v("暂无产品")])]),t._l(t.listData,(function(t){return i("ProductTableItemComp",{key:t.ProductID,attrs:{itemData:t}})}))],2)])}),[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"list-header"},[a("span",{staticClass:"name"},[t._v("内部名称")]),a("span",{staticClass:"show-name"},[t._v("显示名称")]),a("span",{staticClass:"classify"},[t._v("所属分类")]),a("span",{staticClass:"order-ctrl"},[t._v("下单方式")]),a("span",{staticClass:"setup"},[t._v("设置")]),a("span",{staticClass:"operate"},[t._v("操作")])])}],!1,null,null,null)).exports,g=a("8aa1"),P=a("ebb2"),b={name:"ProductManageList",components:{SearchInputComp:n.a,ProductTableComp:D,Count:g.a,NewProductClassifySelectComp:P.a},computed:Object(i.a)({},Object(s.e)("productManage",["condition4ProductManageList","ProductManageList","ProductManageListNumber","isTableDataLoading"]),{},Object(s.e)("common",["OperatorKeyValueList"]),{ProductClass:{get:function(){return this.condition4ProductManageList.ProductClass},set:function(t){this.$store.commit("productManage/setCondition4ProductManageList",[["ProductClass",""],t]),this.getManageProductList()}}}),data:function(){return{}},methods:{getManageProductList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$store.dispatch("productManage/getManageProductList",t)},setObjForListData:function(t){this.$store.commit("productManage/setCondition4ProductManageList",t)},clearCondition:function(){this.$store.commit("productManage/clearCondition4ProductManageList")},goToClassifyPage:function(){this.$router.push("/ProductClassifyManage")},handlePageChange:function(t){this.getManageProductList(t)},onProductSaveClick:function(t){this.$store.commit("productManage/setCurEditData",t),this.$router.push("/ProductDataSave/".concat(Date.now()))}},mounted:function(){this.getManageProductList()}},S=(a("8aa6"),Object(m.a)(b,(function(){var t=this,e=this,a=e.$createElement,i=e._self._c||a;return i("section",{staticClass:"mp-erp-product-manage-list-page-wrap"},[i("header",[i("div",{staticClass:"left"},[i("el-button",{staticClass:"mp-common-btn-styles",attrs:{type:"primary"},on:{click:function(t){return e.onProductSaveClick(null)}}},[e._v("添加产品")]),i("el-button",{staticClass:"mp-common-btn-styles",attrs:{type:"primary"},on:{click:e.goToClassifyPage}},[e._v("管理产品分类")]),i("NewProductClassifySelectComp",{model:{value:e.ProductClass,callback:function(t){e.ProductClass=t},expression:"ProductClass"}})],1),i("search-input-comp",{staticClass:"search-section",attrs:{typeList:[["KeyWords",""]],title:"",placeholder:"请输入产品内部名称",requestFunc:e.getManageProductList,changePropsFunc:e.setObjForListData,word:e.condition4ProductManageList.KeyWords,searchWatchKey:e.ProductManageList,resetWords:"清空所有筛选条件"},on:{reset:function(){return t.clearCondition()}}})],1),i("main",[i("ProductTableComp",{attrs:{listData:e.ProductManageList}})],1),i("footer",[i("Count",{attrs:{watchPage:e.condition4ProductManageList.Page,handlePageChange:e.handlePageChange,count:e.ProductManageListNumber,center:"",pageSize:e.condition4ProductManageList.PageSize}})],1)])}),[],!1,null,null,null));e.default=S.exports},"8aa6":function(t,e,a){"use strict";var i=a("9a90");a.n(i).a},"9a90":function(t,e,a){},"9d1e":function(t,e,a){},c06b:function(t,e,a){"use strict";var i=a("4989");a.n(i).a},f549:function(t,e,a){}}]);