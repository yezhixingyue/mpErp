(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d996cc4a"],{"55a5":function(t,e,o){},"5b1e":function(t,e,o){"use strict";o.r(e);var r=(o("99af"),o("4de4"),o("7db0"),o("d81d"),o("b0c0"),o("ac1f"),o("5319"),o("96cf"),o("1da1")),a=o("5530"),n=o("2f62"),i=(o("a15b"),o("2af0")),c=o("3eca"),s={props:{dataList:{default:function(){return[]},type:Array},loading:{type:Boolean,default:!1},PropertyList:{default:function(){return[]},type:Array}},computed:{localTableData:function(){var t=this;return this.dataList&&Array.isArray(this.dataList)&&0!==this.dataList.length?this.dataList.map((function(e){return Object(a.a)({},e,{PriorityText:"".concat(e.Priority,"级"),FilterTypeText:1===e.Constraint.FilterType?"满足所有条件":"满足任一条件",defaultFactoryName:t.getDefaultFactory(e.FactoryList),unDelaultFactoryListName:t.getUnDefaultFactory(e.FactoryList),conditionText:t.getConditionText(e.Constraint.ItemList)})})):[]}},mixins:[i.a],methods:{setHeight:function(){var t=this.getHeight(".mp-erp-product-list-page-product-factory-set-comp-wrap > header",110);this.h=t},onEditClick:function(t){this.$emit("edit",t)},onRemoveClick:function(t){this.$emit("remove",t)},getDefaultFactory:function(t){var e=t.find((function(t){return t.IsDefault}));return e?e.Factory.FactoryName:""},getUnDefaultFactory:function(t){return t.filter((function(t){return!t.IsDefault})).map((function(t){return t.Factory.FactoryName})).join("、")},getConditionText:function(t){return c.c.getPropertyConditionText(t,this.PropertyList)||"无"}}},l=(o("a622"),o("2877")),u={data:function(){return{ProductID:"",PartID:"",ProductName:"",titleType:"",curEditData:null,loading:!1}},components:{FactoryTable:Object(l.a)(s,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-table",{key:"mp-erp-product-module-factory-list-page-factory-table-comp-wrap",staticClass:"mp-erp-product-module-factory-list-page-factory-table-comp-wrap",staticStyle:{width:"100%"},attrs:{"max-height":t.h,height:t.h,stripe:"",border:"",data:t.localTableData,fit:""}},[o("el-table-column",{attrs:{prop:"conditionText",label:"条件","min-width":"260"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tooltip",{attrs:{effect:"light","popper-class":"common-property-condition-text-tips-box"}},[o("div",{attrs:{slot:"content"},slot:"content"},t._l(e.row.conditionText,(function(r,a){return o("p",{key:r.name+"tips"+a},[a>0?o("span",{staticClass:"type"},[t._v(t._s(1===e.row.Constraint.FilterType?"且":"或"))]):t._e(),o("span",{staticClass:"name"},[t._v(t._s(r.name))]),o("span",{staticClass:"is-origin"},[t._v(t._s(r.operator))]),o("span",{staticClass:"val"},[t._v(t._s(r.val))]),a===e.row.conditionText.length-1?o("span",{staticStyle:{"margin-left":"2px"}},[t._v(" 。")]):o("span",{staticStyle:{"margin-left":"2px"}},[t._v("；")])])})),0),o("div",{staticClass:"common-property-condition-text-content-box"},t._l(e.row.conditionText,(function(r,a){return o("p",{key:r.name+"content"+a},[a>0?o("span",{staticClass:"type"},[t._v(t._s(1===e.row.Constraint.FilterType?"且":"或"))]):t._e(),o("span",[t._v(t._s(r.name))]),o("span",{staticClass:"is-origin"},[t._v(t._s(r.operator))]),o("span",[t._v(t._s(r.val))])])})),0)])]}}])}),o("el-table-column",{attrs:{prop:"FilterTypeText",label:"条件类型",width:"180","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"PriorityText",label:"优先级",width:"140","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"defaultFactoryName",label:"默认生产工厂",width:"180","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{prop:"unDelaultFactoryListName",label:"可选生产工厂",width:"320","show-overflow-tooltip":""}}),o("el-table-column",{attrs:{label:"操作",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return o("div",{staticClass:"menu-list"},[o("span",{on:{click:function(o){return t.onEditClick(e.row)}}},[o("i"),t._v("编辑")]),o("span",{on:{click:function(o){return t.onRemoveClick(e.row,e.$index)}}},[o("i"),t._v("删除")])])}}])}),o("div",{attrs:{slot:"empty"},slot:"empty"},[o("span",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}]},[t._v("暂无数据")])])],1)}),[],!1,null,null,null).exports},computed:Object(a.a)({},Object(n.e)("productManage",["ProductManageList","ProductModuleKeyIDList","ProductFactoryList","ProductFactoryPropertyList"]),{curProduct:function(){var t=this;return this.ProductID?this.ProductManageList.find((function(e){return e.ID===t.ProductID})):null},curPart:function(){var t=this;return this.PartID&&this.curProduct?this.curProduct.PartList.find((function(e){return e.ID===t.PartID})):null},localTableData:function(){var t=this;return this.ProductFactoryList&&0!==this.ProductFactoryList.length&&this.ProductFactoryPropertyList&&0!==this.ProductFactoryPropertyList.length?JSON.parse(JSON.stringify(this.ProductFactoryList)).map((function(e){var o=e.Constraint;return o.ItemList=o.ItemList.map((function(e){var o=c.c.getPerfectPropertyByImperfectProperty(e.Property,t.ProductFactoryPropertyList);return Object(a.a)({},e,{Property:o})})).filter((function(t){return t.Property})),Object(a.a)({},e,{Constraint:o})})):[]}}),methods:{getPositionID:function(){if(this.$route.params){var t=this.$route.params,e=t.ProductID,o=t.PartID,r=t.name,a=t.type;e&&o&&r&&a?(this.ProductID=e,this.PartID="null"!==o?o:"",this.ProductName=r,this.titleType=a,this.getProductOrderData(),this.getPropertyList()):this.onGoBackClick()}else this.onGoBackClick()},onFactorySaveClick:function(t){this.$store.commit("productManage/setCurEditFactoryData",t);var e="/ProductFactoryAdd/".concat(this.ProductID,"/").concat(this.PartID?this.PartID:"null","/").concat(this.ProductName,"/").concat(this.titleType,"/").concat(Date.now());this.$router.push(e)},getProductOrderData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["Factory"];return Object(r.a)(regeneratorRuntime.mark((function o(){var r,a,n;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r=t.PartID?t.PartID:t.ProductID,a=t.$utils.getIDFromListByNames(e,t.ProductModuleKeyIDList),n={ID:r,List:a},t.loading=!0,o.next=6,t.$store.dispatch("productManage/getProductFactoryList",n);case 6:t.loading=!1;case 7:case"end":return o.stop()}}),o)})))()},getPropertyList:function(){this.$store.dispatch("productManage/getProductFactoryPropertyList",this.ProductID)},onGoBackClick:function(){this.$router.replace("/ProductManageList")},onRemove:function(t,e){var o=this;this.messageBox.warnCancelBox("确定删除该条设置吗","默认工厂：[ ".concat(t.defaultFactoryName," ]"),(function(){o.$store.dispatch("productManage/getProductFactoryPropertyRemove",[t.ID,e])}))},onEdit:function(t){this.onFactorySaveClick(t)}},mounted:function(){this.getPositionID()}},p=(o("cbaa"),Object(l.a)(u,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"mp-erp-product-list-page-product-factory-set-comp-wrap"},[o("header",[o("span",[t._v("当前"+t._s(t.titleType)+"：")]),o("span",[t._v(t._s(t.ProductName))]),o("p",[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.onFactorySaveClick(null)}}},[t._v("+添加工厂策略")])],1)]),o("main",[o("FactoryTable",{attrs:{dataList:t.localTableData,loading:t.loading,PropertyList:t.ProductFactoryPropertyList},on:{remove:t.onRemove,edit:t.onEdit}})],1),o("footer",[o("el-button",{on:{click:t.onGoBackClick}},[o("i",{staticClass:"el-icon-d-arrow-left"}),t._v(" 返回")])],1)])}),[],!1,null,null,null));e.default=p.exports},"756f":function(t,e,o){},a622:function(t,e,o){"use strict";var r=o("55a5");o.n(r).a},cbaa:function(t,e,o){"use strict";var r=o("756f");o.n(r).a}}]);