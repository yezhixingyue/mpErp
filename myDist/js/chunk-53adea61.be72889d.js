(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-53adea61"],{"59a8":function(e,t,n){},aacc:function(e,t,n){"use strict";n.r(t);var a=(n("b0c0"),n("ac1f"),n("5319"),n("5530")),i=n("c362"),o=n("2f62"),r={name:"ProductElementSetPage",components:{CommonElementSetPageComp:i.a},data:function(){return{PositionID:"",ProductName:"",titleType:""}},computed:Object(a.a)({},Object(o.e)("common",["useElementModuleList"]),{curUseElementModule:function(){var e="部件"===this.titleType?"Part":"Product",t=this.$utils.getIDFromListByNames(e,this.useElementModuleList);return t||0===t?t:""}}),methods:{getPositionID:function(){if(this.$route.params){var e=this.$route.params,t=e.id,n=e.name,a=e.type;t&&n&&a?(this.PositionID=t,this.ProductName=n,this.titleType=a):this.onGoBackClick()}else this.onGoBackClick()},onGoBackClick:function(){this.$router.replace("/ProductManageList")}},mounted:function(){this.getPositionID()}},s=(n("b2f2"),n("2877")),u=Object(s.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"mp-erp-product-list-page-product-element-set-comp-wrap"},[n("header",[n("span",[e._v("当前"+e._s(e.titleType)+"：")]),n("span",[e._v(e._s(e.ProductName))])]),e.PositionID?n("CommonElementSetPageComp",{attrs:{curUseElementModule:e.curUseElementModule,PositionID:e.PositionID}}):e._e(),n("footer",[n("el-button",{on:{click:e.onGoBackClick}},[e._v("返回")])],1)],1)}),[],!1,null,null,null);t.default=u.exports},b2f2:function(e,t,n){"use strict";var a=n("59a8");n.n(a).a},c362:function(e,t,n){"use strict";var a=(n("4de4"),n("7db0"),n("c740"),n("4160"),n("caad"),n("d81d"),n("a434"),n("2532"),n("159b"),n("5530")),i=n("2909"),o=(n("96cf"),n("3835")),r=n("1da1"),s=n("05f6"),u={props:{PositionID:{type:String,default:""},GroupID:{type:String,default:""},showGroup:{type:Boolean,default:!0},canRemove:{type:Function,default:null},curUseElementModule:{}},data:function(){return{ElementDataList:[],ElementGroupDataList:[],isLoadingElement:!1,isLoadingGroup:!1}},components:{CommonElementSetComp:s.a},methods:{handleEditSubmitSuccess:function(e){var t=e.saveType,n=e.editData,a=e.ID,i=n,o="编辑"===t;if(o){if(o){var r=this.ElementDataList.findIndex((function(e){return e.ID===i.ID}));r>=0&&this.ElementDataList.splice(r,1,i)}}else i.ID=a,this.ElementDataList.push(i);this.$emit("elementSave",{isEdit:o,data:i})},onElementRemove:function(e){var t=this,n=Object(o.a)(e,2),a=n[0],s=n[1];return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.canRemove||t.canRemove(a)){e.next=3;break}return e.abrupt("return");case 3:if(!(t.ElementGroupDataList&&t.ElementGroupDataList.length>0)){e.next=10;break}if(n=[],t.ElementGroupDataList.forEach((function(e){return n.push.apply(n,Object(i.a)(e.ElementList))})),!n.find((function(e){return e.ID===a}))){e.next=10;break}return t.messageBox.failSingleError("删除失败","该元素在界面元素组中已使用"),e.abrupt("return");case 10:return e.next=12,t.api.getElementRemove(a,s).catch((function(){}));case 12:(o=e.sent)&&200===o.status&&1e3===o.data.Status&&(r=function(){t.ElementDataList=t.ElementDataList.filter((function(e){return e.ID!==a})),t.$emit("elementRemove",a)},t.messageBox.successSingle("删除成功",r,r));case 14:case"end":return e.stop()}}),e)})))()},getElementList:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoadingElement=!0,t.next=3,e.api.getElementList({groupID:e.GroupID,positionID:e.PositionID}).catch((function(){}));case 3:(n=t.sent)&&200===n.status&&1e3===n.data.Status&&(e.ElementDataList=n.data.Data),e.isLoadingElement=!1;case 6:case"end":return t.stop()}}),t)})))()},handleGroupSaveSuccess:function(e){var t=this,n=e.saveType,a=e.editData,i=e.ID,o=a,r=function(){var e=o.ElementList.map((function(e){return e.ID}));t.ElementDataList.forEach((function(t){var n=t;e.includes(t.ID)?!n||n.Group&&n.Group.ID===i||(n.Group={ID:i,Name:o.Name}):n.Group&&n.Group.ID===i&&(n.Group=null)}))};if("添加"===n)o.ID=i,this.ElementGroupDataList.push(o),r(),this.$emit("elementGroupSave",{isEdit:!1,data:o});else if("编辑"===n){var s=this.ElementGroupDataList.findIndex((function(e){return e.ID===o.ID}));s>=0&&(this.ElementGroupDataList.splice(s,1,o),r(),this.$emit("elementGroupSave",{isEdit:!0,data:o}))}},onElementGroupRemove:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var a,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.api.getElementGroupRemove(e).catch((function(){}));case 2:(a=n.sent)&&200===a.status&&1e3===a.data.Status&&(i=function(){t.ElementGroupDataList.find((function(t){return t.ID===e})).ElementList.forEach((function(e){var n=t.ElementDataList.find((function(t){return t.ID===e.ID}));n&&(n.Group=null)})),t.ElementGroupDataList=t.ElementGroupDataList.filter((function(t){return t.ID!==e})),t.$emit("elementGroupRemove",e)},t.messageBox.successSingle("删除成功",i,i));case 4:case"end":return n.stop()}}),n)})))()},getElementGroupList:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoadingGroup=!0,t.next=3,e.api.getElementGroupList(e.PositionID).catch((function(){}));case 3:(n=t.sent)&&200===n.status&&1e3===n.data.Status&&(e.ElementGroupDataList=n.data.Data),e.isLoadingGroup=!1;case 6:case"end":return t.stop()}}),t)})))()},handleSortSuccess:function(e){var t=e.ID,n=e.ElementList,i=this.ElementGroupDataList.find((function(e){return e.ID===t}));i&&(i.ElementList=i.ElementList.map((function(e){var t=n.find((function(t){return t.ID===e.ID}));return t?Object(a.a)({},e,{Index:t.Index}):Object(a.a)({},e)})))},fetchData:function(){this.getElementList(),this.showGroup&&this.getElementGroupList(),this.$emit("copyGroupSuccess")}},mounted:function(){this.getElementList(),this.showGroup&&this.getElementGroupList()}},c=n("2877"),m=Object(c.a)(u,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("CommonElementSetComp",{attrs:{ElementDataList:e.ElementDataList,ElementGroupDataList:e.ElementGroupDataList,isLoadingElement:e.isLoadingElement,isLoadingGroup:e.isLoadingGroup,PositionID:e.PositionID,showGroup:e.showGroup,curUseElementModule:e.curUseElementModule},on:{saveElement:e.handleEditSubmitSuccess,removeElement:e.onElementRemove,saveElementGroup:e.handleGroupSaveSuccess,removeElementGroup:e.onElementGroupRemove,sortGroupElementList:e.handleSortSuccess,copyGroupSuccess:e.fetchData}})}),[],!1,null,null,null);t.a=m.exports}}]);