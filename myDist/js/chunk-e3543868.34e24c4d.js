(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e3543868"],{"0a1e":function(e,t,i){"use strict";var l=i("e57c");i.n(l).a},"2af0":function(e,t,i){"use strict";i("4de4"),i("7db0"),i("c740"),i("caad"),i("d81d"),i("a434"),i("2532");var l=i("3835"),a=i("2909"),n=i("5530"),o=i("aa47"),r=i("c117"),s=i("2f62");t.a={data:function(){return{h:0,sortItem:null,tableKey:this.$utils.getRandomRangeId(8),notify:null,hideColLabelList:[],localShowLabelList:[]}},watch:{h:function(e){this.h=e;var t=document.getElementsByClassName("el-table")[0];t&&(t.style.maxHeight="".concat(e,"px"))},hideColLabelList:function(){var e=this;this.tableColData=this.tableColData.map((function(t){var i=Object(n.a)({},t);return e.hideColLabelList.includes(t.label)?i.show=!1:i.show=!0,i}))},isLeftCollapse:function(e){var t=this;setTimeout((function(){t.setHeightByDebounce()}),e?700:450)}},computed:Object(n.a)({},Object(s.e)("layout",["isLeftCollapse"]),{colLabels:function(){return this.tableColData?this.tableColData.map((function(e){return e.label})):[]},curShowColTableData:function(){return this.tableColData?this.tableColData.filter((function(e){return e.show})):[]}}),methods:{getHeight:function(e,t){var i=document.querySelector("#app > section > main");if(!i)return 600;var l=e?document.querySelector(e):null;return(l?i.offsetHeight-l.offsetHeight:i.offsetHeight)-t},initHeightAuto:function(){var e=this;this.$nextTick((function(){return e.setHeightByDebounce()})),window.addEventListener("resize",this.setHeightByDebounce)},removeHeightAuto:function(){window.removeEventListener("resize",this.setHeightByDebounce)},onHeaderDragend:function(e,t,i){var l=this;if(this.tableColData){var a=this.tableColData.find((function(e){return e.label===i.label}));if(a&&(a.width&&(a.width="".concat(e,"px")),a.minWidth&&(a.minWidth="".concat(e,"px"))),this.sortItem){try{this.sortItem.destroy()}catch(e){}this.$nextTick((function(){l.commonTableSortMixin()}))}}},commonTableSortMixin:function(){if(this.tableColData){var e=document.querySelector(".el-table__header thead tr"),t={onEnd:this.handleSortEnd};try{this.sortItem=o.a.create(e,t)}catch(e){}}},handleSortEnd:function(e){var t=this,i=e.oldIndex-1,n=e.newIndex-1;if(this.curShowColTableData.length<this.tableColData.length&&this.curShowColTableData[i]){var o=this.curShowColTableData[i].label,r=this.tableColData.findIndex((function(e){return e.label===o}));if(r>=0&&(i=r),n>0){var s=this.curShowColTableData[n-1].label,c=this.tableColData.findIndex((function(e){return e.label===s}));c>=0&&(n=c+1)}}var u=Object(a.a)(this.tableColData),d=u.splice(i,1),f=Object(l.a)(d,1)[0];u.splice(n,0,f),this.tableColData=u,this.tableKey=this.$utils.getRandomRangeId(8),this.$nextTick((function(){t.commonTableSortMixin()}))},handleMountedAndActivated:function(){var e=this;if(this.setHeightByDebounce=Object(r.a)(this.setHeight,30),this.initHeightAuto(),this.commonTableSortMixin(),this.tableName){var t=JSON.parse(localStorage.getItem(this.tableName));t.length>0&&(t=t.filter((function(t){return e.colLabels.includes(t)}))),this.hideColLabelList=t}},handleDestroyAndDeactivated:function(){if(this.removeHeightAuto(),this.sortItem)try{this.sortItem.destroy()}catch(e){}},onInfoClick:function(){var e=this,t=this.$createElement;if(this.tableColData){var i=160;this.$refs.oElTable&&this.$refs.oElTable.$el&&this.$refs.oElTable.$el.offsetTop&&(i=this.$refs.oElTable.$el.offsetTop-17),this.localShowLabelList=this.colLabels.filter((function(t){return!e.hideColLabelList.includes(t)}));var l=function(){e.notify&&e.notify.close()},n=function(t){var i=e.localShowLabelList.findIndex((function(e){return e===t}));i>=0?e.localShowLabelList.splice(i,1):e.localShowLabelList.push(t)},o=t("section",{class:"content-box"},[t("main",[t("el-checkbox-group",{attrs:{value:this.localShowLabelList}},[this.tableColData.map((function(e){return t("el-checkbox",{on:{change:function(){return n(e.label)}},attrs:{label:e.label},key:e.label})}))])]),t("footer",[t("el-button",{on:{click:function(){e.hideColLabelList=e.colLabels.filter((function(t){return!e.localShowLabelList.includes(t)})),e.tableName&&localStorage.setItem(e.tableName,JSON.stringify(e.hideColLabelList)),l()}},attrs:{type:"primary"}},["保存"]),t("el-button",{on:{click:l}},["关闭"]),t("span",{class:"span-title-blue",on:{click:function(){var t,i=e.colLabels.filter((function(t){return!e.localShowLabelList.includes(t)}));(t=e.localShowLabelList).push.apply(t,Object(a.a)(i))}}},["重置"]),t("p",{class:"is-gray"},[t("span",["1. 没有被选中的列将会被隐藏"]),t("span",["2. 列显示隐藏设置会缓存至本地，在不清除缓存或版本更新的情况下，下次打开会自动延续本次设置"]),t("span",["3. 中间列可左右拖动（不被缓存）"])])])]);this.notify=this.$notify({title:"设置列显示",customClass:"mp-erp-table-column-show-setup-wrap",duration:0,message:o,offset:i})}}},mounted:function(){this.handleMountedAndActivated()},beforeDestroy:function(){this.handleDestroyAndDeactivated()},activated:function(){this.handleMountedAndActivated()},deactivated:function(){this.handleDestroyAndDeactivated()}}},"327e":function(e,t,i){"use strict";var l=i("903f");i.n(l).a},"468e":function(e,t,i){"use strict";var l=i("4aae");i.n(l).a},"4aae":function(e,t,i){},"75d5":function(e,t,i){},"8e6e":function(e,t,i){"use strict";var l=i("dc48");i.n(l).a},"903f":function(e,t,i){},ad32:function(e,t,i){"use strict";var l={model:{prop:"value",event:"change"},props:{visible:{type:Boolean,default:!1},title:{type:String,default:"提示"},width:{default:"30%"},top:{type:String,default:"15vh"},showSubmit:{type:Boolean,default:!0},submitText:{type:String,default:"保存"},dangerText:{type:String,default:"重新生成"},cancelText:{type:String,default:"取消"},disabled:{type:Boolean,default:!1},showDanger:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},data:function(){return{checkList:[]}},methods:{onCancleClick:function(){this.$emit("cancle")},onSubmitClick:function(e){this.dialogVisible&&("BUTTON"===e.target.nodeName?e.target.blur():"BUTTON"===e.target.parentNode.nodeName&&e.target.parentNode.blur(),this.$emit("submit"))},onDangerClick:function(){this.$emit("danger")},onOpen:function(){this.$emit("open")},onOpened:function(){this.$emit("opened")},onClose:function(){this.$emit("close")},onClosed:function(){this.$emit("closed")}}},a=(i("468e"),i("2877")),n=Object(a.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header mp-erp-common-dialog-comp-wrap",attrs:{title:e.title,visible:e.dialogVisible,"close-on-click-modal":!1,width:e.width,top:e.top,modal:!1,"before-close":e.onCancleClick},on:{"update:visible":function(t){e.dialogVisible=t},open:e.onOpen,opened:e.onOpened,close:e.onClose,closed:e.onClosed}},[e._t("default"),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.$slots["foot-tip"]?i("div",[e._t("foot-tip")],2):e._e(),i("p",[e.showSubmit?i("el-button",{attrs:{type:"primary",loading:e.loading,disabled:e.disabled},on:{click:e.onSubmitClick}},[e._v(e._s(e.loading?"加载中":e.submitText))]):e._e(),e.showDanger?i("el-button",{attrs:{type:"danger"},on:{click:e.onDangerClick}},[e._v(e._s(e.dangerText))]):e._e(),i("el-button",{on:{click:e.onCancleClick}},[e._v(e._s(e.cancelText))])],1)])],2)}),[],!1,null,null,null);t.a=n.exports},c209:function(e,t,i){"use strict";var l=i("c6ab"),a={props:{title:{type:String,default:""},level1Options:{type:Array,default:function(){return[]}},level2Options:{type:Array,default:function(){return[]}},defaultProps:{type:Object,default:function(){return{label:"Name",value:"ID"}}},lv2DefaultProps:{type:Object,default:null},value:{type:Object,default:function(){return{level1Val:"",level2Val:""}}},isAssociated:{type:Boolean,default:!0}},model:{prop:"value",event:"change"},components:{SelectComp:l.a},computed:{level1:{get:function(){return this.value.level1Val},set:function(e){this.value.level1Val!==e&&this.$emit("change",{level1Val:e,level2Val:this.isAssociated?"":this.level2})}},level2:{get:function(){return this.value.level2Val},set:function(e){this.$emit("change",{level1Val:this.level1,level2Val:e})}}}},n=(i("0a1e"),i("2877")),o=Object(n.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",{staticClass:"mp-erp-common-select-comps-two-level-select-comp-wrap"},[e.title?i("li",{staticClass:"text"},[i("span",[e._v(e._s(e.title)+"：")])]):e._e(),i("li",{staticClass:"first-select-box"},[i("SelectComp",{attrs:{options:e.level1Options,defaultProps:e.defaultProps},model:{value:e.level1,callback:function(t){e.level1=t},expression:"level1"}})],1),i("li",[i("SelectComp",{attrs:{options:e.level2Options,defaultProps:e.lv2DefaultProps||e.defaultProps},model:{value:e.level2,callback:function(t){e.level2=t},expression:"level2"}})],1)])}),[],!1,null,null,null);t.a=o.exports},c6ab:function(e,t,i){"use strict";var l={props:{value:{default:"不限"},options:{type:Array,default:function(){return[{value:"",label:"不限"}]}},defaultProps:{type:Object,default:function(){return{label:"label",value:"value"}}},filterable:{type:Boolean,default:!1}},model:{prop:"value",event:"change"},computed:{result:{get:function(){return this.value},set:function(e){e!==this.value&&this.$emit("change",e)}}}},a=(i("8e6e"),i("2877")),n=Object(a.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-select",{staticClass:"mp-erp-new-common-select-comp-wrap",attrs:{filterable:e.filterable,size:"small"},model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},e._l(e.options,(function(t){return i("el-option",{key:t.value,attrs:{label:t[e.defaultProps.label],value:t[e.defaultProps.value]}})})),1)}),[],!1,null,null,null);t.a=n.exports},d76a:function(e,t,i){"use strict";i.r(t);var l=(i("99af"),i("4de4"),i("7db0"),i("caad"),i("2532"),i("96cf"),i("1da1")),a=i("5530"),n={props:{filterWords:{}},data:function(){return{keyWord:""}},methods:{onClick:function(){this.$emit("onFactoryAddClick")},onFilterClick:function(e){e&&"clear"===e?this.$emit("onFilterClick",""):this.$emit("onFilterClick",this.keyWord)}},watch:{filterWords:{handler:function(e){e!==this.keyWord&&(this.keyWord=e)},immediate:!0}}},o=i("2877"),r=Object(o.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("header",[i("el-button",{staticClass:"blue-full-color-btn-styles is-blue-button",attrs:{type:"primary"},on:{click:e.onClick}},[e._v("添加生产工厂")]),i("div",{staticClass:"input-box"},[i("el-input",{attrs:{placeholder:"请输入搜索关键字"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onFilterClick(t)}},model:{value:e.keyWord,callback:function(t){e.keyWord="string"==typeof t?t.trim():t},expression:"keyWord"}}),i("el-button",{attrs:{type:"primary"},on:{click:e.onFilterClick}},[e._v("筛选")]),i("span",{staticClass:"blue-span",on:{click:function(t){return e.onFilterClick("clear")}}},[e._v("清除筛选项")])],1)],1)}),[],!1,null,null,null).exports,s=i("2af0"),c={props:{dataList:{default:function(){return[]},type:Array},filterWords:{},getAddName:{type:Function,default:function(){}}},mixins:[s.a],data:function(){return{search:""}},methods:{setHeight:function(){var e=this.getHeight("",105);this.h=e},onEditClick:function(e){this.$emit("handleAddressItemEdit",e)},onRemoveClick:function(e){this.$emit("handleAddressItemRemove",e)}}},u=(i("327e"),Object(o.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-table",{staticClass:"mp-erp-factory-manage-page-table-comp-wrap",staticStyle:{width:"100%"},attrs:{"max-height":e.h,height:e.h,data:e.dataList,stripe:"",border:"",fit:""}},[i("el-table-column",{attrs:{prop:"FactoryName",label:"工厂名称","min-width":"160"}}),i("el-table-column",{attrs:{prop:"Address",label:"工厂地址","min-width":"360"},scopedSlots:e._u([{key:"default",fn:function(t){return i("span",{staticClass:"is-gray"},[e._v(e._s(e.getAddName(t.row)))])}}])}),i("el-table-column",{attrs:{prop:"LinkMan",label:"联系人","min-width":"130"}}),i("el-table-column",{attrs:{prop:"Mobile",label:"联系电话","min-width":"130"}}),i("el-table-column",{attrs:{label:"操作",width:"320"},scopedSlots:e._u([{key:"default",fn:function(t){return i("div",{staticClass:"menu-list"},[i("span",{on:{click:function(i){return e.onEditClick(t.row)}}},[i("i"),e._v("编辑")]),i("span",{on:{click:function(i){return e.onRemoveClick(t.row)}}},[i("i"),e._v("删除")])])}}])}),i("div",{attrs:{slot:"empty"},slot:"empty"},[e.filterWords?i("span",[e._v("当前关键字为："+e._s(e.filterWords)+"， 筛选出条目为0， 请尝试更换搜索关键字")]):i("span",[e._v("暂无数据")])])],1)}),[],!1,null,null,null)).exports,d=(i("4160"),i("d81d"),i("b64b"),i("159b"),i("ad32")),f=i("c209"),m={props:{visible:{type:Boolean,default:!1},areaList:{type:Array,default:function(){return[]}},itemData:{type:Object,default:null}},components:{CommonDialogComp:d.a,TwoLevelSelectComp:f.a},computed:{locationIDs:{get:function(){return{level1Val:this.ruleForm.ProvinceID,level2Val:this.ruleForm.CityID}},set:function(e){var t=e.level1Val,i=e.level2Val;this.ruleForm.ProvinceID=t,this.ruleForm.CityID=i}},level1Options:function(){return this.areaList&&0!==this.areaList.length?this.areaList.map((function(e){return{Name:e.Name,ID:e.ID}})):[]},level2Options:function(){var e=this;if(!this.areaList||0===this.areaList.length||!this.ruleForm.ProvinceID)return[];var t=this.areaList.find((function(t){return t.ID===e.ruleForm.ProvinceID}));return t?t.children.map((function(e){return{Name:e.Name,ID:e.ID}})):[]},title:function(){return this.ruleForm.FactoryID?"编辑生产工厂":"添加生产工厂"}},data:function(){return{ruleForm:{FactoryName:"",ProvinceID:"",CityID:"",Address:"",LinkMan:"",Mobile:"",FactoryID:0},rules:{FactoryName:[{required:!0,message:"请输入工厂名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],CityID:[{required:!0,message:"请选择工厂地址",trigger:"change"}],Address:[{required:!0,message:"请输入详细地址",trigger:"blur"},{min:1,max:60,message:"长度在 1 到 60 个字符",trigger:"blur"}],LinkMan:[{required:!0,message:"请输入联系人",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],Mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式不正确",trigger:"blur"}]}}},methods:{onDialogSubmit:function(){var e=this;this.$refs.ruleForm.validate((function(t){t&&e.$emit("submit",e.ruleForm)}))},onDialogCancle:function(){this.$emit("update:visible",!1)},initEditData:function(){var e=this;this.itemData?Object.keys(this.ruleForm).forEach((function(t){(e.itemData[t]||0===e.itemData[t])&&(e.ruleForm[t]=e.itemData[t])})):(Object.keys(this.ruleForm).forEach((function(t){e.ruleForm[t]=""})),this.ruleForm.FactoryID=0,this.level1Options.length>0&&(this.ruleForm.ProvinceID=this.level1Options[0].ID),this.level2Options.length>0&&(this.ruleForm.CityID=this.level2Options[0].ID))},onOpen:function(){this.$nextTick(this.initEditData)},onClosed:function(){this.$refs.ruleForm.resetFields()}}},h=Object(o.a)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("CommonDialogComp",{attrs:{width:"700px",title:e.title,visible:e.visible},on:{"update:visible":function(t){e.visible=t},submit:e.onDialogSubmit,cancle:e.onDialogCancle,open:e.onOpen,closed:e.onClosed}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"工厂名称",prop:"FactoryName"}},[i("el-input",{attrs:{placeholder:"请输入工厂名称",maxlength:"20","show-word-limit":""},model:{value:e.ruleForm.FactoryName,callback:function(t){e.$set(e.ruleForm,"FactoryName",t)},expression:"ruleForm.FactoryName"}})],1),i("el-form-item",{attrs:{label:"工厂地址",prop:"CityID"}},[i("TwoLevelSelectComp",{attrs:{level1Options:e.level1Options,level2Options:e.level2Options},model:{value:e.locationIDs,callback:function(t){e.locationIDs=t},expression:"locationIDs"}})],1),i("el-form-item",{attrs:{label:"详细地址",prop:"Address"}},[i("el-input",{attrs:{placeholder:"请输入详细地址",maxlength:"60","show-word-limit":""},model:{value:e.ruleForm.Address,callback:function(t){e.$set(e.ruleForm,"Address",t)},expression:"ruleForm.Address"}})],1),i("el-form-item",{attrs:{label:"联系人",prop:"LinkMan"}},[i("el-input",{attrs:{placeholder:"请输入联系人",maxlength:"10","show-word-limit":""},model:{value:e.ruleForm.LinkMan,callback:function(t){e.$set(e.ruleForm,"LinkMan","string"==typeof t?t.trim():t)},expression:"ruleForm.LinkMan"}})],1),i("el-form-item",{attrs:{label:"联系电话",prop:"Mobile"}},[i("el-input",{attrs:{placeholder:"请输入联系电话",maxlength:"11","show-word-limit":""},model:{value:e.ruleForm.Mobile,callback:function(t){e.$set(e.ruleForm,"Mobile","string"==typeof t?t.trim():t)},expression:"ruleForm.Mobile"}})],1)],1)],1)}),[],!1,null,null,null).exports,p=i("2f62"),b={name:"FactoryManagePage",components:{FactoryManageHeader:r,FactoryManageTable:u,FactoryManageDialog:h},computed:Object(a.a)({},Object(p.e)("common",["factoryList"]),{},Object(p.c)("common",["allAdAreaTreeList"]),{filterDataList:function(){var e=this;return this.filterWords?this.factoryList.filter((function(t){return t.FactoryName.includes(e.filterWords)||t.Address.includes(e.filterWords)||t.LinkMan.includes(e.filterWords)||t.Mobile.includes(e.filterWords)})):this.factoryList}}),data:function(){return{dialogVisible:!1,curItemData:null,filterWords:""}},methods:{onFactoryAddClick:function(){this.curItemData=null,this.dialogVisible=!0},onFilterClick:function(e){this.filterWords=e},getItemAddressName:function(e){if(!e||!this.allAdAreaTreeList||0===this.allAdAreaTreeList.length)return"";var t=this.allAdAreaTreeList.find((function(t){return t.ID===e.ProvinceID}));if(t){var i=t.children.find((function(t){return t.ID===e.CityID}));return i?"".concat(t.Name).concat(i.Name).concat(e.Address):"".concat(t.Name).concat(e.Address)}return"".concat(e.Address)},handleAddressItemEdit:function(e){this.curItemData=e,this.dialogVisible=!0},onSubmit:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function i(){var l,a,n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e){i.next=2;break}return i.abrupt("return");case 2:return l=0===e.FactoryID?"添加":"编辑",i.next=5,t.$store.dispatch("common/getFactorySave",e);case 5:(a=i.sent)&&(n=function(){t.dialogVisible=!1,t.$store.commit("common/setFactoryChange",{type:0===e.FactoryID?"add":"edit",data:a})},t.messageBox.successSingle("".concat(l,"成功!"),n,n));case 7:case"end":return i.stop()}}),i)})))()},handleAddressItemRemove:function(e){var t=this;this.messageBox.warnCancelBox("确定删除该工厂吗 ?","工厂名称：[ ".concat(e.FactoryName," ]"),(function(){t.$store.dispatch("common/getFactoryRemove",e)}))}},mounted:function(){this.$store.dispatch("common/getFactoryList"),this.$store.dispatch("common/fetchAdAreaList")}},v=(i("ff0f"),Object(o.a)(b,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{staticClass:"mp-erp-factory-manage-page-wrap"},[i("FactoryManageHeader",{attrs:{filterWords:e.filterWords},on:{onFactoryAddClick:e.onFactoryAddClick,onFilterClick:e.onFilterClick}}),i("main",[i("FactoryManageTable",{attrs:{dataList:e.filterDataList,filterWords:e.filterWords,getAddName:e.getItemAddressName},on:{handleAddressItemEdit:e.handleAddressItemEdit,handleAddressItemRemove:e.handleAddressItemRemove}}),i("FactoryManageDialog",{attrs:{visible:e.dialogVisible,areaList:e.allAdAreaTreeList,itemData:e.curItemData},on:{"update:visible":function(t){e.dialogVisible=t},submit:e.onSubmit}})],1),i("footer",[i("span",[e._v("共检索出 "),i("i",[e._v(e._s(e.factoryList.length))]),e._v(" 条数据")]),i("span",{directives:[{name:"show",rawName:"v-show",value:e.filterWords,expression:"filterWords"}],staticStyle:{"margin-left":"5px"}},[e._v("，筛选出 "),i("i",[e._v(e._s(e.filterDataList.length))]),e._v(" 条")])])],1)}),[],!1,null,null,null));t.default=v.exports},dc48:function(e,t,i){},e57c:function(e,t,i){},ff0f:function(e,t,i){"use strict";var l=i("75d5");i.n(l).a}}]);