(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-27f49c82"],{"07ac":function(t,e,i){var n=i("23e7"),a=i("6f53").values;n({target:"Object",stat:!0},{values:function(t){return a(t)}})},"0846":function(t,e,i){"use strict";var n=i("b7aa");i.n(n).a},"13f7":function(t,e,i){},"1cfc":function(t,e,i){},"27ff":function(t,e,i){"use strict";var n={model:{prop:"radio",event:"handleRadioChange"},props:{list:{type:Array,default:function(){return[]}},radio:{},defaultProps:{type:Object,default:function(){return{label:"name",value:"ID"}}}},computed:{radioValue:{get:function(){return this.radio},set:function(t){this.$emit("handleRadioChange",t)}}}},a=i("2877"),s=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-radio-group",{staticClass:"mp-coms-common-single-radio-group-comp-wrap",model:{value:t.radioValue,callback:function(e){t.radioValue=e},expression:"radioValue"}},t._l(t.list,(function(e){return i("el-radio",{key:e[t.defaultProps.value],attrs:{label:e[t.defaultProps.value]}},[t._v(t._s(e[t.defaultProps.label]))])})),1)}),[],!1,null,null,null);e.a=s.exports},"2e4d":function(t,e,i){"use strict";var n=(i("4de4"),i("7db0"),i("d81d"),i("ade3")),a={model:{prop:"selectList",event:"change"},props:{title:{type:String,default:"下单渠道"},itemList:{type:Array,default:function(){return[]}},selectList:{type:Array,default:function(){return[]}},defaultProps:{type:Object,default:function(){return{label:"CategoryName",value:"CategoryID"}}},isDisabled:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!0},useLabel:{type:Boolean,default:!0}},computed:{checkList:{get:function(){var t=this;return this.selectList.map((function(e){var i=t.itemList.find((function(i){return i[t.defaultProps.value]===e[t.defaultProps.value]}));return i?t.useLabel?i[t.defaultProps.label]:i[t.defaultProps.value]:null})).filter((function(t){return!!t}))},set:function(t){var e=this,i=t.map((function(t){return e.itemList.find((function(i){return i[e.useLabel?e.defaultProps.label:e.defaultProps.value]===t}))}));i=i.map((function(t){return Object(n.a)({},e.defaultProps.value,t[e.defaultProps.value])})),this.$emit("change",i)}}}},s=(i("9ffe"),i("2877")),o=Object(s.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mp-common-comps-checkbox-group-comp-wrap"},[t.showTitle?i("span",[t._v(t._s(t.title)+"：")]):t._e(),i("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.itemList,(function(e,n){return i("el-checkbox",{key:e[t.defaultProps.value]+"-"+e[t.defaultProps.label]+n,attrs:{label:t.useLabel?e[t.defaultProps.label]:e[t.defaultProps.value],disabled:t.isDisabled}},[i("el-tooltip",{attrs:{"popper-class":"checkbox-tip","visible-arrow":!1,transition:"none",content:e[t.defaultProps.label],placement:"bottom",enterable:!1}},[i("span",[t._v(t._s(e[t.defaultProps.label]))])])],1)})),1)],1)}),[],!1,null,null,null);e.a=o.exports},"2f9aa":function(t,e,i){},"3b1c":function(t,e,i){"use strict";var n={props:{title:{type:String,default:"默认标题"},imgSrc:{type:String,default:""}}},a=(i("dabc"),i("2877")),s=Object(a.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mp-vertical-type-title"},[i("div",{staticClass:"img-box"},[i("img",{attrs:{src:t.imgSrc,alt:""}})]),i("span",{staticClass:"title"},[t._v(t._s(t.title))])])}),[],!1,null,null,null);e.a=s.exports},"564a":function(t,e,i){"use strict";var n=i("e448");i.n(n).a},"633b":function(t,e,i){"use strict";var n=i("b699");i.n(n).a},6347:function(t,e,i){"use strict";var n=i("9bb0");i.n(n).a},"64c4":function(t,e,i){"use strict";var n=i("9281");i.n(n).a},"65ff":function(t,e,i){"use strict";var n=i("1cfc");i.n(n).a},"67d3":function(t,e,i){"use strict";var n=i("719c");i.n(n).a},6820:function(t,e,i){"use strict";var n=i("2f9aa");i.n(n).a},"6f53":function(t,e,i){var n=i("83ab"),a=i("df75"),s=i("fc6a"),o=i("d1e7").f,r=function(t){return function(e){for(var i,r=s(e),c=a(r),l=c.length,d=0,u=[];l>d;)i=c[d++],n&&!o.call(r,i)||u.push(t?[i,r[i]]:r[i]);return u}};t.exports={entries:r(!0),values:r(!1)}},"719c":function(t,e,i){},7367:function(t,e,i){},"797d":function(t,e,i){"use strict";var n=(i("99af"),i("fb6a"),i("ac1f"),i("1276"),i("afbe")),a={props:{title:{type:String,default:"开始时间"},isDisabled:{default:!1,type:Boolean},DateValue:{type:String},handleFunc:{type:Function},isLineStyle:{default:!1,type:Boolean},showCheck:{default:!1,type:Boolean},StartNow:{default:!1,type:Boolean},setStartNowFunc:{type:Function}},data:function(){return{localTimeDisabled:!1}},computed:{firstTime:{get:function(){return this.DateValue?this.DateValue.split("T")[0]:""},set:function(t){if(this.handleFunc){var e;e=this.DateValue?"".concat(t,"T").concat(this.DateValue.split("T")[1]):"".concat(t,"T00:00:00.000Z"),this.handleFunc(e)}}},secondTime:{get:function(){return this.DateValue?this.DateValue.split("T")[1].split(".")[0].substring(0,5):""},set:function(t){if(this.handleFunc){var e=this.DateValue.split("T")[0],i="00.000Z";"结束时间"===this.title&&(i="59.997Z");var n="".concat(e,"T").concat(t,":").concat(i);this.handleFunc(n)}}},isStartNow:{get:function(){return this.StartNow},set:function(t){if(this.localTimeDisabled=t,this.setStartNowFunc(t),t){var e=Object(n.a)(new Date),i="0".concat((new Date).getHours()).slice(-2),a="0".concat((new Date).getMinutes()).slice(-2),s="0".concat((new Date).getSeconds()).slice(-2),o="".concat(e,"T").concat(i,":").concat(a,":").concat(s,".000Z");this.handleFunc(o)}}}}},s=(i("6347"),i("2877")),o=Object(s.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mp-common-comps-disconnect-type-date-picker-wrap",class:t.isLineStyle?"isLineStyle":""},[i("span",[t._v(t._s(t.title)+"：")]),i("el-date-picker",{staticClass:"comp-date",attrs:{clearable:!1,format:"yyyy-MM-dd",disabled:t.isDisabled||t.localTimeDisabled,"value-format":"yyyy-MM-dd",type:"date",placeholder:"年 / 月 / 日"},model:{value:t.firstTime,callback:function(e){t.firstTime=e},expression:"firstTime"}}),i("el-time-picker",{staticClass:"comp-time",attrs:{disabled:t.isDisabled||t.localTimeDisabled,"default-time":"00:00","value-format":"HH:mm","picker-options":{format:"HH:mm"},format:"HH:mm",clearable:!1},model:{value:t.secondTime,callback:function(e){t.secondTime=e},expression:"secondTime"}}),t.showCheck?i("span",{staticClass:"check-box"},[i("el-checkbox",{attrs:{disabled:t.isDisabled},model:{value:t.isStartNow,callback:function(e){t.isStartNow=e},expression:"isStartNow"}},[i("em",[t._v("立即生效")])])],1):t._e()],1)}),[],!1,null,null,null);e.a=o.exports},"8f2b":function(t,e,i){},9281:function(t,e,i){},"92ce":function(t,e,i){"use strict";var n=i("7367");i.n(n).a},9410:function(t,e,i){"use strict";var n=i("8f2b");i.n(n).a},"96c6":function(t,e,i){"use strict";var n=i("13f7");i.n(n).a},"9bb0":function(t,e,i){},"9ffe":function(t,e,i){"use strict";var n=i("e548");i.n(n).a},b699:function(t,e,i){},b7aa:function(t,e,i){},d2f2:function(t,e,i){},dabc:function(t,e,i){"use strict";var n=i("d2f2");i.n(n).a},dfb8:function(t,e,i){"use strict";i.r(e);var n=(i("99af"),i("4de4"),i("4160"),i("d81d"),i("fb6a"),i("159b"),i("2909")),a=i("5530"),s=i("2f62"),o={model:{value:"value",event:"input"},props:{title:{type:String,default:"活动标题"},placeholder:{type:String,default:"请输入活动标题"},value:{type:String,default:""},isDisabled:{type:Boolean,default:!1}},methods:{onInput:function(t){this.$emit("input",t.target.value)}}},r=(i("0846"),i("2877")),c=Object(r.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mp-common-comps-field-input-wrap"},[i("span",[t._v(t._s(t.title)+"：")]),i("input",{attrs:{type:"text",placeholder:t.placeholder,disabled:t.isDisabled},domProps:{value:t.value},on:{input:t.onInput}})])}),[],!1,null,null,null).exports,l=i("797d"),d=i("b1b8"),u=i("2e4d"),p=i("64dc"),f=i("afbe"),h={components:{FieldInput:c,DisconnectTypeDatePickerComp:l.a,StaffSelector:d.a,CheckboxGroupComp:u.a,TreeComp:p.a},computed:Object(a.a)({},Object(s.e)("common",["orderCreateTypeList","userTypeList","userRankList"]),{},Object(s.e)("promoteStore",["promoteAddRequestObj","promoteStaffList"]),{},Object(s.c)("common",["allAreaTreeList"]),{orderTypeList:function(){return this.orderCreateTypeList?this.orderCreateTypeList.filter((function(t){return!!t.ID})):[]},filterUserTypeList:function(){return this.userTypeList?this.userTypeList.filter((function(t){return t.CategoryID})):[]},filterUserRankList:function(){return this.userRankList?this.userRankList.filter((function(t){return!!t.CategoryID})):[]},selectOrderTypeList:function(){return this.promoteAddRequestObj.OrderTypeList},selectUserTypeList:function(){return this.promoteAddRequestObj.CustomerTypeList.map((function(t){return{CategoryID:t.ID}}))},selectUserRankList:function(){return this.promoteAddRequestObj.CustomerGradeList.map((function(t){return{CategoryID:t.ID}}))},isStartNow:{get:function(){return this.promoteAddRequestObj.StartNow},set:function(t){if(this.setPromoteAddRequestObj([["StartNow",""],t]),t){var e=Object(f.a)(new Date),i="0".concat((new Date).getHours()).slice(-2),n="0".concat((new Date).getMinutes()).slice(-2),a="0".concat((new Date).getSeconds()).slice(-2),s="".concat(e,"T").concat(i,":").concat(n,":").concat(a,".000Z");this.setPromoteAddRequestObj([["ValidStartTime",""],s])}}},promoteTitle:{get:function(){return this.promoteAddRequestObj.Title},set:function(t){this.setPromoteAddRequestObj([["Title",""],t])}},defaultCheckedKeys:function(){return this.promoteAddRequestObj.SellAreaArray.map((function(t){return t.CountyID}))},shouldDisabledList:function(){if(!this.isDisabled)return[];var t=[];return this.allAreaTreeList.forEach((function(e){e.children.forEach((function(e){t=[].concat(Object(n.a)(t),Object(n.a)(e.children))}))})),t.map((function(t){return t.ID}))}}),methods:Object(a.a)({},Object(s.d)("promoteStore",["setPromoteAddRequestObj"]),{},Object(s.b)("common",["getUserClassify","getAreaList"]),{onOrderTypeListChange:function(t){this.setPromoteAddRequestObj([["OrderTypeList",""],t])},onUserTypeListChange:function(t){var e=t.map((function(t){return{ID:t.CategoryID}}));this.setPromoteAddRequestObj([["CustomerTypeList",""],e])},onUserRankListChange:function(t){var e=t.map((function(t){return{ID:t.CategoryID}}));this.setPromoteAddRequestObj([["CustomerGradeList",""],e])},handleChangeFunc:function(t){var e=t.filter((function(t){return 3===t.Level})).map((function(t){return{CountyID:t.ID}}));this.setPromoteAddRequestObj([["SellAreaArray",""],e])}}),mounted:function(){this.getUserClassify(),this.getAreaList()},props:{isDisabled:{type:Boolean,default:!1}}},m=(i("67d3"),Object(r.a)(h,(function(){var t=this,e=this,i=e.$createElement,n=e._self._c||i;return n("div",{staticClass:"promote-add-edit-detail-left-wrap"},[n("ul",{staticClass:"mp-scroll-wrap"},[n("li",[n("field-input",{attrs:{isDisabled:e.isDisabled},model:{value:e.promoteTitle,callback:function(t){e.promoteTitle=t},expression:"promoteTitle"}})],1),n("li",{staticClass:"start-time-box"},[n("disconnect-type-date-picker-comp",{attrs:{isDisabled:e.isStartNow||e.isDisabled,DateValue:e.promoteAddRequestObj.ValidStartTime,handleFunc:function(e){return t.setPromoteAddRequestObj([["ValidStartTime",""],e])}}}),n("span",[n("el-checkbox",{attrs:{disabled:e.isDisabled},model:{value:e.isStartNow,callback:function(t){e.isStartNow=t},expression:"isStartNow"}},[n("em",[e._v("立即生效")])])],1)],1),n("li",[n("disconnect-type-date-picker-comp",{attrs:{DateValue:e.promoteAddRequestObj.ValidEndTime,handleFunc:function(e){return t.setPromoteAddRequestObj([["ValidEndTime",""],e])},title:"结束时间",isDisabled:e.isDisabled}})],1),n("li",[n("staff-selector",{attrs:{changePropsFunc:e.setPromoteAddRequestObj,typeList:[["ApplyUser","StaffID"]],title:"申请人",isDisabled:e.isDisabled,watchValue:e.promoteStaffList,value:e.promoteAddRequestObj.ApplyUser.StaffID}})],1),n("li",{staticClass:"top-25"},[n("checkbox-group-comp",{attrs:{itemList:e.orderTypeList,selectList:e.selectOrderTypeList,defaultProps:{label:"name",value:"ID"},isDisabled:e.isDisabled},on:{change:e.onOrderTypeListChange}})],1),n("li",[n("checkbox-group-comp",{attrs:{title:"客户类型",itemList:e.filterUserTypeList,selectList:e.selectUserTypeList,isDisabled:e.isDisabled},on:{change:e.onUserTypeListChange}})],1),n("li",[n("checkbox-group-comp",{attrs:{title:"客户等级",itemList:e.filterUserRankList,selectList:e.selectUserRankList,isDisabled:e.isDisabled},on:{change:e.onUserRankListChange}})],1),n("li",{staticClass:"area-wrap"},[n("tree-comp",{attrs:{treeList:e.allAreaTreeList,defaultCheckedKeys:e.defaultCheckedKeys,handleChangeFunc:e.handleChangeFunc,shouldDisabledList:e.shouldDisabledList,showDisabled:e.isDisabled,isDisabled:e.isDisabled}})],1)])])}),[],!1,null,null,null)).exports,b=(i("7db0"),i("3b1c")),v=i("09f8"),C=i("edeb"),g={components:{normalBtnFull:v.a,TreeComp:p.a,normalBtn:C.a},props:{title:{type:String,default:"添加活动商品"},useSpan:{type:Boolean,default:!1},commonDialogTitle:{type:String,default:""},defaultCheckedKeys:{type:Array,default:function(){return[]}},handleSaveFunc:{type:Function,default:function(){}},setWatchValue2ProductDia:{type:Function,default:function(){}},watchValue:{},setOpenType2ProductDia:{type:Function,default:function(){}},shouldDisabledList:{type:Array,default:function(){return[]}},isDisabled:{type:Boolean,default:!1}},computed:Object(a.a)({},Object(s.c)("common",["allProductClassify"]),{watchValue4Tree:function(){return this.watchValue},defaultKeys:function(){return this.checkedNodes.filter((function(t){return t.ProductID}))}}),data:function(){return{dialogVisible:!1,checkedNodes:[],dialogTitle:"添加活动商品"}},methods:{handleClose:function(){if("number"==typeof this.watchValue){var t=this.watchValue;this.setWatchValue2ProductDia(t+1)}else Array.isArray(this.watchValue)&&this.setWatchValue2ProductDia(1);this.checkedNodes=[],this.dialogVisible=!1},handleSave:function(){if(this.dialogVisible){var t=this.handleSaveFunc(this.checkedNodes,this.handleClose);!0===t?this.handleClose():"string"==typeof t&&this.$message({showClose:!0,message:t,type:"error"})}},handleChangeFunc:function(t){this.checkedNodes=t},handleOpenDialog:function(){this.setOpenType2ProductDia(""),this.dialogVisible=!0,this.dialogTitle="添加活动商品"}},watch:{watchValue:function(t){t&&Array.isArray(t)&&!this.dialogVisible&&(this.dialogVisible=!0,this.dialogTitle="修改活动商品")}},deactivated:function(){this.dialogVisible=!1},activated:function(){this.dialogVisible&&(this.dialogVisible=!1)}},y=(i("65ff"),Object(r.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mp-common-comps-product-checkout-dia-comp-wrap"},[t.useSpan?i("span",{staticClass:"span-title-blue",on:{click:t.handleOpenDialog}},[t._v(t._s(t.title))]):i("normal-btn-full",{class:t.isDisabled?"is-disabled-g":"",attrs:{title:t.title},nativeOn:{click:function(e){return t.handleOpenDialog(e)}}}),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header",attrs:{title:t.commonDialogTitle?t.commonDialogTitle:t.dialogTitle,visible:t.dialogVisible,width:"750px",top:"8vh",modal:!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("tree-comp",{attrs:{title:"",treeList:t.allProductClassify,defaultCheckedKeys:t.defaultKeys,handleChangeFunc:t.handleChangeFunc,watchValue:t.watchValue4Tree,shouldDisabledList:t.shouldDisabledList,showDisabled:!0,checkAllTitle:"所有产品"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("normal-btn-full",{attrs:{title:"确 定"},nativeOn:{click:function(e){return t.handleSave(e)}}}),i("normalBtn",{attrs:{title:"取 消"},nativeOn:{click:function(e){return t.handleClose(e)}}})],1)],1)],1)}),[],!1,null,null,null)).exports,D=(i("b0c0"),i("a9e3"),i("b64b"),i("07ac"),i("53ca")),P=(i("96cf"),i("1da1")),L=i("3835"),O=i("ade3"),T=i("4941"),I={props:{conditionList:{type:Array,default:function(){return[]}},ConstraintIndex:{type:Number},ProductIndex:{type:Number},conditionData:{type:Object,default:function(){return{}}}},components:{ConditionSingleComp:T.a},methods:{addCondition:function(){this.$emit("handleAddCondition",[this.ProductIndex,this.ConstraintIndex]);var t=document.querySelector(".condition-list.mp-scroll-wrap");this.$utils.animateScroll(t.scrollTop,t.scrollHeight,(function(e){t.scrollTop=e}))},delCondition:function(t){this.$emit("delCondition4AddRequestObj",[this.ProductIndex,this.ConstraintIndex,t])},editCondition:function(t){var e=Object(L.a)(t,2),i=e[0],n=e[1];this.$emit("editCondition4AddRequestObj",[this.ProductIndex,this.ConstraintIndex,n,i])}}},A=(i("6820"),Object(r.a)(I,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.ConstraintIndex||0===t.ConstraintIndex?i("section",{staticClass:"mp-promote-comps-condition-list-comp-wrap"},[i("header",{staticClass:"is-blue"},[i("span",{on:{click:t.addCondition}},[t._v("添加条件")])]),t.conditionData.Constraint&&t.conditionData.Constraint.ItemList?i("ul",{staticClass:"condition-list mp-scroll-wrap"},t._l(t.conditionData.Constraint.ItemList,(function(e,n){return i("ConditionSingleComp",{key:"conditionData"+n,attrs:{conditionList:t.conditionList,itemList:t.conditionData.Constraint.ItemList,itemIndex:n,itemData:e},on:{editCondition:t.editCondition,delCondition:t.delCondition}})})),1):t._e()]):t._e()}),[],!1,null,null,null)).exports,j=i("27ff"),x=i("ee41"),k={components:{SingleRadioGroupComp:j.a,RadioButtonGroupComp:x.a},props:{PriceUnitList:{type:Array,default:function(){return[]}},priceData:{type:Object,default:function(){return{}}},ConstraintIndex:{type:Number},ProductIndex:{type:Number}},computed:Object(a.a)({},Object(s.e)("common",["conditionTypeList"]),{priceUnit:function(){if(!this.radio&&0!==this.radio)return"";switch(this.radio){case 0:return"元 / 每个产品";case 1:return"元 / 单款总价";case 3:return"%";case 4:return"元";default:return""}},radioValue:{get:function(){return this.priceData&&this.priceData.Constraint?this.priceData.Constraint.FilterType:""},set:function(t){this.$emit("setFilterType",this.ProductIndex,this.ConstraintIndex,t)}},radio:{get:function(){return this.priceData?this.priceData.PriceUnit:""},set:function(t){this.$emit("setPriceUnit",this.ProductIndex,this.ConstraintIndex,t)}},price:{get:function(){return this.priceData?this.priceData.Price:""},set:function(t){this.$emit("setPrice",this.ProductIndex,this.ConstraintIndex,t)}}}),methods:{handleRadioChange:function(t){this.radio=t}}},w=(i("92ce"),Object(r.a)(k,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"mp-promote-comps-result-list-comp-wrap"},[i("header",[i("RadioButtonGroupComp",{attrs:{radioList:t.conditionTypeList},model:{value:t.radioValue,callback:function(e){t.radioValue=e},expression:"radioValue"}})],1),i("SingleRadioGroupComp",{attrs:{radio:t.radio,list:t.PriceUnitList},on:{handleRadioChange:t.handleRadioChange}}),i("footer",[4===t.radio?i("span",[t._v("减款:")]):i("span",[t._v("执行价格:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.price,expression:"price"}],attrs:{type:"text",placeholder:"请输入价格"},domProps:{value:t.price},on:{input:function(e){e.target.composing||(t.price=e.target.value)}}}),i("span",[t._v(t._s(t.priceUnit))])])],1)}),[],!1,null,null,null)).exports,R=i("286f"),V={components:{normalBtnFull:v.a,normalBtn:C.a,ConditionsComp:A,ResultComps:w},props:{data:{type:Object,default:function(){return{}}},index:{type:Number},isDisabled:{type:Boolean,default:!1}},filters:{geConditiontValue:function(t){if(!t)return"";var e,i=t.Price,n=t.PriceUnit;if(!i&&!n&&0!==n&&0!==i)return"";switch(n){case 0:e="每个产品单价".concat(i,"元");break;case 1:e="每款产品总价".concat(i,"元");break;case 3:e="百分比折扣".concat(i,"%")}return e}},computed:Object(a.a)({},Object(s.e)("common",["PriceUnitList","OperatorKeyValueList"]),{},Object(s.c)("common",["allProductClassify"]),{productNameList:function(){if(!this.data||0===this.data.length)return"";if(0===this.allProductClassify.length)return"";var t=Object(R.b)(this.data.LimitList,this.allProductClassify),e=[];return"全部产品"===t?["全部产品"]:(t.forEach((function(t){if(R.c.test(t.children[0]))e.push(Object(O.a)({},t.ClassName,[Object(O.a)({},"全部".concat(t.ClassName,"产品"),[])]));else{var i=Object(O.a)({},t.ClassName,[]);t.children.forEach((function(e){var n=Object(O.a)({},e.ClassName,[]);R.c.test(e.children[0])?(n[e.ClassName]=[e.children[0]],i[t.ClassName].push(n)):(e.children.forEach((function(t){n[e.ClassName].push(t.ClassName)})),i[t.ClassName].push(n))})),e.push(i)}})),e)},productNameString:function(){if(this.productNameList[0]&&"全部产品"===this.productNameList[0])return"全部产品";var t="",e=this.productNameList.map((function(t){return Object.values(t)[0]}));return e.forEach((function(i,n){var a=e.length-1===n?"":"、";R.c.test(Object.keys(i[0])[0])?t+=Object.keys(i[0])[0]:i.forEach((function(e,n){var a=i.length-1===n?"":"、";R.c.test(Object.keys(e)[0])?t+=Object.keys(e)[0]:R.c.test(Object.values(e)[0][0])?t+=Object.values(e)[0][0]:(t+=Object.keys(e)[0],t+="(",Object.values(e)[0].forEach((function(i,n){var a=Object.values(e)[0].length-1===n?"":"、";t+=i,t+=a})),t+=")"),t+=a})),t+=a})),t},productList:function(){return this.data.LimitList},maxConstraintIndex:function(){return this.data.List.length-1},ConditionTextList:function(){var t=this;return this.data.List.map((function(e){return t.getConditionText(e.Constraint.ItemList,e.Constraint.FilterType)}))}}),data:function(){return{dialogVisible:!1,conditionList:[],curConditionIndex:null,diaType:"",prevCondition2Edit:null,isHide:!0,dialogPriceTitle:"添加价格"}},methods:Object(a.a)({},Object(s.d)("promoteStore",["addCondition4AddRequestObj","editCondition4AddRequestObj","delCondition4AddRequestObj","setPriceUnitAndFilterTypeAndPrice","addPrice4AddRequestObj","delPrice4AddRequestObj","delProductItem4AddRequestObj","setWatchValue2ProductDia","setOpenType2ProductDia"]),{handlePriceEdit:function(t){this.curConditionIndex=t,this.prevCondition2Edit=JSON.stringify(this.data.List[this.curConditionIndex]),this.diaType="edit",this.dialogVisible=!0,this.dialogPriceTitle="修改价格"},handleProductDelete:function(t){var e=this;this.messageBox.warnCancelNullMsg("确定删除该条价格信息吗 ?",(function(){return e.delPrice4AddRequestObj([e.index,t])}),null)},handleDelProducts:function(){var t=this;this.messageBox.warnCancelBox("确定删除价格表中所有活动产品吗 ?","[ 确认后此价格表将被移除! ]",(function(){return t.delProductItem4AddRequestObj(t.index)}),null)},handleChangeProducts:function(){var t=this.data.LimitList.map((function(t){return t.ProductID}));this.setWatchValue2ProductDia(Object(n.a)(t)),this.setOpenType2ProductDia(this.index)},addPrice:function(){this.addPrice4AddRequestObj(this.index),this.curConditionIndex=this.maxConstraintIndex,this.diaType="create",this.dialogVisible=!0,this.dialogPriceTitle="添加价格"},handleAddCondition:function(t){var e=Object(L.a)(t,2),i=e[0],n=e[1];this.addCondition4AddRequestObj([i,n])},handleClose:function(t){if("create"===this.diaType)this.delPrice4AddRequestObj([this.index,this.curConditionIndex]),this.curConditionIndex>0?this.curConditionIndex-=1:this.curConditionIndex=null;else if("edit"===this.diaType){var e=JSON.parse(this.prevCondition2Edit);this.delPrice4AddRequestObj([this.index,this.curConditionIndex,e])}t()},setPriceUnit:function(t,e,i){this.setPriceUnitAndFilterTypeAndPrice([t,e,"PriceUnit",i])},setFilterType:function(t,e,i){this.setPriceUnitAndFilterTypeAndPrice([t,e,"FilterType",i])},setPrice:function(t,e,i){this.setPriceUnitAndFilterTypeAndPrice([t,e,"Price",i])},requestConditionList:function(t){var e=this;return Object(P.a)(regeneratorRuntime.mark((function i(){var n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.api.getConditionList(18,t,"");case 2:1e3===(n=i.sent).data.Status&&(e.conditionList=n.data.Data);case 4:case"end":return i.stop()}}),i)})))()},handleSave:function(){var t=this;if(!this.dialogVisible)return"";var e=this.data.List[this.curConditionIndex],i=e.PriceUnit,n=e.Price,a=e.Constraint;if(!n)return this.$message.error("请输入活动执行价格!");if(isNaN(n)||n<=0)return this.$message.error("请输入大于0的数字类型值!");if(!i&&0!==i)return this.$message.error("请勾选活动价格设置类型!");for(var s=a.FilterType,o=a.ItemList,r=function(e){var i=o[e],n=t.conditionList.find((function(t){return t.PropertyType===i.PropertyType&&t.PropertyID===i.PropertyID&&t.GroupID===i.GroupID&&t.CraftID===i.CraftID&&t.PartID===i.PartID&&t.ProductID===i.ProductID}));if(!n)return{v:t.$message.error("未获取到对应条件信息!")};if(!i.Value&&0!==i.Value)return{v:t.$message.error("条件[ ".concat(e+1," ] 值未选择或输入!"))};if(1===n.ValueType&&(n.MinValue||0===n.MinValue)){var a=n.MinValue,s=-1===n.MaxValue?1/0:n.MaxValue;if(i.Value<a||i.Value>s)return{v:t.$message.error("条件".concat(e+1," [").concat(n.Prefix,"]的值范围应在").concat(a,"-").concat(s===1/0?"无穷大":s,"之间!"))}}},c=0;c<o.length;c+=1){var l=r(c);if("object"===Object(D.a)(l))return l.v}return s?(this.dialogVisible=!1,""):this.$message.error("请选择满足条件类型")},getConditionText:function(t,e){var i=this,n={type:1===e?"并且":2===e?"或者":"",_list:[]};return t.forEach((function(t){var e=i.conditionList.find((function(e){return e.PropertyType===t.PropertyType&&e.PropertyID===t.PropertyID&&e.GroupID===t.GroupID&&e.CraftID===t.CraftID&&e.PartID===t.PartID&&e.ProductID===t.ProductID}));if(e){var a={};a.Prefix=e.Prefix;var s=i.OperatorKeyValueList.find((function(e){return e.ID===t.Operator}));if(a.Operator=s.name,1===e.ValueType)a.Value="".concat(t.Value).concat(e.Unit);else if(2===e.ValueType){var o=e.OptionList.find((function(e){return e.OptionID===t.Value})),r=o?o.Value:"";a.Value=r}n._list.push(a)}})),n},preRequestConditionList:function(){var t;if(this.data.LimitList.length>1)t="";else{if(1!==this.data.LimitList.length)return;t=this.data.LimitList[0].ProductID}this.requestConditionList(t)}}),watch:{productList:function(t,e){t.length>1&&1===e.length&&this.preRequestConditionList(),1===t.length&&e.length>1&&this.preRequestConditionList(),1===t.length&&1===e.length&&t[0].ProductID!==e[0].ProductID&&this.preRequestConditionList()}},mounted:function(){this.preRequestConditionList()}},S=(i("9410"),Object(r.a)(V,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"mp-promote-comp-add-product-ltem-wrap"},[n("div",{staticClass:"header"},[n("div",{staticClass:"left"},[n("div",{staticClass:"product-title-list"},[n("span",[t._v("活动产品：")]),n("el-tooltip",{attrs:{placement:"top-start",hasTransition:!1,"popper-class":"mp-promote-comp-add-product-ltem-wrap-tip-popper",effect:"light"}},[n("ul",{staticClass:"product-list-wrap",attrs:{slot:"content"},slot:"content"},[t.productNameList[0]&&"全部产品"===t.productNameList[0]?n("li",[t._v(" "+t._s(t.productNameList[0])+" ")]):t._l(t.productNameList,(function(e,i){return n("li",{key:e+"-"+i},t._l(e,(function(e,i,a){return n("div",{key:e+a},[a>0?n("i",[t._v("、")]):t._e(),t._v(" ["),n("ul",t._l(e,(function(i,a){return n("li",{key:i+a},[t._l(i,(function(e,i,a){return n("div",{key:e+a},[n("span",{staticClass:"title2"},[t._v(t._s(i))]),e.length>0?[t._v(" ("),t._l(e,(function(i,a){return n("span",{key:i+a,staticClass:"is-gray product-child"},[t._v(" "+t._s(i)+" "),a<e.length-1?n("i",[t._v("、")]):t._e()])})),t._v(") ")]:t._e()],2)})),a<e.length-1?n("i",[t._v("、")]):t._e()],2)})),0),t._v("] ")])})),0)}))],2),n("span",{staticClass:"product-list-wrap"},[t._v(" "+t._s(t.productNameString)+" ")])])],1)]),t.isDisabled?t._e():n("div",{staticClass:"right"},[t.isDisabled?t._e():n("div",{staticClass:"add-price is-blue",on:{click:t.addPrice}},[t._v("添加价格")]),n("span",{staticClass:"is-blue",on:{click:t.handleChangeProducts}},[t._v("修改产品")]),n("span",{staticClass:"is-red",on:{click:t.handleDelProducts}},[t._v("删除活动产品")])])]),n("div",{staticClass:"content"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.data.List,border:"",stripe:""}},[n("el-table-column",{attrs:{label:"条件","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"condition-box hidden"},[n("div",t._l(t.ConditionTextList[e.$index]._list,(function(i,a){return n("span",{key:i.Prefix+"-"+a},[a>0?n("i",{staticClass:"is-gray"},[t._v(t._s(t.ConditionTextList[e.$index].type))]):t._e(),t._v(" "+t._s(i.Prefix)),n("em",{staticClass:"is-origin"},[t._v(t._s(i.Operator))]),t._v(t._s(i.Value)+" ")])})),0)])]}}])}),n("el-table-column",{attrs:{prop:"name",label:"执行价格",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("em",[t._v(" "+t._s(t._f("geConditiontValue")(e.row))+" ")])]}}])}),n("el-table-column",{attrs:{width:"175",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isDisabled?n("span",{staticClass:"btn-item is-disabled-g is-gray"},[n("img",{attrs:{src:i("42b6"),alt:""}}),t._v("修改价格 ")]):n("span",{staticClass:"btn-item is-blue",on:{click:function(i){return t.handlePriceEdit(e.$index)}}},[n("img",{attrs:{src:i("3a48"),alt:""}}),t._v("修改价格 ")]),t.isDisabled?n("span",{staticClass:"btn-item is-disabled-g is-gray"},[n("img",{attrs:{src:i("fa18"),alt:""}}),t._v("删除 ")]):n("span",{staticClass:"btn-item is-red",on:{click:function(i){return t.handleProductDelete(e.$index)}}},[n("img",{attrs:{src:i("6e30"),alt:""}}),t._v("删除 ")])]}}])}),n("div",{attrs:{slot:"empty"},slot:"empty"},[n("span",[t._v("尚未添加价格信息")])])],1),n("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header",attrs:{title:t.dialogPriceTitle,visible:t.dialogVisible,width:"750px",top:"8vh",modal:!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("div",[n("conditions-comp",{attrs:{conditionList:t.conditionList,ConstraintIndex:t.curConditionIndex,ProductIndex:t.index,conditionData:t.data.List[t.curConditionIndex]},on:{handleAddCondition:t.handleAddCondition,editCondition4AddRequestObj:t.editCondition4AddRequestObj,delCondition4AddRequestObj:t.delCondition4AddRequestObj}}),n("result-comps",{attrs:{PriceUnitList:t.PriceUnitList,ConstraintIndex:t.curConditionIndex,ProductIndex:t.index,priceData:t.data.List[t.curConditionIndex]},on:{setPriceUnit:t.setPriceUnit,setFilterType:t.setFilterType,setPrice:t.setPrice}})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("normal-btn-full",{attrs:{title:"保 存"},nativeOn:{click:function(e){return t.handleSave(e)}}}),n("normal-btn",{attrs:{title:"取 消"},nativeOn:{click:function(e){t.handleClose((function(){return t.dialogVisible=!1}))}}})],1)])],1)])}),[],!1,null,null,null)).exports,_={components:{VTypeTitle:b.a,ProductsCheckoutDiaComp:y,PromoteProductPriceItem:S},data:function(){return{pageTitle:"添加活动"}},props:{isDisabled:{type:Boolean,default:!1}},computed:Object(a.a)({},Object(s.e)("promoteStore",["promoteAddRequestObj","watchValue2ProductDia","openTypeIndex2ProductDia"]),{},Object(s.e)("common",["Permission"]),{},Object(s.c)("common",["allProductClassify"]),{defaultCheckedKeys:function(){return(this.openTypeIndex2ProductDia||0===this.openTypeIndex2ProductDia)&&this.promoteAddRequestObj.ProductList[this.openTypeIndex2ProductDia]?this.promoteAddRequestObj.ProductList[this.openTypeIndex2ProductDia].LimitList.map((function(t){return t.ProductID})):[]},shouldDisabledList:function(){var t=[];return this.promoteAddRequestObj.ProductList.forEach((function(e){e.LimitList.forEach((function(e){t.push(e.ProductID)}))})),t}}),methods:Object(a.a)({},Object(s.d)("promoteStore",["setPromoteAddRequestObj","setWatchValue2ProductDia","setOpenType2ProductDia"]),{},Object(s.b)("common",["getProductList","getAllProductNames"]),{handleSaveFunc:function(t,e){var i=this,s=t.filter((function(t){return t.ProductID}));if(0===s.length)return"至少必须选择一种产品!";var o,r=s.map((function(t){return{FirstLevelID:t.ProductClass.First,SecondLevelID:t.ProductClass.Second,ProductID:t.ProductID,ProductName:t.ProductName}})),c=Object(n.a)(this.promoteAddRequestObj.ProductList),l={LimitList:r,List:[]};if(!this.openTypeIndex2ProductDia&&0!==this.openTypeIndex2ProductDia)return o=[].concat(Object(n.a)(c),[l]),this.setPromoteAddRequestObj([["ProductList",""],o]),!0;if("number"==typeof this.openTypeIndex2ProductDia){var d=r.length,u=c.find((function(t,e){return e===i.openTypeIndex2ProductDia})),p=u.LimitList.length;if(1===p&&1===d&&u.LimitList[0].ProductID===r[0].ProductID)return!0;if(!(1===p&&d>1||1===p&&1===d&&u.LimitList[0].ProductID!==r[0].ProductID))return o=c.map((function(t,e){if(e!==i.openTypeIndex2ProductDia)return t;var n=JSON.parse(JSON.stringify(t));if(1===r.length){var s=r[0].ProductID;n.List.forEach((function(t){t.Constraint.ItemList.forEach((function(t){t.ProductID=s}))}))}return Object(a.a)({},n,{LimitList:r})})),this.setPromoteAddRequestObj([["ProductList",""],o]),!0;this.messageBox.warnCancelBox("确定修改产品信息吗 ?","[ 该操作会导致此价格表清空! ]",(function(){o=c.map((function(t,e){return e!==i.openTypeIndex2ProductDia?t:Object(a.a)({},t,{},l)})),i.setPromoteAddRequestObj([["ProductList",""],o]),e()}),null)}}}),mounted:function(){this.getProductList(),this.getAllProductNames();var t=this.$route.params.type;"add"===t&&(this.pageTitle="添加活动"),"edit"===t&&(this.pageTitle="编辑活动"),"detail"===t&&(this.pageTitle="活动详情")}},N={components:{PromoteAddMainLeft:m,PromoteAddMainRight:(i("564a"),Object(r.a)(_,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"promote-add-edit-detail-right-wrap"},[i("header",[i("VTypeTitle",{attrs:{title:t.pageTitle}})],1),i("main",[i("span",{staticClass:"add-header"},[t.Permission.PermissionList.PermissionPromote.Obj.Setup?i("ProductsCheckoutDiaComp",{attrs:{defaultCheckedKeys:t.defaultCheckedKeys,handleSaveFunc:t.handleSaveFunc,watchValue:t.watchValue2ProductDia,setWatchValue2ProductDia:t.setWatchValue2ProductDia,setOpenType2ProductDia:t.setOpenType2ProductDia,shouldDisabledList:t.shouldDisabledList,isDisabled:t.isDisabled,title:t.isDisabled?"活动商品详情":"添加活动商品"}}):t._e()],1),i("ul",{staticClass:"add-product-list mp-scroll-wrap"},t._l(t.promoteAddRequestObj.ProductList,(function(e,n){return i("promote-product-price-item",{key:"ProductList-"+n,attrs:{isDisabled:t.isDisabled,index:n,data:e}})})),1)])])}),[],!1,null,null,null)).exports},data:function(){return{type:""}},computed:{isDisabled:function(){return"detail"===this.type}},mounted:function(){this.type=this.$route.params.type}},E=(i("64c4"),Object(r.a)(N,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"promote-add-edit-detail-main-wrap"},[i("promote-add-main-left",{attrs:{isDisabled:t.isDisabled}}),i("promote-add-main-right",{attrs:{isDisabled:t.isDisabled}})],1)}),[],!1,null,null,null)).exports,F={components:{normalBtnFull:v.a,normalBtn:C.a},data:function(){return{type:""}},computed:Object(a.a)({},Object(s.e)("common",["Permission"])),methods:Object(a.a)({},Object(s.d)("promoteStore",["setPromoteStaffList"]),{},Object(s.b)("promoteStore",["getPromoteList"]),{onReturnClick:function(){this.$router.push("/promoteList")},handleSubmit:function(){var t=this;this.$store.dispatch("promoteStore/savePromote",[function(){t.onReturnClick(),t.getPromoteList(),t.setPromoteStaffList(null)},this.type])}}),mounted:function(){this.type=this.$route.params.type}},U={name:"PromoteAddPage",components:{PromoteAddEditDeatilFooter:(i("633b"),Object(r.a)(F,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"promote-add-edit-detail-footer-wrap"},["detail"!==t.type&&t.Permission.PermissionList.PermissionPromote.Obj.Setup?i("normal-btn-full",{staticClass:"save-btn",attrs:{title:"保存"},nativeOn:{click:function(e){return t.handleSubmit(e)}}}):t._e(),i("normal-btn",{staticClass:"return-btn",attrs:{title:"返回"},nativeOn:{click:function(e){return t.onReturnClick(e)}}})],1)}),[],!1,null,null,null)).exports,PromoteAddMain:E}},q=(i("96c6"),Object(r.a)(U,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"mp-promote-add-page-wrap"},[e("promote-add-main",{staticClass:"main"}),e("promote-add-edit-deatil-footer",{staticClass:"footer"})],1)}),[],!1,null,null,null));e.default=q.exports},e448:function(t,e,i){},e548:function(t,e,i){},fa18:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkVCMDc0MzE1RTdEMTExRTg5MTgxQTEyNDZDMjU1ODVBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkVCMDc0MzE2RTdEMTExRTg5MTgxQTEyNDZDMjU1ODVBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RUIwNzQzMTNFN0QxMTFFODkxODFBMTI0NkMyNTU4NUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RUIwNzQzMTRFN0QxMTFFODkxODFBMTI0NkMyNTU4NUEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7+lHsPAAAAx0lEQVR42mJkQAK3b9/eDaRcGFDBblVVVTcYhxFJMQuQ+g7EGkD8FiosCsRXgZgTqOkvWANQ4SQgnQXEzAz4AUjDNJAGEIOJgTjwD+QMYQYSAEhDGRBXEqm+DeQURRIsUARpeAHlKAGxApQtiMZWhrKfgzS8hHJAofQRxAAG4Qc0NiwEX4E0PIdyhPA4BSb3AtkGYjS8JEsDzNPCxDrpNZQjBcT80HQlgMaWgqp5zQgVfAVNaPjAa2CIicHS0EYiIm0DiAAIMACQDTYpwNTgygAAAABJRU5ErkJggg=="}}]);