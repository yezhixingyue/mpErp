(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c1b45976"],{"06e5":function(t,e,i){},"09f8":function(t,e,i){"use strict";var a={props:{title:{type:String,default:"关闭"},disabled:{type:Boolean,default:!1}}},n=(i("3f2b"),i("2877")),r=Object(n.a)(a,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"normal-full-btn",class:t.disabled?"is-disabled":"",attrs:{disabled:t.disabled}},[t._v(t._s(t.title))])}),[],!1,null,null,null);e.a=r.exports},"0c68":function(t,e,i){},2845:function(t,e,i){"use strict";i.r(e);var a=(i("7db0"),i("4160"),i("a15b"),i("d81d"),i("ac1f"),i("5319"),i("159b"),i("96cf"),i("1da1")),n=i("5530"),r=i("2f62"),o=i("09f8"),s=i("edeb"),l={props:{ProductList:{type:Array,required:!0},ProductClass:{type:Object,required:!0}},computed:Object(n.a)({},Object(r.e)("timelimit",["setPageType","TimeLimitData"]),{},Object(r.c)("common",["allProductClassify"]),{showList:function(){var t=this;if(!this.allProductClassify||0===this.allProductClassify.length)return[];var e=this.allProductClassify.find((function(e){return e.ID===t.ProductClass.FirstLevelID}));if(!e)return[];var i=e.children.find((function(e){return e.ID===t.ProductClass.SecondLevelID}));return i?i.children.map((function(t){return{ID:t.ID,Name:t.ClassName}})):[]},checkList:{get:function(){return this.ProductList.map((function(t){return t.ID}))},set:function(t){this.$store.commit("timelimit/setTimeLimitData",["ProductList",t.map((function(t){return{ID:t}}))])}},checkAll:{get:function(){return 0!==this.showList&&this.showList.length===this.ProductList.length},set:function(t){t?this.$store.commit("timelimit/setTimeLimitData",["ProductList",this.showList]):this.$store.commit("timelimit/setTimeLimitData",["ProductList",[]])}},isIndeterminate:function(){return 0!==this.ProductList.length&&this.showList.length!==this.ProductList.length&&this.ProductList.length<this.showList.length}}),data:function(){return{productDisabled:!1}},mounted:function(){this.$store.dispatch("common/getAllProductNames")}},c=(i("7db5"),i("2877")),u=Object(c.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"mp-erp-time-limit-set-page-content-product-select-comp-wrap"},[i("header",[t._v("指定产品：")]),i("div",[i("p",[i("el-checkbox",{attrs:{indeterminate:t.isIndeterminate,disabled:t.productDisabled},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")])],1),i("el-checkbox-group",{attrs:{disabled:t.productDisabled},model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.showList,(function(e){return i("el-checkbox",{key:e.ID,attrs:{label:e.ID}},[t._v(" "+t._s(e.Name)+" ")])})),1)],1)])}),[],!1,null,null,null).exports,m=(i("99af"),i("4de4"),i("caad"),i("fb6a"),i("a434"),i("b0c0"),i("2532"),i("1276"),i("2909")),d=i("3835"),h=i("64dc"),f=i("4941"),p={props:{conditionList:{type:Array,required:!0},conditionData:{type:Object,default:function(){return{}}},hasDecimal:{type:Boolean,default:!1}},components:{ConditionSingleComp:f.a},methods:{editCondition:function(t){var e=Object(d.a)(t,2),i=e[0],a=e[1];this.$emit("handleConditionItemDEdit",[i,a])},delCondition:function(t){this.$emit("handleConditionItemDel",t)}}},D=Object(c.a)(p,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.conditionData?i("ul",t._l(t.conditionData.ItemList,(function(e,a){return i("ConditionSingleComp",{key:e.selfID+""+a,attrs:{conditionList:t.conditionList,hasDecimal:t.hasDecimal,itemList:t.conditionData.ItemList,itemIndex:a,itemData:e},on:{editCondition:t.editCondition,delCondition:t.delCondition}})})),1):t._e()}),[],!1,null,null,null).exports,v=i("3628"),C=i("286f"),g={components:{normalBtnFull:o.a,normalBtn:s.a,TreeComp:h.a,CommonConditionComp:D},data:function(){return{showDialog:!1,showAddressDialog:!1,dialogTitle:"添加工期",IncludeLimitArea:!0,SellAreaArray:[],curEditIndex:0,bool4GetCondition:!1}},computed:Object(n.a)({},Object(r.e)("timelimit",["SchemaItemData","TimeLimitData","ConditionList4ProducePeriodProduct","setPageType"]),{},Object(r.e)("common",["adAreaList","OperatorKeyValueList"]),{},Object(r.c)("common",["subExpressList","allAdAreaTreeList"]),{allSubAreaList:function(){if(this.allAdAreaTreeList&&this.allAdAreaTreeList.length>0){var t=[];return this.allAdAreaTreeList.forEach((function(e){e.children.forEach((function(i){i.children.forEach((function(a){var n={RegionalID:e.ID,CityID:i.ID,CountyID:a.ID};t.push(n)}))}))})),t}return[]},ExpressCheckAll:{get:function(){return this.SchemaItemData.ExpressList.length>0&&this.SchemaItemData.ExpressList.length===this.subExpressList.length},set:function(t){var e=t?this.subExpressList:[];this.$store.commit("timelimit/changeSchemaItemData",["ExpressList",e])}},ExpressCheckList:{get:function(){return this.SchemaItemData.ExpressList.map((function(t){return t.ID}))},set:function(t){var e=t.map((function(t){return{ID:t}}));this.$store.commit("timelimit/changeSchemaItemData",["ExpressList",e])}},subExpressIDList:function(){return this.subExpressList&&0!==this.subExpressList.length?this.subExpressList.map((function(t){return t.ID})):[]},defaultCheckedKeys:function(){return this.SellAreaArray.map((function(t){return t.CountyID}))},areaShowTextArr:function(){if(0===this.allAdAreaTreeList.length||!this.SchemaItemData)return[];var t="Name",e=Object(C.a)(this.SchemaItemData.AreaList,this.allAdAreaTreeList,t),i=[];return"全部区域"===e?["全部区域"]:(e.forEach((function(e){if(C.c.test(e.children[0]))i.push("".concat(e[t]));else{var a="".concat(e[t],"：[");e.children.forEach((function(e,i){i>0&&(a+="、"),C.c.test(e.children[0])?a+="".concat(e[t],"全部区域 "):(a+="".concat(e[t],": "),e.children.forEach((function(e,i){a+=0===i?"".concat(e[t]):"、".concat(e[t])})))})),a+=" ]",i.push(a)}})),i)},Level2AreaList:function(){return 0===this.adAreaList.length?[]:this.adAreaList.filter((function(t){return 2===t.Level}))},isIndeterminate:function(){return 0!==this.SchemaItemData.ExpressList.length&&this.subExpressList.length!==this.SchemaItemData.ExpressList.length&&this.SchemaItemData.ExpressList.length<this.subExpressList.length},LatestPayTime:{get:function(){if(!this.SchemaItemData)return"";var t=this.SchemaItemData.LatestPayTime,e=t.First,i=t.Second;if(!e&&0!==e||!i&&0!==i)return"";var a="0".concat(e).slice(-2),n="0".concat(i).slice(-2);return"".concat(a,":").concat(n)},set:function(t){if(t){var e=t.split(":"),i=Object(d.a)(e,2),a=i[0],n=i[1];this.$store.commit("timelimit/changeSchemaItemData",["LatestPayTime",{First:a,Second:n}])}}},DurationDay:{get:function(){return this.SchemaItemData?this.SchemaItemData.ProduceDurationDay:""},set:function(t){var e=t.replace(/[^\d]/g,"");this.$store.commit("timelimit/changeSchemaItemData",["ProduceDurationDay",e]);var i=this.SchemaItemData.ProduceDuration?Math.floor(this.SchemaItemData.ProduceDuration%24):0;this.$store.commit("timelimit/changeSchemaItemData",["ProduceDuration",+i+24*+e])}},DurationHour:{get:function(){return this.SchemaItemData?this.SchemaItemData.ProduceDurationHour:""},set:function(t){var e=t.replace(/[^\d]/g,"");e>=24&&(e=23),this.$store.commit("timelimit/changeSchemaItemData",["ProduceDurationHour",e]);var i=this.SchemaItemData.ProduceDuration?Math.floor(this.SchemaItemData.ProduceDuration/24):0;this.$store.commit("timelimit/changeSchemaItemData",["ProduceDuration",24*+i+ +e])}},DeliveryDurationDay:{get:function(){return this.SchemaItemData?this.SchemaItemData.DeliveryDurationDay:""},set:function(t){var e=t.replace(/[^\d]/g,"");this.$store.commit("timelimit/changeSchemaItemData",["DeliveryDurationDay",e]);var i=this.SchemaItemData.DeliveryDuration?Math.floor(this.SchemaItemData.DeliveryDuration%24):0;this.$store.commit("timelimit/changeSchemaItemData",["DeliveryDuration",+i+24*+e])}},DeliveryDurationHour:{get:function(){return this.SchemaItemData?this.SchemaItemData.DeliveryDurationHour:""},set:function(t){var e=t.replace(/[^\d]/g,"");e>=24&&(e=23),this.$store.commit("timelimit/changeSchemaItemData",["DeliveryDurationHour",e]);var i=this.SchemaItemData.DeliveryDuration?Math.floor(this.SchemaItemData.DeliveryDuration/24):0;this.$store.commit("timelimit/changeSchemaItemData",["DeliveryDuration",24*+i+ +e])}},ProductIncrement:{get:function(){return this.SchemaItemData?this.SchemaItemData.ProductIncrement:""},set:function(t){var e=t.replace(/[^\d]/g,"");this.$store.commit("timelimit/changeSchemaItemData",["ProductIncrement",e])}},ProductIncrementDuration:{get:function(){return this.SchemaItemData?this.SchemaItemData.ProductIncrementDuration:""},set:function(t){var e=t.replace(/[^\d]/g,"");this.$store.commit("timelimit/changeSchemaItemData",["ProductIncrementDuration",e])}},CraftPeriodType:{get:function(){return this.SchemaItemData?this.SchemaItemData.CraftPeriodType:0},set:function(t){this.$store.commit("timelimit/changeSchemaItemData",["CraftPeriodType",t])}},CraftIncrement:{get:function(){return this.SchemaItemData?this.SchemaItemData.CraftIncrement:0},set:function(t){var e=t.replace(/[^\d]/g,"");this.$store.commit("timelimit/changeSchemaItemData",["CraftIncrement",e])}},CraftIncrementDuration:{get:function(){return this.SchemaItemData?this.SchemaItemData.CraftIncrementDuration:0},set:function(t){var e=t.replace(/[^\d]/g,"");this.$store.commit("timelimit/changeSchemaItemData",["CraftIncrementDuration",e])}},IncludeExpress:{get:function(){return this.SchemaItemData?this.SchemaItemData.IncludeExpress:0},set:function(t){this.$store.commit("timelimit/changeSchemaItemData",["IncludeExpress",t])}},SellAreaArrayList:function(){var t=this;if(0===this.allAdAreaTreeList.length)return[];var e=this.TimeLimitData.SchemaList.map((function(t){return t.AreaList})).map((function(e){return Object(C.a)(e,t.allAdAreaTreeList,"Name")})),i="Name";return e&&0!==e.length?e.map((function(t){var e=[];return"全部区域"===t?["全部区域"]:(t.forEach((function(t){if(C.c.test(t.children[0]))e.push("".concat(t[i]));else{var a="".concat(t[i],"：[");t.children.forEach((function(t,e){e>0&&(a+="、"),C.c.test(t.children[0])?a+="".concat(t[i],"全部区域 "):(a+="".concat(t[i],": "),t.children.forEach((function(t,e){a+=0===e?"".concat(t[i]):"、".concat(t[i])})))})),a+=" ]",e.push(a)}})),e)})):""},ConditionTextList:function(){var t=this;return this.TimeLimitData.SchemaList.map((function(e){return e.Constraint?t.getConditionText(e.Constraint.ItemList,e.Constraint.FilterType):{type:"",_list:[]}}))},watchVal4SetBool4GetCondition:function(){return this.TimeLimitData&&this.TimeLimitData.ProductList?this.TimeLimitData.ProductList.length:0}}),methods:{handleDialogSave:function(){var t=this;if(this.showDialog){var e=v.a.check(this.SchemaItemData);if(!0===e){var i=[];"编辑工期"===this.dialogTitle?(i=Object(m.a)(this.TimeLimitData.SchemaList)).splice(this.curEditIndex,1,this.SchemaItemData):i=[this.SchemaItemData].concat(Object(m.a)(this.TimeLimitData.SchemaList)),i=i.map((function(e){var i=e.ExpressList.filter((function(e){return t.subExpressIDList.includes(e.ID)}));return Object(n.a)({},e,{ExpressList:i})})),this.$store.commit("timelimit/setTimeLimitData",["SchemaList",i]),this.showDialog=!1}else"string"==typeof e&&this.messageBox.failSingleError("保存失败","[ ".concat(e," ]"))}},handleDialogClose:function(){this.showDialog=!1},onAddBtnClick:function(){if(this.TimeLimitData)if(0!==this.TimeLimitData.ProductList.length){if(this.$store.commit("timelimit/setSchemaItemDataInit",{}),this.dialogTitle="添加工期","edit"!==this.setPageType||this.bool4GetCondition){var t=[];if(this.TimeLimitData){var e=this.TimeLimitData.ProductList;e.length>0&&(t=Object(m.a)(e.map((function(t){return t.ID}))))}var i=this.TimeLimitData.ProductClass.SecondLevelID;this.$store.dispatch("timelimit/fetchConditionList",{type:19,Limits:t,positionID:i})}this.showDialog=!0,this.bool4GetCondition&&"edit"===this.setPageType&&(this.bool4GetCondition=!1)}else this.$message({showClose:!0,message:"请先选择指定产品",type:"error"})},onAreaBtnClick:function(){this.SellAreaArray=this.SchemaItemData.AreaList,this.IncludeLimitArea=this.SchemaItemData.IncludeLimitArea,this.showAddressDialog=!0},handleAreaDialogClose:function(){this.showAddressDialog=!1,this.$refs.TreeComp.clearTreeData()},handleAreaChangeFunc:function(t){var e=this,i=t.filter((function(t){return 2===t.Level})),a=t.filter((function(t){return 3===t.Level})).map((function(t){var a=t.ParentID,n=i.find((function(t){return t.ID===a}));n||(n=e.Level2AreaList.find((function(t){return t.ID===a})));var r=n?n.ParentID:"";return{CountyID:t.ID,CityID:a,RegionalID:r}}));this.SellAreaArray=a},setSchemaItemData:function(t,e){this.$store.commit("timelimit/changeSchemaItemData",["AreaList",t]),this.$store.commit("timelimit/changeSchemaItemData",["IncludeLimitArea",e]),this.handleAreaDialogClose()},getContraryAreaList:function(t){if(!t||0===t.length)return[];var e=t.map((function(t){return t.CountyID}));return this.allSubAreaList.filter((function(t){return!e.includes(t.CountyID)}))},handleAreaDialogSave:function(){var t=this;if(this.showAddressDialog)if(0===this.SellAreaArray.length&&this.IncludeLimitArea)this.messageBox.failSingleError("保存失败","[ 未选择区域 ]");else if(this.SellAreaArray.length<=2e3)this.setSchemaItemData(this.SellAreaArray,this.IncludeLimitArea);else{this.messageBox.warnCancelBox("当前生效方式区域选中较多!","点击确定系统将会自动切换相反生效方式",(function(){var e=t.getContraryAreaList(t.SellAreaArray);t.setSchemaItemData(e,!t.IncludeLimitArea)}))}},onFilterTypeChange:function(t){this.SchemaItemData&&t!==this.SchemaItemData.Constraint.FilterType&&this.$store.commit("timelimit/changeSchemaItemData4FilterType",t)},onConditonAddClick:function(){if(0!==this.ConditionList4ProducePeriodProduct.length){var t={ProductID:"",PartID:"",CraftID:"",GroupID:"",PropertyID:"",PropertyType:"",Operator:"",Value:"",Prefix:"",OptionList:[],Unit:"",selfID:"".concat(Date.now()),ValueType:1};this.$store.commit("timelimit/addSchemaItemData4Constraint",t);var e=document.querySelector(".add-limit-wrap .center .right-content > ul");this.$utils.animateScroll(e.scrollTop,e.scrollHeight,(function(t){e.scrollTop=t}))}},handleConditionItemDEdit:function(t){var e=Object(d.a)(t,2),i=e[0],a=e[1];this.$store.commit("timelimit/editSchemaItemData4Constraint",[a,i])},handleConditionItemDel:function(t){this.$store.commit("timelimit/editSchemaItemData4Constraint",[t])},handleSchemaEdit:function(t){this.$store.commit("timelimit/setSchemaItemDataInit",this.TimeLimitData.SchemaList[t]),this.curEditIndex=t;var e=[];if(this.dialogTitle="编辑工期",this.TimeLimitData){var i=this.TimeLimitData.ProductList;i.length>0&&(e=Object(m.a)(i.map((function(t){return t.ID}))))}var a=this.TimeLimitData.ProductClass.SecondLevelID;this.bool4GetCondition&&(this.$store.dispatch("timelimit/fetchConditionList",{type:19,Limits:e,positionID:a}),this.bool4GetCondition=!1),this.showDialog=!0},handleSchemaDel:function(t){var e=this;this.messageBox.warnCancelNullMsg("确定删除该条工期吗 ?",(function(){return e.$store.commit("timelimit/deleteTimeLimitSchemaItem",t)}),null)},getConditionText:function(t,e){var i=this,a={type:1===e?"并且":2===e?"或者":"",_list:[]};return t.forEach((function(t){var e=i.ConditionList4ProducePeriodProduct.find((function(e){return e.PropertyType===t.PropertyType&&e.PropertyID===t.PropertyID&&e.GroupID===t.GroupID&&e.CraftID===t.CraftID&&e.PartID===t.PartID&&e.ProductID===t.ProductID}));if(e){var n={};n.Prefix=e.Prefix;var r=i.OperatorKeyValueList.find((function(e){return e.ID===t.Operator}));if(n.Operator=r.name,1===e.ValueType)n.Value="".concat(t.Value).concat(e.Unit);else if(2===e.ValueType){var o=e.OptionList.find((function(e){return e.OptionID===t.Value})),s=o?o.Value:"";n.Value=s}a._list.push(n)}})),a},getExpressNames:function(t){var e=this,i=t.filter((function(t){return e.subExpressIDList.includes(t.ID)}));if(0===i.length||0===this.subExpressList.length)return"";if(i.length===this.subExpressList.length-1){var a=!0;if(i.forEach((function(t){1!==t.ID&&a||(a=!1)})),a)return"名片之家除外"}var n=[];return i.forEach((function(t){var i=e.subExpressList.find((function(e){return e.ID===t.ID}));i&&n.push(i.Name)})),n.join("、")}},mounted:function(){var t=this;return Object(a.a)(regeneratorRuntime.mark((function e(){var i,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.$store.dispatch("common/getExpressList"),t.$store.dispatch("common/fetchAdAreaList"),"edit"===t.setPageType&&t.TimeLimitData.SchemaList.length>=1&&(!0,i="",t.TimeLimitData&&((a=t.TimeLimitData.ProductList).length>0&&(i=a.map((function(t){return t.ID})))),n=t.TimeLimitData.ProductClass.SecondLevelID,t.$store.dispatch("timelimit/fetchConditionList",{type:19,Limits:i,positionID:n}));case 3:case"end":return e.stop()}}),e)})))()},watch:{watchVal4SetBool4GetCondition:function(){this.bool4GetCondition=!0}}},I=(i("3307"),Object(c.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"mp-erp-time-limit-set-page-content-schema-list-comp-wrap"},[i("header",[t._v("工期列表：")]),i("div",[i("p",[i("el-button",{attrs:{type:"primary",plain:""},on:{click:t.onAddBtnClick}},[t._v("+添加工期")])],1),t.TimeLimitData?i("el-table",{staticStyle:{width:"1600px"},attrs:{border:"",data:t.TimeLimitData.SchemaList,"max-height":"261"}},[i("el-table-column",{attrs:{label:"选中区域",width:"186"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.SellAreaArrayList[e.$index]&&t.SellAreaArrayList[e.$index].length>0?i("el-tooltip",{attrs:{placement:"top-start",enterable:!0,transition:"none"}},[i("div",{attrs:{slot:"content"},slot:"content"},t._l(t.SellAreaArrayList[e.$index],(function(e,a){return i("p",{key:e+"-"+a},[t._v(" "+t._s(e)+" ")])})),0),i("span",{staticClass:"area-span"},[t._v(t._s(t.SellAreaArrayList[e.$index].join(" ")))])]):t._e(),t.SellAreaArrayList[e.$index]&&0===t.SellAreaArrayList[e.$index].length?i("span",[t._v("全部区域"),i("i",{staticClass:"is-gray"},[t._v("（反选）")])]):t._e()]}}],null,!1,756546676)}),i("el-table-column",{attrs:{width:"105","show-overflow-tooltip":"",label:"生效方式"},scopedSlots:t._u([{key:"default",fn:function(e){return[!e.row.IncludeLimitArea&&t.SellAreaArrayList[e.$index]&&0===t.SellAreaArrayList[e.$index].length?i("span",{staticClass:"is-success"},[t._v("全部区域生效")]):e.row.IncludeLimitArea?i("span",[t._v("选中区域生效")]):i("span",{staticClass:"is-pink"},[t._v("非选中区域生效")])]}}],null,!1,2525464108)}),i("el-table-column",{attrs:{label:"配送方式","show-overflow-tooltip":"",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.subExpressList.length>e.row.ExpressList.length?t.getExpressNames(e.row.ExpressList):"所有配送方式")+" ")]}}],null,!1,1731328528)}),i("el-table-column",{attrs:{prop:"address",width:"365","show-overflow-tooltip":"",label:"其它条件"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(t.ConditionTextList[e.$index]._list,(function(a,n){return i("span",{key:a.Prefix+"-"+n},[n>0?i("i",{staticClass:"is-gray"},[t._v(t._s(t.ConditionTextList[e.$index].type))]):t._e(),t._v(" "+t._s(a.Prefix)),i("em",[t._v(t._s(a.Operator))]),t._v(t._s(a.Value)+" ")])}))}}],null,!1,2183259945)}),i("el-table-column",{attrs:{width:"125","show-overflow-tooltip":"",label:"付款时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(("0"+e.row.LatestPayTime.First).slice(-2)+":"+("0"+e.row.LatestPayTime.Second).slice(-2)+"之前")+" ")]}}],null,!1,2173409803)}),i("el-table-column",{attrs:{width:"105","show-overflow-tooltip":"",label:"生产工期"},scopedSlots:t._u([{key:"default",fn:function(e){return i("span",{staticClass:"is-success"},[t._v(" "+t._s(e.row.ProduceDuration>=24?Math.floor(e.row.ProduceDuration/24)+"天 "+e.row.ProduceDuration%24+"小时":e.row.ProduceDuration+"小时")+" ")])}}],null,!1,3034502388)}),i("el-table-column",{attrs:{width:"115","show-overflow-tooltip":"",label:"数量递增"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.ProductIncrementDuration&&e.row.ProductIncrement?e.row.ProductIncrementDuration+"小时 / "+e.row.ProductIncrement:"")+" ")]}}],null,!1,646371726)}),i("el-table-column",{attrs:{width:"125","show-overflow-tooltip":"",label:"工艺工期"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(3===e.row.CraftPeriodType?e.row.CraftIncrementDuration+"小时 / "+e.row.CraftIncrement+"种":"")+" "),0===e.row.CraftPeriodType?i("span",[t._v("不额外增加")]):t._e(),1===e.row.CraftPeriodType?i("span",[t._v("累加工艺工期")]):t._e(),2===e.row.CraftPeriodType?i("span",[t._v("仅增长最长工艺工期")]):t._e()]}}],null,!1,1716044465)}),i("el-table-column",{attrs:{prop:"address",width:"80","show-overflow-tooltip":"",label:"配送工期"},scopedSlots:t._u([{key:"default",fn:function(e){return i("span",{class:e.row.IncludeExpress?"":"is-gray"},[t._v(" "+t._s(e.row.IncludeExpress?e.row.DeliveryDuration>=24?Math.floor(e.row.DeliveryDuration/24)+"天 "+e.row.DeliveryDuration%24+"小时":e.row.DeliveryDuration+"小时":"不含")+" ")])}}],null,!1,433828229)}),i("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{staticClass:"menu-list"},[i("span",{on:{click:function(i){return t.handleSchemaEdit(e.$index)}}},[i("i"),t._v("编辑")]),i("span",{on:{click:function(i){return t.handleSchemaDel(e.$index)}}},[i("i"),t._v("删除")])])}}],null,!1,950361526)})],1):t._e()],1),t.SchemaItemData?i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header add-limit-wrap",attrs:{title:t.dialogTitle,visible:t.showDialog,width:"850px",top:"4vh",modal:!1,"before-close":t.handleDialogClose},on:{"update:visible":function(e){t.showDialog=e}}},[i("section",{staticClass:"top"},[i("div",[i("span",{staticClass:"title"},[t._v("指定区域：")]),i("div",{staticClass:"right-content"},[i("span",{staticClass:"blue-span",on:{click:t.onAreaBtnClick}},[t._v("选择区域")]),t.areaShowTextArr&&t.areaShowTextArr.length>0?i("span",[t._v(" [ "),t.SchemaItemData.IncludeLimitArea?i("i",{staticClass:"is-success"},[t._v("只限右侧区域生效")]):i("i",{staticClass:"is-pink"},[t._v("排除右侧已选区域")]),t._v(" ] -- ")]):t._e(),t.areaShowTextArr&&t.areaShowTextArr.length>0?i("el-tooltip",{attrs:{placement:"top-start",enterable:!1,transition:"none"}},[i("div",{attrs:{slot:"content"},slot:"content"},t._l(t.areaShowTextArr,(function(e,a){return i("p",{key:e+"-"+a},[t._v(" "+t._s(e)+" ")])})),0),i("span",[t._v(t._s(t.areaShowTextArr.join("、")))])]):t._e(),t.areaShowTextArr&&0===t.areaShowTextArr.length&&!t.SchemaItemData.IncludeLimitArea?i("span",[t._v(" 全部区域生效 ")]):t._e()],1)]),i("div",[i("span",{staticClass:"title"},[t._v("配送方式：")]),t.subExpressList.length>0?i("div",{staticClass:"right-content"},[i("p",[i("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},model:{value:t.ExpressCheckAll,callback:function(e){t.ExpressCheckAll=e},expression:"ExpressCheckAll"}},[t._v("全选")])],1),i("el-checkbox-group",{model:{value:t.ExpressCheckList,callback:function(e){t.ExpressCheckList=e},expression:"ExpressCheckList"}},t._l(t.subExpressList,(function(e){return i("el-checkbox",{key:e.ID,attrs:{label:e.ID}},[t._v(t._s(e.Name))])})),1)],1):t._e()]),i("div",[i("span",{staticClass:"title"},[t._v("付款时间：")]),i("div",{staticClass:"right-content"},[i("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"01:00",end:"23:55"},placeholder:"选择时间"},model:{value:t.LatestPayTime,callback:function(e){t.LatestPayTime=e},expression:"LatestPayTime"}}),i("span",[t._v("之前")])],1)])]),i("div",{staticClass:"line"}),i("section",{staticClass:"center"},[i("div",[i("span",{staticClass:"title"},[t._v("其他条件：")]),i("div",{staticClass:"right-content"},[i("p",{staticClass:"blue-span",on:{click:t.onConditonAddClick}},[t._v("+添加条件")]),i("CommonConditionComp",{attrs:{conditionList:t.ConditionList4ProducePeriodProduct,conditionData:t.SchemaItemData.Constraint,hasDecimal:!0},on:{handleConditionItemDEdit:t.handleConditionItemDEdit,handleConditionItemDel:t.handleConditionItemDel}}),i("div",{staticClass:"mp-switch"},[i("span",{class:1===t.SchemaItemData.Constraint.FilterType?"active":"",on:{click:function(){return t.onFilterTypeChange(1)}}},[t._v("满足以上所有条件时")]),i("span",{class:2===t.SchemaItemData.Constraint.FilterType?"active":"",on:{click:function(){return t.onFilterTypeChange(2)}}},[t._v("满足以上任一条件时")])])],1)])]),i("div",{staticClass:"line"}),i("section",{staticClass:"bottom"},[i("div",[i("span",{staticClass:"title"},[t._v("生产工期：")]),i("div",{staticClass:"right-content"},[i("el-input",{model:{value:t.DurationDay,callback:function(e){t.DurationDay=e},expression:"DurationDay"}}),i("span",[t._v("天")]),i("el-input",{attrs:{max:24},model:{value:t.DurationHour,callback:function(e){t.DurationHour=e},expression:"DurationHour"}}),i("span",[t._v("小时")])],1)]),i("div",[i("span",{staticClass:"title"},[i("i",[t._v("( 选填 ) ")]),t._v("数量递增：")]),i("div",{staticClass:"right-content"},[i("span",[t._v("产品数量每增加")]),i("el-input",{model:{value:t.ProductIncrement,callback:function(e){t.ProductIncrement=e},expression:"ProductIncrement"}}),i("span",[t._v("工期增加")]),i("el-input",{model:{value:t.ProductIncrementDuration,callback:function(e){t.ProductIncrementDuration=e},expression:"ProductIncrementDuration"}}),i("span",[t._v("小时")])],1)]),i("div",[i("span",{staticClass:"title"},[t._v("工艺工期：")]),i("div",{staticClass:"right-content"},[i("p",[i("el-radio-group",{model:{value:t.CraftPeriodType,callback:function(e){t.CraftPeriodType=e},expression:"CraftPeriodType"}},[i("el-radio",{attrs:{label:0}},[t._v("不额外增加")]),i("el-radio",{attrs:{label:1}},[t._v("累加工艺工期")]),i("el-radio",{attrs:{label:2}},[t._v("仅增加最长工艺工期")]),i("el-radio",{attrs:{label:3}},[t._v("按工艺种类递增")])],1)],1),3===t.CraftPeriodType?i("p",[i("span",[t._v("每增加")]),i("el-input",{model:{value:t.CraftIncrement,callback:function(e){t.CraftIncrement=e},expression:"CraftIncrement"}}),t._v("种工艺， "),i("span",[t._v("工期增加")]),i("el-input",{model:{value:t.CraftIncrementDuration,callback:function(e){t.CraftIncrementDuration=e},expression:"CraftIncrementDuration"}}),i("span",[t._v("小时")])],1):t._e()])]),i("div",[i("span",{staticClass:"title"},[t._v("运送时间：")]),i("div",{staticClass:"right-content"},[i("el-radio",{attrs:{label:!0},model:{value:t.IncludeExpress,callback:function(e){t.IncludeExpress=e},expression:"IncludeExpress"}},[t._v("有运送时间")]),i("el-radio",{attrs:{label:!1},model:{value:t.IncludeExpress,callback:function(e){t.IncludeExpress=e},expression:"IncludeExpress"}},[t._v("无运送时间")])],1)]),t.IncludeExpress?i("div",{staticClass:"delivery-set-box"},[i("span",{staticClass:"title"},[t._v("配送工期：")]),i("div",{staticClass:"right-content"},[i("el-input",{model:{value:t.DeliveryDurationDay,callback:function(e){t.DeliveryDurationDay=e},expression:"DeliveryDurationDay"}}),i("span",[t._v("天")]),i("el-input",{attrs:{max:24},model:{value:t.DeliveryDurationHour,callback:function(e){t.DeliveryDurationHour=e},expression:"DeliveryDurationHour"}}),i("span",[t._v("小时")])],1)]):t._e()]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("normal-btn-full",{attrs:{title:"确定"},nativeOn:{click:function(e){return t.handleDialogSave(e)}}}),i("normalBtn",{attrs:{title:"取消"},nativeOn:{click:function(e){return t.handleDialogClose(e)}}})],1)]):t._e(),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header area-dialog-wrap",attrs:{title:"选择区域",visible:t.showAddressDialog,width:"750px",modal:!1,top:"8vh","before-close":t.handleAreaDialogClose},on:{"update:visible":function(e){t.showAddressDialog=e}}},[t.showAddressDialog?i("section",[i("div",{staticClass:"mp-switch"},[i("span",{class:t.IncludeLimitArea?"active":"",on:{click:function(){return t.IncludeLimitArea=!0}}},[t._v("生效选中区域")]),i("span",{class:t.IncludeLimitArea?"":"active",on:{click:function(){return t.IncludeLimitArea=!1}}},[t._v("生效不选中区域")])]),i("tree-comp",{ref:"TreeComp",attrs:{title:"行政区域",treeList:t.allAdAreaTreeList,defaultCheckedKeys:t.defaultCheckedKeys,handleChangeFunc:t.handleAreaChangeFunc,checkAllTitle:"所有地区",defaultProps:{children:"children",label:"Name"}}})],1):t._e(),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("normal-btn-full",{attrs:{title:"确定"},nativeOn:{click:function(e){return t.handleAreaDialogSave(e)}}}),i("normalBtn",{attrs:{title:"取消"},nativeOn:{click:function(e){return t.handleAreaDialogClose(e)}}})],1)])],1)}),[],!1,null,null,null)).exports,L=i("fafd"),b={components:{CommonConditionComp:D,normalBtnFull:o.a,normalBtn:s.a},data:function(){return{dialogOpenType:"add",showSingleDialog:!1,showMultipleDialog:!1,craftList:[],conditionList:[],curEditIndex:0}},computed:Object(n.a)({},Object(r.e)("timelimit",["TimeLimitData","CraftPeriodItemData"]),{},Object(r.e)("common",["OperatorKeyValueList"]),{dialogTitle:function(){if(!this.showSingleDialog&&!this.showMultipleDialog)return"";var t="add"===this.dialogOpenType?"添加":"编辑",e=this.showSingleDialog?"单个":this.showMultipleDialog?"多个":"";return"".concat(t).concat(e,"工艺工期")},selectedCraftList:{get:function(){return this.showSingleDialog?this.CraftPeriodItemData.CraftList.length>0?this.CraftPeriodItemData.CraftList[0].ID:"":this.showMultipleDialog?this.CraftPeriodItemData.CraftList.map((function(t){return t.ID})):""},set:function(t){if(this.showSingleDialog)this.$store.commit("timelimit/setCraftPeriodItemData",["CraftList",[{ID:t}]]),this.getConditionList4SingleCraft([t]);else{var e=t.map((function(t){return{ID:t}}));this.$store.commit("timelimit/setCraftPeriodItemData",["CraftList",e])}}},DurationDay:{get:function(){return this.CraftPeriodItemData?this.CraftPeriodItemData.DurationDay:""},set:function(t){var e=t.replace(/[^\d]/g,"");this.$store.commit("timelimit/setCraftPeriodItemData",["DurationDay",e]);var i=this.CraftPeriodItemData.Duration?Math.floor(this.CraftPeriodItemData.Duration%24):0;this.$store.commit("timelimit/setCraftPeriodItemData",["Duration",+i+24*+e])}},DurationHour:{get:function(){return this.CraftPeriodItemData?this.CraftPeriodItemData.DurationHour:""},set:function(t){var e=t.replace(/[^\d]/g,"");e>=24&&(e=23),this.$store.commit("timelimit/setCraftPeriodItemData",["DurationHour",e]);var i=this.CraftPeriodItemData.Duration?Math.floor(this.CraftPeriodItemData.Duration/24):0;this.$store.commit("timelimit/setCraftPeriodItemData",["Duration",24*+i+ +e])}},CheckAllCraft:{get:function(){return this.CraftPeriodItemData.CraftList.length>0&&this.CraftPeriodItemData.CraftList.length===this.craftList.length},set:function(t){var e=t?this.craftList.map((function(t){return{ID:t.ID}})):[];this.$store.commit("timelimit/setCraftPeriodItemData",["CraftList",e])}},isIndeterminate:function(){return 0!==this.CraftPeriodItemData.CraftList.length&&this.craftList.length!==this.CraftPeriodItemData.CraftList.length&&this.CraftPeriodItemData.CraftList.length<this.craftList.length},CraftListNames:function(){var t=this;return 0!==this.craftList.lenght&&this.TimeLimitData.CraftPeriodList&&0!==this.TimeLimitData.CraftPeriodList.length?this.TimeLimitData.CraftPeriodList.map((function(e){var i=[];return e.CraftList.forEach((function(e){var a=t.craftList.find((function(t){return e.ID===t.ID}));a&&i.push(a.Name)})),i.length>0?i.join("、"):""})):[]},ConditionTextList:function(){var t=this;return this.TimeLimitData.CraftPeriodList.map((function(e){return e.Constraint?t.getConditionText(e.Constraint.ItemList,e.Constraint.FilterType):{type:"",_list:[]}}))}}),methods:{getCraftList:function(){var t=this;return Object(a.a)(regeneratorRuntime.mark((function e(){var i,a,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.TimeLimitData&&!(t.craftList.length>0)){e.next=2;break}return e.abrupt("return");case 2:return i=t.TimeLimitData.ProductClass,a=i.FirstLevelID,n=i.SecondLevelID,r={ProductClass:{First:a,Second:n}},e.next=6,t.api.getCraftList(r);case 6:if(1e3===(o=e.sent).data.Status){e.next=9;break}return e.abrupt("return");case 9:t.craftList=o.data.Data.map((function(t){return{ID:t.CraftID,Name:t.CraftName}}));case 10:case"end":return e.stop()}}),e)})))()},getConditionList4SingleCraft:function(t){var e=this;return Object(a.a)(regeneratorRuntime.mark((function i(){var a,n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=e.TimeLimitData?e.TimeLimitData.ProductClass.SecondLevelID:"",e.conditionList=[],i.next=4,e.api.getConditionList4ProducePeriod({type:20,Limits:t,positionID:a});case 4:if(1e3===(n=i.sent).data.Status){i.next=7;break}return i.abrupt("return");case 7:e.conditionList=n.data.Data,e.$store.commit("timelimit/setCraftPeriodItemData",["Constraint",{FilterType:1,ItemList:[]}]);case 9:case"end":return i.stop()}}),i)})))()},onSingleCraftClick:function(){this.dialogOpenType="add",this.showSingleDialog=!0,this.conditionList=[],this.$store.commit("timelimit/setCraftPeriodItemDataInit",{IsSignle:!0})},onMultipleCraftClick:function(){this.dialogOpenType="add",this.showMultipleDialog=!0,this.$store.commit("timelimit/setCraftPeriodItemDataInit",{IsSignle:!1})},handleSingleDialogClose:function(){this.showSingleDialog=!1},handleMultipleDialogClose:function(){this.showMultipleDialog=!1},handleConditionItemDEdit:function(t){var e=Object(d.a)(t,2),i=e[0],a=e[1];this.$store.commit("timelimit/editCraftPeriodItemData4Constraint",[a,i])},handleConditionItemDel:function(t){this.$store.commit("timelimit/editCraftPeriodItemData4Constraint",[t])},onFilterTypeChange:function(t){this.CraftPeriodItemData&&t!==this.CraftPeriodItemData.Constraint.FilterType&&this.$store.commit("timelimit/changeCraftPeriodItemData4FilterType",t)},onConditonAddClick:function(){if(0!==this.conditionList.length){var t={ProductID:"",PartID:"",CraftID:"",GroupID:"",PropertyID:"",PropertyType:"",Operator:"",Value:"",selfID:"".concat(Date.now()),ValueType:1,Prefix:"",OptionList:[],Unit:""};this.$store.commit("timelimit/addCraftPeriodItemData4Constraint",t);var e=document.querySelector(".single-craft-wrap .right-condition-content > ul");this.$utils.animateScroll(e.scrollTop,e.scrollHeight,(function(t){e.scrollTop=t}))}else this.$message({showClose:!0,message:this.CraftPeriodItemData.CraftList.length>0?"当前选中工艺无其它条件可设置":"请选择工艺",type:"error"})},handleDialogSave:function(){if(this.showSingleDialog||this.showMultipleDialog){var t=L.a.check(this.CraftPeriodItemData);if(!0===t){var e=[];"edit"===this.dialogOpenType?(e=Object(m.a)(this.TimeLimitData.CraftPeriodList)).splice(this.curEditIndex,1,Object(n.a)({},this.CraftPeriodItemData)):e=[Object(n.a)({},this.CraftPeriodItemData)].concat(Object(m.a)(this.TimeLimitData.CraftPeriodList)),this.$store.commit("timelimit/setTimeLimitData",["CraftPeriodList",e]),this.showSingleDialog&&(this.showSingleDialog=!1),this.showMultipleDialog&&(this.showMultipleDialog=!1)}else"string"==typeof t&&this.messageBox.failSingleError("保存失败","[ ".concat(t," ]"))}},handleDialogClose:function(){this.showSingleDialog&&(this.showSingleDialog=!1),this.showMultipleDialog&&(this.showMultipleDialog=!1)},handleSchemaEdit:function(t){var e=this;return Object(a.a)(regeneratorRuntime.mark((function i(){var a,n,r,o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e.$store.commit("timelimit/setCraftPeriodItemDataInit",e.TimeLimitData.CraftPeriodList[t]),e.curEditIndex=t,e.dialogOpenType="edit",!e.TimeLimitData.CraftPeriodList[t].IsSignle){i.next=18;break}return e.showSingleDialog=!0,a=[],e.TimeLimitData&&(1===(n=e.TimeLimitData.CraftPeriodList[t].CraftList).length&&(a=[n[0].ID])),r=e.TimeLimitData.ProductClass.SecondLevelID,e.conditionList=[],i.next=12,e.api.getConditionList4ProducePeriod({type:20,Limits:a,positionID:r});case 12:if(1e3===(o=i.sent).data.Status){i.next=15;break}return i.abrupt("return");case 15:e.conditionList=o.data.Data,i.next=19;break;case 18:e.showMultipleDialog=!0;case 19:case"end":return i.stop()}}),i)})))()},handleSchemaDel:function(t){var e=this;this.messageBox.warnCancelNullMsg("确定删除该条工艺工期吗 ?",(function(){return e.$store.commit("timelimit/deleteTimeLimitCraftPeriodItem",t)}),null)},getConditionText:function(t,e){var i=this,a={type:1===e?"并且":2===e?"或者":"",_list:[]};return t.forEach((function(t){var e={};e.Prefix=t.Prefix;var n=i.OperatorKeyValueList.find((function(e){return e.ID===t.Operator}));if(e.Operator=n.name,1===t.ValueType)e.Value="".concat(t.Value).concat(t.Unit?t.Unit:"");else if(2===t.ValueType){var r=t.OptionList?t.OptionList.find((function(e){return e.OptionID===t.Value})):null,o=r?r.Value:"";e.Value=o}a._list.push(e)})),a}},mounted:function(){this.getCraftList()}},y=(i("90b7"),Object(c.a)(b,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"mp-erp-time-limit-set-page-content-craft-schema-comp-wrap"},[i("header",[t._v("工艺工期：")]),i("div",[i("p",[i("span",{staticClass:"blue-span",on:{click:t.onSingleCraftClick}},[t._v("+添加单个工艺工期")]),i("span",{staticClass:"blue-span",on:{click:t.onMultipleCraftClick}},[t._v("+添加多个工艺工期")])]),t.TimeLimitData?i("el-table",{staticStyle:{width:"1600px"},attrs:{border:"",data:t.TimeLimitData.CraftPeriodList,"max-height":"261"}},[i("el-table-column",{attrs:{label:"工艺","show-overflow-tooltip":"",width:"291"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.CraftListNames[e.$index])+" ")]}}],null,!1,3125022769)}),i("el-table-column",{attrs:{width:"180","show-overflow-tooltip":"",label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.IsSignle?"单个工艺":"多个工艺")+" ")]}}],null,!1,2382572021)}),i("el-table-column",{attrs:{prop:"address",width:"595","show-overflow-tooltip":"",label:"其它条件"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(t.ConditionTextList[e.$index]._list,(function(a,n){return i("span",{key:a.Prefix+"-"+n},[n>0?i("i",{staticClass:"is-gray"},[t._v(t._s(t.ConditionTextList[e.$index].type))]):t._e(),t._v(" "+t._s(a.Prefix)),i("em",[t._v(t._s(a.Operator))]),t._v(t._s(a.Value)+" ")])}))}}],null,!1,2183259945)}),i("el-table-column",{attrs:{width:"320","show-overflow-tooltip":"",label:"工期"},scopedSlots:t._u([{key:"default",fn:function(e){return i("span",{staticClass:"is-success"},[t._v(" "+t._s(e.row.Duration>=24?Math.floor(e.row.Duration/24)+"天 "+e.row.Duration%24+"小时 / 工艺":e.row.Duration+"小时 / 工艺")+" ")])}}],null,!1,1004984500)}),i("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{staticClass:"menu-list"},[i("span",{on:{click:function(i){return t.handleSchemaEdit(e.$index)}}},[i("i"),t._v("编辑")]),i("span",{on:{click:function(i){return t.handleSchemaDel(e.$index)}}},[i("i"),t._v("删除")])])}}],null,!1,950361526)})],1):t._e()],1),t.CraftPeriodItemData?i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header single-craft-wrap",attrs:{title:t.dialogTitle,modal:!1,visible:t.showSingleDialog,width:"850px",top:"8vh","before-close":t.handleSingleDialogClose},on:{"update:visible":function(e){t.showSingleDialog=e}}},[i("section",[i("div",[i("span",{staticClass:"title"},[t._v("工艺选择：")]),i("el-radio-group",{model:{value:t.selectedCraftList,callback:function(e){t.selectedCraftList=e},expression:"selectedCraftList"}},t._l(t.craftList,(function(e){return i("el-radio",{key:e.ID,attrs:{label:e.ID}},[t._v(t._s(e.Name))])})),1)],1),t.CraftPeriodItemData.Constraint?i("div",[i("span",{staticClass:"title"},[t._v("其他条件：")]),i("div",{staticClass:"right-condition-content"},[i("p",{staticClass:"blue-span",on:{click:t.onConditonAddClick}},[t._v("+添加条件")]),i("CommonConditionComp",{attrs:{conditionList:t.conditionList,conditionData:t.CraftPeriodItemData.Constraint},on:{handleConditionItemDEdit:t.handleConditionItemDEdit,handleConditionItemDel:t.handleConditionItemDel}}),i("div",[i("span",{class:1===t.CraftPeriodItemData.Constraint.FilterType?"active":"",on:{click:function(){return t.onFilterTypeChange(1)}}},[t._v("满足以上所有条件时")]),i("span",{class:2===t.CraftPeriodItemData.Constraint.FilterType?"active":"",on:{click:function(){return t.onFilterTypeChange(2)}}},[t._v("满足以上任一条件时")])])],1)]):t._e(),i("div",[i("span",{staticClass:"title"},[t._v("工期：")]),i("div",{staticClass:"right-content"},[i("el-input",{model:{value:t.DurationDay,callback:function(e){t.DurationDay=e},expression:"DurationDay"}}),i("span",[t._v("天")]),i("el-input",{attrs:{max:24},model:{value:t.DurationHour,callback:function(e){t.DurationHour=e},expression:"DurationHour"}}),i("span",[t._v("小时")])],1)])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("normal-btn-full",{attrs:{title:"确定"},nativeOn:{click:function(e){return t.handleDialogSave(e)}}}),i("normalBtn",{attrs:{title:"取消"},nativeOn:{click:function(e){return t.handleDialogClose(e)}}})],1)]):t._e(),t.CraftPeriodItemData?i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"mp-img-style-header multiple-craft-wrap",attrs:{title:t.dialogTitle,modal:!1,visible:t.showMultipleDialog,width:"850px",top:"8vh","before-close":t.handleMultipleDialogClose},on:{"update:visible":function(e){t.showMultipleDialog=e}}},[i("section",[i("div",[i("span",{staticClass:"title"},[t._v("工艺选择：")]),i("div",{staticClass:"right-content-check-box-wrap"},[i("p",[i("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},model:{value:t.CheckAllCraft,callback:function(e){t.CheckAllCraft=e},expression:"CheckAllCraft"}},[t._v("全选")])],1),i("el-checkbox-group",{model:{value:t.selectedCraftList,callback:function(e){t.selectedCraftList=e},expression:"selectedCraftList"}},t._l(t.craftList,(function(e){return i("el-checkbox",{key:e.ID,attrs:{label:e.ID}},[t._v(t._s(e.Name))])})),1)],1)]),i("div",[i("span",{staticClass:"title"},[t._v("工期：")]),i("div",{staticClass:"right-content"},[i("el-input",{model:{value:t.DurationDay,callback:function(e){t.DurationDay=e},expression:"DurationDay"}}),i("span",[t._v("天")]),i("el-input",{attrs:{max:24},model:{value:t.DurationHour,callback:function(e){t.DurationHour=e},expression:"DurationHour"}}),i("span",[t._v("小时")])],1)])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("normal-btn-full",{attrs:{title:"确定"},nativeOn:{click:function(e){return t.handleDialogSave(e)}}}),i("normalBtn",{attrs:{title:"取消"},nativeOn:{click:function(e){return t.handleDialogClose(e)}}})],1)]):t._e()],1)}),[],!1,null,null,null)).exports,S={props:{TimeLimitData:{type:Object,required:!0}},components:{ProductSelectComp:u,SchemaListComp:I,CraftSchemaComp:y}},x=(i("4ba8"),Object(c.a)(S,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("article",{staticClass:"mp-erp-time-limit-set-page-content-wrap"},[i("ProductSelectComp",{attrs:{ProductList:t.TimeLimitData.ProductList,ProductClass:t.TimeLimitData.ProductClass}}),i("SchemaListComp"),i("CraftSchemaComp")],1)}),[],!1,null,null,null)).exports,P={name:"timeLimitSet",components:{normalBtnFull:o.a,normalBtn:s.a,LimitSetContentComp:x},computed:Object(n.a)({},Object(r.e)("timelimit",["TimeLimitData","setPageType"]),{},Object(r.c)("common",["allProductClassify","subExpressList"]),{subExpressIDList:function(){return this.subExpressList&&0!==this.subExpressList.length?this.subExpressList.map((function(t){return t.ID})):[]}}),methods:{onSubmitTimeLimitDataClick:function(){var t=this;return Object(a.a)(regeneratorRuntime.mark((function e(){var i,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("timelimit/fetchProducePeriodSave",t.subExpressIDList);case 2:(i=e.sent)&&(a=function(){if(t.TimeLimitData){var e="",a=t.TimeLimitData,n=a.ProductClass,r=a.ProductList,o=a.SchemaList,s=n.FirstLevelID,l=n.SecondLevelID;if(t.allProductClassify&&t.allProductClassify.length>0){var c=t.allProductClassify.find((function(t){return t.ID===s}));if(c){var u=c.children.find((function(t){return t.ID===l}));if(u){var m=u.children,d=[];r.length===m.length?e="全部产品":(r.forEach((function(t){var e=m.find((function(e){return e.ID===t.ID}));e&&d.push(e.ClassName)})),e=d.join("、"))}}}t.$store.commit("timelimit/changeDataList",{ProductClass:n,ID:i,ProductString:e,RecordCount:o.length}),t.onReturnClick()}else t.onReturnClick(!0)},n="edit"===t.setPageType?"编辑成功":"添加成功",t.messageBox.successSingle(n,(function(){return a()}),(function(){return a()})));case 4:case"end":return e.stop()}}),e)})))()},onReturnClick:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?this.$router.replace("/timeLimitList"):this.$router.replace({path:"/timeLimitList",query:{notNeedFetch:!0}})}},mounted:function(){this.TimeLimitData||this.$router.replace("/timeLimitList")}},_=(i("306a"),Object(c.a)(P,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.TimeLimitData?i("section",{staticClass:"mp-erp-time-limit-set-page-wrap"},[i("header",[i("span",[t._v("当前产品：")]),i("span",[t._v(t._s(t.TimeLimitData.ProductClass.FirstLevelName)+" - "+t._s(t.TimeLimitData.ProductClass.SecondLevelName))])]),i("LimitSetContentComp",{attrs:{TimeLimitData:t.TimeLimitData}}),i("footer",[i("normal-btn-full",{attrs:{title:"保存"},nativeOn:{click:function(e){return t.onSubmitTimeLimitDataClick(e)}}}),i("normal-btn",{attrs:{title:"返回"},nativeOn:{click:function(e){return t.onReturnClick(!1)}}})],1)],1):t._e()}),[],!1,null,null,null));e.default=_.exports},"286f":function(t,e,i){"use strict";i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return s})),i("4de4"),i("7db0"),i("4160"),i("caad"),i("d81d"),i("d3b7"),i("6062"),i("2532"),i("3ca3"),i("159b"),i("ddb0");var a=i("5530"),n=i("2909"),r=/^全部/;function o(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ClassName";if(!t||0===t.length)return[];var o=JSON.parse(JSON.stringify(e)),s=Object(n.a)(new Set(t.map((function(t){return t.RegionalID})))),l=Object(n.a)(new Set(t.map((function(t){return t.CityID})))),c=Object(n.a)(new Set(t.map((function(t){return t.CountyID})))),u=o.filter((function(t){return s.includes(t.ID)}));if((u=(u=u.map((function(t){return Object(a.a)({},t,{children:t.children.filter((function(t){return l.includes(t.ID)}))})}))).map((function(t){var e=t.children.map((function(t){var e,n=!0;return t.children.forEach((function(t){c.includes(t.ID)||(n=!1)})),n?n&&(e=["全部".concat(t[i],"区域")]):e=t.children.filter((function(t){return c.includes(t.ID)})),Object(a.a)({},t,{children:e})})),n=!0;(e.forEach((function(t){r.test(t.children[0])||(n=!1)})),n)&&o.find((function(e){return e.ID===t.ID})).children.forEach((function(t){!l.includes(t.ID)&&t.children.length>0&&(n=!1)}));var s=n?["全部".concat(t[i])]:e;return Object(a.a)({},t,{children:s})}))).length===e.length){var m=!0;u.forEach((function(t){r.test(t.children[0])||(m=!1)})),m&&(u="全部区域")}return u}function s(t,e){if(!t||0===t.length)return[];var i=JSON.parse(JSON.stringify(e)),o=Object(n.a)(new Set(t.map((function(t){return t.FirstLevelID})))),s=Object(n.a)(new Set(t.map((function(t){return t.SecondLevelID})))),l=Object(n.a)(new Set(t.map((function(t){return t.ProductID})))),c=i.filter((function(t){return o.includes(t.ID)}));if((c=(c=c.map((function(t){return Object(a.a)({},t,{children:t.children.filter((function(t){return s.includes(t.ID)}))})}))).map((function(t){var e=t.children.map((function(t){var e,i=!0;return t.children.forEach((function(t){l.includes(t.ID)||(i=!1)})),i?i&&(e=["全部".concat(t.ClassName,"产品")]):e=t.children.filter((function(t){return l.includes(t.ID)})),Object(a.a)({},t,{children:e})})),n=!0;(e.forEach((function(t){r.test(t.children[0])||(n=!1)})),n)&&i.find((function(e){return e.ID===t.ID})).children.forEach((function(t){s.includes(t.ID)||(n=!1)}));var o=n?["全部".concat(t.ClassName,"产品")]:e;return Object(a.a)({},t,{children:o})}))).length===e.filter((function(t){return t.children.length>0})).length){var u=!0;c.forEach((function(t){r.test(t.children[0])||(u=!1)})),u&&(c="全部产品")}return c}},"306a":function(t,e,i){"use strict";var a=i("06e5");i.n(a).a},3307:function(t,e,i){"use strict";var a=i("0c68");i.n(a).a},"3f2b":function(t,e,i){"use strict";var a=i("436f");i.n(a).a},"436f":function(t,e,i){},"4ba8":function(t,e,i){"use strict";var a=i("b12f");i.n(a).a},6062:function(t,e,i){"use strict";var a=i("6d61"),n=i("6566");t.exports=a("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n)},6566:function(t,e,i){"use strict";var a=i("9bf2").f,n=i("7c73"),r=i("e2cc"),o=i("0366"),s=i("19aa"),l=i("2266"),c=i("7dd0"),u=i("2626"),m=i("83ab"),d=i("f183").fastKey,h=i("69f3"),f=h.set,p=h.getterFor;t.exports={getConstructor:function(t,e,i,c){var u=t((function(t,a){s(t,u,e),f(t,{type:e,index:n(null),first:void 0,last:void 0,size:0}),m||(t.size=0),null!=a&&l(a,t[c],t,i)})),h=p(e),D=function(t,e,i){var a,n,r=h(t),o=v(t,e);return o?o.value=i:(r.last=o={index:n=d(e,!0),key:e,value:i,previous:a=r.last,next:void 0,removed:!1},r.first||(r.first=o),a&&(a.next=o),m?r.size++:t.size++,"F"!==n&&(r.index[n]=o)),t},v=function(t,e){var i,a=h(t),n=d(e);if("F"!==n)return a.index[n];for(i=a.first;i;i=i.next)if(i.key==e)return i};return r(u.prototype,{clear:function(){for(var t=h(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,m?t.size=0:this.size=0},delete:function(t){var e=this,i=h(e),a=v(e,t);if(a){var n=a.next,r=a.previous;delete i.index[a.index],a.removed=!0,r&&(r.next=n),n&&(n.previous=r),i.first==a&&(i.first=n),i.last==a&&(i.last=r),m?i.size--:e.size--}return!!a},forEach:function(t){for(var e,i=h(this),a=o(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:i.first;)for(a(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!v(this,t)}}),r(u.prototype,i?{get:function(t){var e=v(this,t);return e&&e.value},set:function(t,e){return D(this,0===t?0:t,e)}}:{add:function(t){return D(this,t=0===t?0:t,t)}}),m&&a(u.prototype,"size",{get:function(){return h(this).size}}),u},setStrong:function(t,e,i){var a=e+" Iterator",n=p(e),r=p(a);c(t,e,(function(t,e){f(this,{type:a,target:t,state:n(t),kind:e,last:void 0})}),(function(){for(var t=r(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?"keys"==e?{value:i.key,done:!1}:"values"==e?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),i?"entries":"values",!i,!0),u(e)}}},"6d61":function(t,e,i){"use strict";var a=i("23e7"),n=i("da84"),r=i("94ca"),o=i("6eeb"),s=i("f183"),l=i("2266"),c=i("19aa"),u=i("861d"),m=i("d039"),d=i("1c7e"),h=i("d44e"),f=i("7156");t.exports=function(t,e,i){var p=-1!==t.indexOf("Map"),D=-1!==t.indexOf("Weak"),v=p?"set":"add",C=n[t],g=C&&C.prototype,I=C,L={},b=function(t){var e=g[t];o(g,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(D&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return D&&!u(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(D&&!u(t))&&e.call(this,0===t?0:t)}:function(t,i){return e.call(this,0===t?0:t,i),this})};if(r(t,"function"!=typeof C||!(D||g.forEach&&!m((function(){(new C).entries().next()})))))I=i.getConstructor(e,t,p,v),s.REQUIRED=!0;else if(r(t,!0)){var y=new I,S=y[v](D?{}:-0,1)!=y,x=m((function(){y.has(1)})),P=d((function(t){new C(t)})),_=!D&&m((function(){for(var t=new C,e=5;e--;)t[v](e,e);return!t.has(-0)}));P||((I=e((function(e,i){c(e,I,t);var a=f(new C,e,I);return null!=i&&l(i,a[v],a,p),a}))).prototype=g,g.constructor=I),(x||_)&&(b("delete"),b("has"),p&&b("get")),(_||S)&&b(v),D&&g.clear&&delete g.clear}return L[t]=I,a({global:!0,forced:I!=C},L),h(I,t),D||i.setStrong(I,t,p),I}},"7db5":function(t,e,i){"use strict";var a=i("aead");i.n(a).a},"8e71":function(t,e,i){},"90b7":function(t,e,i){"use strict";var a=i("8e71");i.n(a).a},aead:function(t,e,i){},b12f:function(t,e,i){},bb2f:function(t,e,i){var a=i("d039");t.exports=!a((function(){return Object.isExtensible(Object.preventExtensions({}))}))},f183:function(t,e,i){var a=i("d012"),n=i("861d"),r=i("5135"),o=i("9bf2").f,s=i("90e3"),l=i("bb2f"),c=s("meta"),u=0,m=Object.isExtensible||function(){return!0},d=function(t){o(t,c,{value:{objectID:"O"+ ++u,weakData:{}}})},h=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!n(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,c)){if(!m(t))return"F";if(!e)return"E";d(t)}return t[c].objectID},getWeakData:function(t,e){if(!r(t,c)){if(!m(t))return!0;if(!e)return!1;d(t)}return t[c].weakData},onFreeze:function(t){return l&&h.REQUIRED&&m(t)&&!r(t,c)&&d(t),t}};a[c]=!0}}]);