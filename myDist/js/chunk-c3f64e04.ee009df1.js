(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c3f64e04"],{4021:function(t,r,a){},"64ae":function(t,r,a){"use strict";var o=a("4021");a.n(o).a},"70f1":function(t,r,a){"use strict";a.r(r);var o=(a("4de4"),a("7db0"),a("d81d"),a("b0c0"),a("96cf"),a("1da1")),c=a("5530"),e=a("2f62"),i={name:"ProductFactoryAddPage",data:function(){return{ProductID:"",PartID:"",ProductName:"",titleType:"",defaultFactory:"",checkedFactoryList:[]}},components:{ContionCommonComp:a("9477").a},computed:Object(c.a)({},Object(e.e)("productManage",["ProductManageList","ProductModuleKeyIDList","ProductFactoryPropertyList","curEditFactoryData"]),{},Object(e.e)("common",["factoryList"]),{curProduct:function(){var t=this;return this.ProductID?this.ProductManageList.find((function(r){return r.ID===t.ProductID})):null},curPart:function(){var t=this;return this.PartID&&this.curProduct?this.curProduct.PartList.find((function(r){return r.ID===t.PartID})):null}}),methods:{getPositionID:function(){if(this.$route.params){var t=this.$route.params,r=t.ProductID,a=t.PartID,o=t.name,c=t.type;r&&a&&o&&c?(this.ProductID=r,this.PartID="null"!==a?a:"",this.ProductName=o,this.titleType=c):this.onGoBackClick()}else this.onGoBackClick()},onGoBackClick:function(){this.$goback()},findFactoryByID:function(t){return this.factoryList.find((function(r){return r.FactoryID===t}))},getFactoryList:function(){var t=this,r=this.checkedFactoryList.map((function(r){return t.findFactoryByID(r)})).filter((function(t){return t})).map((function(t){return{Factory:t,IsDefault:!1}})),a=this.findFactoryByID(this.defaultFactory);return a?(r.push({Factory:a,IsDefault:!0}),r):(this.messageBox.failSingleError("保存失败","默认工厂数据寻找错误，请联系IT部门"),!1)},onSubmitClick:function(){var t=this.$refs.oLeftCondition.getConditonResult();if(t)if(this.defaultFactory||0===this.defaultFactory){var r=t.ID,a=t.Priority,o=t.Constraint,c=this.getFactoryList();if(c){var e={ID:r,Priority:a,Constraint:o,FactoryList:c,ProductID:this.ProductID};this.ProductFactorySubmitHandler(e)}}else this.messageBox.failSingleError("保存失败","请选择默认工厂")},ProductFactorySubmitHandler:function(t){var r=this;return Object(o.a)(regeneratorRuntime.mark((function a(){var o,e,i,n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.api.getProductFactoryAddSave(t).catch((function(){}));case 2:(o=a.sent)&&o.data&&1e3===o.data.Status&&(e=t.ID||0===t.ID,i=function(){r.$store.commit("productManage/setProductFactorySave",[Object(c.a)({},t,{ID:o.data.Data}),e]),r.onGoBackClick()},n=e?"编辑成功":"添加成功",r.messageBox.successSingle(n,i,i));case 4:case"end":return a.stop()}}),a)})))()}},mounted:function(){if(this.getPositionID(),this.$store.dispatch("common/getFactoryList"),this.curEditFactoryData){var t=this.curEditFactoryData.FactoryList;if(Array.isArray(t)&&0!==t.length){var r=t.find((function(t){return t.IsDefault}));r&&(this.defaultFactory=r.Factory.FactoryID),this.checkedFactoryList=t.filter((function(t){return!t.IsDefault})).map((function(t){return t.Factory.FactoryID}))}}}},n=(a("64ae"),a("2877")),s=Object(n.a)(i,(function(){var t=this,r=t.$createElement,a=t._self._c||r;return a("section",{staticClass:"mp-erp-product-list-page-product-factory-add-page-wrap"},[a("header",[a("span",[t._v("当前"+t._s(t.titleType)+"：")]),a("span",[t._v(t._s(t.ProductName))])]),a("main",[a("ContionCommonComp",{ref:"oLeftCondition",attrs:{PropertyList:t.ProductFactoryPropertyList,curEditData:t.curEditFactoryData}},[a("div",[a("span",[t._v("默认生产工厂：")]),a("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.defaultFactory,callback:function(r){t.defaultFactory=r},expression:"defaultFactory"}},t._l(t.factoryList,(function(r){return a("el-option",{key:r.FactoryID,attrs:{label:r.FactoryName,disabled:t.checkedFactoryList.includes(r.FactoryID),value:r.FactoryID}})})),1)],1),a("div",[a("span",[t._v("可选生产工厂：")]),a("el-checkbox-group",{model:{value:t.checkedFactoryList,callback:function(r){t.checkedFactoryList=r},expression:"checkedFactoryList"}},t._l(t.factoryList,(function(r){return a("el-checkbox",{key:r.FactoryID,attrs:{label:r.FactoryID,disabled:r.FactoryID===t.defaultFactory}},[t._v(t._s(r.FactoryName))])})),1)],1)])],1),a("footer",[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmitClick}},[t._v("保存")]),a("el-button",{on:{click:t.onGoBackClick}},[a("i",{staticClass:"el-icon-d-arrow-left"}),t._v(" 返回")])],1)])}),[],!1,null,null,null);r.default=s.exports}}]);